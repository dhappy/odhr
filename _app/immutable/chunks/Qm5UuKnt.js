const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CBqsacSD.js","./CeJSdIh9.js","./Dp1pzeXC.js","./BkqYVnly.js","./DckfMiz2.js","./B3dX0u-U.js","./wANn0zLl.js","./rA6I0RPv.js","./J0oOSKfF.js","./CooABNKt.js","./CLU_pvgO.js","./NXOBBj2-.js","./sOnjti7P.js","./Du_0FKG0.js","./DQ-FSh02.js","./sD-u_8bC.js","./CCGxriUW.js","./Dmg8YACJ.js","./B7tDMkPc.js","./DMb4Ddrf.js","./CKc30bu6.js","./GHOJI0vO.js","./B_mkjXUy.js","./BDWqg9lK.js","./c_VTYGuP.js","./_cuYpuZt.js","./Culcn6LT.js","./D3H4k2lE.js","./Cgj-xegA.js","./X9RbzwjQ.js","./DvivY6zu.js","./DxJtWbVs.js","./BVfrt1QW.js","./DrIk3uB0.js","./BCRHRMRz.js","./CEuyMYzZ.js","./DZmrcUhH.js","./Bk-bOJzk.js","./BU6V2rFz.js","./DsFCxamD.js","./CXIqdm3O.js","./DnwKvXWW.js","./CEoTPPCM.js"])))=>i.map(i=>d[i]);
import{t as bE,a as vE}from"./tv8dNeI-.js";import{b as EE,O as _E,T as CE,aG as AE,ax as IE,h as SE,f as NE,q as TE,x as PE,t as xE,w as OE}from"./BDuhH288.js";import{_ as Ut}from"./Dp1pzeXC.js";function RE(t,e,...r){var n=t,s=AE,i;EE(()=>{s!==(s=e())&&(i&&(IE(i),i=null),i=CE(()=>s(n,...r)))},_E),SE&&(n=NE)}const $E=!0,CF=Object.freeze(Object.defineProperty({__proto__:null,prerender:$E},Symbol.toStringTag,{value:"Module"})),DE=Symbol(),Kf=Object.getPrototypeOf,Nd=new WeakMap,kE=t=>t&&(Nd.has(t)?Nd.get(t):Kf(t)===Object.prototype||Kf(t)===Array.prototype),UE=t=>kE(t)&&t[DE]||null,Gf=(t,e=!0)=>{Nd.set(t,e)},Zc={},dl=t=>typeof t=="object"&&t!==null,jn=new WeakMap,To=new WeakSet,LE=(t=Object.is,e=(u,l)=>new Proxy(u,l),r=u=>dl(u)&&!To.has(u)&&(Array.isArray(u)||!(Symbol.iterator in u))&&!(u instanceof WeakMap)&&!(u instanceof WeakSet)&&!(u instanceof Error)&&!(u instanceof Number)&&!(u instanceof Date)&&!(u instanceof String)&&!(u instanceof RegExp)&&!(u instanceof ArrayBuffer),n=u=>{switch(u.status){case"fulfilled":return u.value;case"rejected":throw u.reason;default:throw u}},s=new WeakMap,i=(u,l,d=n)=>{const h=s.get(u);if((h==null?void 0:h[0])===l)return h[1];const f=Array.isArray(u)?[]:Object.create(Object.getPrototypeOf(u));return Gf(f,!0),s.set(u,[l,f]),Reflect.ownKeys(u).forEach(p=>{if(Object.getOwnPropertyDescriptor(f,p))return;const g=Reflect.get(u,p),{enumerable:m}=Reflect.getOwnPropertyDescriptor(u,p),w={value:g,enumerable:m,configurable:!0};if(To.has(g))Gf(g,!1);else if(g instanceof Promise)delete w.value,w.get=()=>d(g);else if(jn.has(g)){const[b,v]=jn.get(g);w.value=i(b,v(),d)}Object.defineProperty(f,p,w)}),Object.preventExtensions(f)},o=new WeakMap,a=[1,1],c=u=>{if(!dl(u))throw new Error("object required");const l=o.get(u);if(l)return l;let d=a[0];const h=new Set,f=(S,x=++a[0])=>{d!==x&&(d=x,h.forEach(O=>O(S,x)))};let p=a[1];const g=(S=++a[1])=>(p!==S&&!h.size&&(p=S,w.forEach(([x])=>{const O=x[1](S);O>d&&(d=O)})),d),m=S=>(x,O)=>{const L=[...x];L[1]=[S,...L[1]],f(L,O)},w=new Map,b=(S,x)=>{if((Zc?"production":void 0)!=="production"&&w.has(S))throw new Error("prop listener already exists");if(h.size){const O=x[3](m(S));w.set(S,[x,O])}else w.set(S,[x])},v=S=>{var x;const O=w.get(S);O&&(w.delete(S),(x=O[1])==null||x.call(O))},A=S=>(h.add(S),h.size===1&&w.forEach(([O,L],M)=>{if((Zc?"production":void 0)!=="production"&&L)throw new Error("remove already exists");const R=O[3](m(M));w.set(M,[O,R])}),()=>{h.delete(S),h.size===0&&w.forEach(([O,L],M)=>{L&&(L(),w.set(M,[O]))})}),E=Array.isArray(u)?[]:Object.create(Object.getPrototypeOf(u)),_=e(E,{deleteProperty(S,x){const O=Reflect.get(S,x);v(x);const L=Reflect.deleteProperty(S,x);return L&&f(["delete",[x],O]),L},set(S,x,O,L){const M=Reflect.has(S,x),R=Reflect.get(S,x,L);if(M&&(t(R,O)||o.has(O)&&t(R,o.get(O))))return!0;v(x),dl(O)&&(O=UE(O)||O);let I=O;if(O instanceof Promise)O.then(N=>{O.status="fulfilled",O.value=N,f(["resolve",[x],N])}).catch(N=>{O.status="rejected",O.reason=N,f(["reject",[x],N])});else{!jn.has(O)&&r(O)&&(I=c(O));const N=!To.has(I)&&jn.get(I);N&&b(x,N)}return Reflect.set(S,x,I,L),f(["set",[x],O,R]),!0}});o.set(u,_);const T=[E,g,i,A];return jn.set(_,T),Reflect.ownKeys(u).forEach(S=>{const x=Object.getOwnPropertyDescriptor(u,S);"value"in x&&(_[S]=u[S],delete x.value,delete x.writable),Object.defineProperty(E,S,x)}),_})=>[c,jn,To,t,e,r,n,s,i,o,a],[ME]=LE();function Ye(t={}){return ME(t)}function Bt(t,e,r){const n=jn.get(t);(Zc?"production":void 0)!=="production"&&!n&&console.warn("Please use proxy object");let s;const i=[],o=n[3];let a=!1;const u=o(l=>{i.push(l),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,u()}}function Ko(t,e){const r=jn.get(t);(Zc?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");const[n,s,i]=r;return i(n,s(),e)}function Rs(t){return To.add(t),t}function Rt(t,e,r,n){let s=t[e];return Bt(t,()=>{const i=t[e];Object.is(s,i)||r(s=i)})}function BE(t){const e=Ye({data:Array.from([]),has(r){return this.data.some(n=>n[0]===r)},set(r,n){const s=this.data.find(i=>i[0]===r);return s?s[1]=n:this.data.push([r,n]),this},get(r){var n;return(n=this.data.find(s=>s[0]===r))==null?void 0:n[1]},delete(r){const n=this.data.findIndex(s=>s[0]===r);return n===-1?!1:(this.data.splice(n,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(r){this.data.forEach(n=>{r(n[1],n[0],this)})},keys(){return this.data.map(r=>r[0]).values()},values(){return this.data.map(r=>r[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(e,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(e),e}var Xr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function FE(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}const Go={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return(t==null?void 0:t.filter(r=>r.chainNamespace===e))||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]}};var jE=20,qE=1,Yi=1e6,zE=1e6,HE=-7,WE=21,VE=!1,ja="[big.js] ",Ks=ja+"Invalid ",Ou=Ks+"decimal places",KE=Ks+"rounding mode",Xy=ja+"Division by zero",Ue={},tn=void 0,GE=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Qy(){function t(e){var r=this;if(!(r instanceof t))return e===tn?Qy():new t(e);if(e instanceof t)r.s=e.s,r.e=e.e,r.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Ks+"value");e=e===0&&1/e<0?"-0":String(e)}YE(r,e)}r.constructor=t}return t.prototype=Ue,t.DP=jE,t.RM=qE,t.NE=HE,t.PE=WE,t.strict=VE,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function YE(t,e){var r,n,s;if(!GE.test(e))throw Error(Ks+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(r=e.indexOf("."))>-1&&(e=e.replace(".","")),(n=e.search(/e/i))>0?(r<0&&(r=n),r+=+e.slice(n+1),e=e.substring(0,n)):r<0&&(r=e.length),s=e.length,n=0;n<s&&e.charAt(n)=="0";)++n;if(n==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=r-n-1,t.c=[],r=0;n<=s;)t.c[r++]=+e.charAt(n++)}return t}function Gs(t,e,r,n){var s=t.c;if(r===tn&&(r=t.constructor.RM),r!==0&&r!==1&&r!==2&&r!==3)throw Error(KE);if(e<1)n=r===3&&(n||!!s[0])||e===0&&(r===1&&s[0]>=5||r===2&&(s[0]>5||s[0]===5&&(n||s[1]!==tn))),s.length=1,n?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(n=r===1&&s[e]>=5||r===2&&(s[e]>5||s[e]===5&&(n||s[e+1]!==tn||s[e-1]&1))||r===3&&(n||!!s[0]),s.length=e,n){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function Ys(t,e,r){var n=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(n<0?"e":"e+")+n;else if(n<0){for(;++n;)s="0"+s;s="0."+s}else if(n>0)if(++n>i)for(n-=i;n--;)s+="0";else n<i&&(s=s.slice(0,n)+"."+s.slice(n));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&r?"-"+s:s}Ue.abs=function(){var t=new this.constructor(this);return t.s=1,t};Ue.cmp=function(t){var e,r=this,n=r.c,s=(t=new r.constructor(t)).c,i=r.s,o=t.s,a=r.e,c=t.e;if(!n[0]||!s[0])return n[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=n.length)<(c=s.length)?a:c,i=-1;++i<o;)if(n[i]!=s[i])return n[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};Ue.div=function(t){var e=this,r=e.constructor,n=e.c,s=(t=new r(t)).c,i=e.s==t.s?1:-1,o=r.DP;if(o!==~~o||o<0||o>Yi)throw Error(Ou);if(!s[0])throw Error(Xy);if(!n[0])return t.s=i,t.c=[t.e=0],t;var a,c,u,l,d,h=s.slice(),f=a=s.length,p=n.length,g=n.slice(0,a),m=g.length,w=t,b=w.c=[],v=0,A=o+(w.e=e.e-t.e)+1;for(w.s=i,i=A<0?0:A,h.unshift(0);m++<a;)g.push(0);do{for(u=0;u<10;u++){if(a!=(m=g.length))l=a>m?1:-1;else for(d=-1,l=0;++d<a;)if(s[d]!=g[d]){l=s[d]>g[d]?1:-1;break}if(l<0){for(c=m==a?s:h;m;){if(g[--m]<c[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}b[v++]=l?u:++u,g[0]&&l?g[m]=n[f]||0:g=[n[f]]}while((f++<p||g[0]!==tn)&&i--);return!b[0]&&v!=1&&(b.shift(),w.e--,A--),v>A&&Gs(w,A,r.RM,g[0]!==tn),w};Ue.eq=function(t){return this.cmp(t)===0};Ue.gt=function(t){return this.cmp(t)>0};Ue.gte=function(t){return this.cmp(t)>-1};Ue.lt=function(t){return this.cmp(t)<0};Ue.lte=function(t){return this.cmp(t)<1};Ue.minus=Ue.sub=function(t){var e,r,n,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var u=i.c.slice(),l=i.e,d=t.c,h=t.e;if(!u[0]||!d[0])return d[0]?t.s=-c:u[0]?t=new o(i):t.s=1,t;if(a=l-h){for((s=a<0)?(a=-a,n=u):(h=l,n=d),n.reverse(),c=a;c--;)n.push(0);n.reverse()}else for(r=((s=u.length<d.length)?u:d).length,a=c=0;c<r;c++)if(u[c]!=d[c]){s=u[c]<d[c];break}if(s&&(n=u,u=d,d=n,t.s=-t.s),(c=(r=d.length)-(e=u.length))>0)for(;c--;)u[e++]=0;for(c=e;r>a;){if(u[--r]<d[r]){for(e=r;e&&!u[--e];)u[e]=9;--u[e],u[r]+=10}u[r]-=d[r]}for(;u[--c]===0;)u.pop();for(;u[0]===0;)u.shift(),--h;return u[0]||(t.s=1,u=[h=0]),t.c=u,t.e=h,t};Ue.mod=function(t){var e,r=this,n=r.constructor,s=r.s,i=(t=new n(t)).s;if(!t.c[0])throw Error(Xy);return r.s=t.s=1,e=t.cmp(r)==1,r.s=s,t.s=i,e?new n(r):(s=n.DP,i=n.RM,n.DP=n.RM=0,r=r.div(t),n.DP=s,n.RM=i,this.minus(r.times(t)))};Ue.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};Ue.plus=Ue.add=function(t){var e,r,n,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,u=t.c;if(!a[0]||!u[0])return u[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,n=u):(e=-e,n=a),n.reverse();e--;)n.push(0);n.reverse()}for(a.length-u.length<0&&(n=u,u=a,a=n),e=u.length,r=0;e;a[e]%=10)r=(a[--e]=a[e]+u[e]+r)/10|0;for(r&&(a.unshift(r),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};Ue.pow=function(t){var e=this,r=new e.constructor("1"),n=r,s=t<0;if(t!==~~t||t<-1e6||t>zE)throw Error(Ks+"exponent");for(s&&(t=-t);t&1&&(n=n.times(e)),t>>=1,!!t;)e=e.times(e);return s?r.div(n):n};Ue.prec=function(t,e){if(t!==~~t||t<1||t>Yi)throw Error(Ks+"precision");return Gs(new this.constructor(this),t,e)};Ue.round=function(t,e){if(t===tn)t=0;else if(t!==~~t||t<-1e6||t>Yi)throw Error(Ou);return Gs(new this.constructor(this),t+this.e+1,e)};Ue.sqrt=function(){var t,e,r,n=this,s=n.constructor,i=n.s,o=n.e,a=new s("0.5");if(!n.c[0])return new s(n);if(i<0)throw Error(ja+"No square root");i=Math.sqrt(+Ys(n,!0,!0)),i===0||i===1/0?(e=n.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do r=t,t=a.times(r.plus(n.div(r)));while(r.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return Gs(t,(s.DP-=4)+t.e+1,s.RM)};Ue.times=Ue.mul=function(t){var e,r=this,n=r.constructor,s=r.c,i=(t=new n(t)).c,o=s.length,a=i.length,c=r.e,u=t.e;if(t.s=r.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+u,o<a&&(e=s,s=i,i=e,u=o,o=a,a=u),e=new Array(u=o+a);u--;)e[u]=0;for(c=a;c--;){for(a=0,u=o+c;u>c;)a=e[u]+i[c]*s[u-c-1]+a,e[u--]=a%10,a=a/10|0;e[u]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};Ue.toExponential=function(t,e){var r=this,n=r.c[0];if(t!==tn){if(t!==~~t||t<0||t>Yi)throw Error(Ou);for(r=Gs(new r.constructor(r),++t,e);r.c.length<t;)r.c.push(0)}return Ys(r,!0,!!n)};Ue.toFixed=function(t,e){var r=this,n=r.c[0];if(t!==tn){if(t!==~~t||t<0||t>Yi)throw Error(Ou);for(r=Gs(new r.constructor(r),t+r.e+1,e),t=t+r.e+1;r.c.length<t;)r.c.push(0)}return Ys(r,!1,!!n)};Ue[Symbol.for("nodejs.util.inspect.custom")]=Ue.toJSON=Ue.toString=function(){var t=this,e=t.constructor;return Ys(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};Ue.toNumber=function(){var t=+Ys(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(ja+"Imprecise conversion");return t};Ue.toPrecision=function(t,e){var r=this,n=r.constructor,s=r.c[0];if(t!==tn){if(t!==~~t||t<1||t>Yi)throw Error(Ks+"precision");for(r=Gs(new n(r),t,e);r.c.length<t;)r.c.push(0)}return Ys(r,t<=r.e||r.e<=n.NE||r.e>=n.PE,!!s)};Ue.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(ja+"valueOf disallowed");return Ys(t,t.e<=e.NE||t.e>=e.PE,!0)};var ao=Qy();const ZE={bigNumber(t){return t?new ao(t):new ao(0)},multiply(t,e){if(t===void 0||e===void 0)return new ao(0);const r=new ao(t),n=new ao(e);return r.times(n)},formatNumberToLocalString(t,e=2){return t===void 0?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})},parseLocalStringToNumber(t){return t===void 0?0:parseFloat(t.replace(/,/gu,""))}},JE=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],XE=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],QE=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}];var Yf={};const q={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Yf<"u"?Yf.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org"},e_={getERC20Abi:t=>q.USDT_CONTRACT_ADDRESSES.includes(t)?QE:JE,getSwapAbi:()=>XE},Rn={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[r,n,s]=e;if(!r||!n||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:r,chainId:n,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[r,n]=e;if(!r||!n)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:r,chainId:n}}},me={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections"};function hl(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const fe={setItem(t,e){Po()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(Po())return localStorage.getItem(t)||void 0},removeItem(t){Po()&&localStorage.removeItem(t)},clear(){Po()&&localStorage.clear()}};function Po(){return typeof window<"u"&&typeof localStorage<"u"}function An(t,e){return e==="light"?{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var Zf={};const fl=(typeof process<"u"&&typeof Zf<"u"?Zf.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",AF=[{label:"Coinbase",name:"coinbase",feeRange:"1-2%",url:"",supportedChains:["eip155"]},{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],IF="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",st={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,ONE_SEC_MS:1e3,SECURE_SITE:fl,SECURE_SITE_DASHBOARD:`${fl}/dashboard`,SECURE_SITE_FAVICON:`${fl}/images/favicon.png`,WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:["eip155","solana"],DEFAULT_FEATURES:{swaps:!0,onramp:!0,receive:!0,send:!0,email:!0,emailShowWallets:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],history:!0,analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal"}},Z={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=Z.getActiveNamespace(),e=Z.getActiveCaipNetworkId(),r=e?e.split(":")[1]:void 0,n=r?isNaN(Number(r))?r:Number(r):void 0;return{namespace:t,caipNetworkId:e,chainId:n}},setWalletConnectDeepLink({name:t,href:e}){try{fe.setItem(me.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=fe.getItem(me.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{fe.removeItem(me.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{fe.setItem(me.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{fe.setItem(me.ACTIVE_CAIP_NETWORK_ID,t),Z.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return fe.getItem(me.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{fe.removeItem(me.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=hl(t);fe.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=Z.getRecentWallets();e.find(n=>n.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),fe.setItem(me.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=fe.getItem(me.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(t,e){try{const r=hl(t);fe.setItem(r,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return fe.getItem(me.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=hl(t);return fe.getItem(e)}catch{console.info("Unable to get connected connector id in namespace ",t)}},setConnectedSocialProvider(t){try{fe.setItem(me.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return fe.getItem(me.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{fe.removeItem(me.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return fe.getItem(me.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var r;const t=fe.getItem(me.ACTIVE_CAIP_NETWORK_ID);return(r=t==null?void 0:t.split(":"))==null?void 0:r[1]},setConnectionStatus(t){try{fe.setItem(me.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return fe.getItem(me.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=fe.getItem(me.CONNECTED_NAMESPACES);return t!=null&&t.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));fe.setItem(me.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=Z.getConnectedNamespaces();e.includes(t)||(e.push(t),Z.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=Z.getConnectedNamespaces(),r=e.indexOf(t);r>-1&&(e.splice(r,1),Z.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return fe.getItem(me.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{fe.setItem(me.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{fe.removeItem(me.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=fe.getItem(me.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=Z.getBalanceCache();fe.setItem(me.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const r=Z.getBalanceCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.portfolio))return r.balance;Z.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=Z.getBalanceCache();e[t.caipAddress]=t,fe.setItem(me.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=fe.getItem(me.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=Z.getBalanceCache();fe.setItem(me.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const r=Z.getNativeBalanceCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.nativeBalance))return r;console.info("Discarding cache for address",t),Z.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=Z.getNativeBalanceCache();e[t.caipAddress]=t,fe.setItem(me.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=fe.getItem(me.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const r=Z.getEnsCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.ens))return r.ens;Z.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=Z.getEnsCache();e[t.address]=t,fe.setItem(me.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=Z.getEnsCache();fe.setItem(me.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=fe.getItem(me.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const r=Z.getIdentityCache()[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.identity))return r.identity;Z.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=Z.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},fe.setItem(me.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=Z.getIdentityCache();fe.setItem(me.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{fe.removeItem(me.PORTFOLIO_CACHE),fe.removeItem(me.NATIVE_BALANCE_CACHE),fe.removeItem(me.ENS_CACHE),fe.removeItem(me.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{fe.setItem(me.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=fe.getItem(me.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const r={...Z.getConnections(),[e]:t};fe.setItem(me.CONNECTIONS,JSON.stringify(r))}catch(r){console.error("Unable to sync connections to storage",r)}},getConnections(){try{const t=fe.getItem(me.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}}},ae={isMobile(){var t;return this.isClient()?!!((t=window==null?void 0:window.matchMedia("(pointer:coarse)"))!=null&&t.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t==null?void 0:t.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return ae.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=st.TEN_SEC_MS:!0},isAllowedRetry(t,e=st.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},getPairingExpiry(){return Date.now()+st.FOUR_MINUTES_MS},getNetworkId(t){return t==null?void 0:t.split(":")[1]},getPlainAddress(t){return t==null?void 0:t.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let r;return(...n)=>{function s(){t(...n)}r&&clearTimeout(r),r=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,r=null){if(ae.isHttpUrl(t))return this.formatUniversalUrl(t,e);let n=t,s=r;n.includes("://")||(n=t.replaceAll("/","").replaceAll(":",""),n=`${n}://`),n.endsWith("/")||(n=`${n}/`),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${n}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:n}},formatUniversalUrl(t,e){if(!ae.isHttpUrl(t))return this.formatNativeUrl(t,e);let r=t;r.endsWith("/")||(r=`${r}/`);const n=encodeURIComponent(e);return{redirect:`${r}wc?uri=${n}`,href:r}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?Z.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,r){window==null||window.open(t,this.getOpenTargetForPlatform(e),r||"noreferrer noopener")},returnOpenHref(t,e,r){return window==null?void 0:window.open(t,this.getOpenTargetForPlatform(e),r||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var r,n,s;if(typeof window>"u")return!1;const t=(n=(r=window.matchMedia)==null?void 0:r.call(window,"(display-mode: standalone)"))==null?void 0:n.matches,e=(s=window==null?void 0:window.navigator)==null?void 0:s.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((r,n)=>{const s=new Image;s.onload=r,s.onerror=n,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,ae.wait(2e3)])},formatBalance(t,e){let r="0.000";if(typeof t=="string"){const n=Number(t);if(n){const s=Math.floor(n*1e3)/1e3;s&&(r=s.toString())}}return`${r}${e?` ${e}`:""}`},formatBalance2(t,e){var n;let r;if(t==="0")r="0";else if(typeof t=="string"){const s=Number(t);s&&(r=(n=s.toString().match(/^-?\d+(?:\.\d{0,3})?/u))==null?void 0:n[0])}return{value:r??"0",rest:r==="0"?"000":"",symbol:e}},getApiUrl(){return q.W3M_API_URL},getBlockchainApiUrl(){return q.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return q.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){var e,r;return typeof t=="string"?t:typeof((r=(e=t==null?void 0:t.issues)==null?void 0:e[0])==null?void 0:r.message)=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const r={};return e&&t&&(t.forEach((n,s)=>{r[n]=s}),e.sort((n,s)=>{const i=r[n.id],o=r[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const r of t)e+=r.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[r,n]=e.split(".");return{dollars:r,pennies:n}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const r=new Set;return t.filter(n=>{const s=n[e];return r.has(s)?!1:(r.add(s),!0)})},generateSdkVersion(t,e,r){const s=t.length===0?st.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${r}`},createAccount(t,e,r,n,s){return{namespace:t,address:e,type:r,publicKey:n,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),r=e[0];return e.filter(Boolean).length===3&&r in q.CHAIN_NAME_MAP},isMac(){const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,r="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),r,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,r,e)},injectIntoUrl(t,e,r){const n=t.indexOf(e);if(n===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",n),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,n+i),c=t.substring(n+i,o),u=t.substring(s),l=c+r;return a+l+u}};async function co(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class qa{constructor({baseUrl:e,clientId:r}){this.baseUrl=e,this.clientId=r}async get({headers:e,signal:r,cache:n,...s}){const i=this.createUrl(s);return(await co(i,{method:"GET",headers:e,signal:r,cache:n})).json()}async getBlob({headers:e,signal:r,...n}){const s=this.createUrl(n);return(await co(s,{method:"GET",headers:e,signal:r})).blob()}async post({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await co(i,{method:"POST",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}async put({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await co(i,{method:"PUT",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}async delete({body:e,headers:r,signal:n,...s}){const i=this.createUrl(s);return(await co(i,{method:"DELETE",headers:r,body:e?JSON.stringify(e):void 0,signal:n})).json()}createUrl({path:e,params:r}){const n=new URL(e,this.baseUrl);return r&&Object.entries(r).forEach(([s,i])=>{i&&n.searchParams.append(s,i)}),this.clientId&&n.searchParams.append("clientId",this.clientId),n}}const t_={getFeatureValue(t,e){const r=e==null?void 0:e[t];return r===void 0?st.DEFAULT_FEATURES[t]:r},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(ae.isTelegram()){if(ae.isIos())return t.filter(e=>e!=="google");if(ae.isMac())return t.filter(e=>e!=="x");if(ae.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},ce=Ye({features:st.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:st.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1}),F={state:ce,subscribeKey(t,e){return Rt(ce,t,e)},setOptions(t){Object.assign(ce,t)},setFeatures(t){if(!t)return;ce.features||(ce.features=st.DEFAULT_FEATURES);const e={...ce.features,...t};ce.features=e,ce.features.socials&&(ce.features.socials=t_.filterSocialsByPlatform(ce.features.socials))},setProjectId(t){ce.projectId=t},setCustomRpcUrls(t){ce.customRpcUrls=t},setAllWallets(t){ce.allWallets=t},setIncludeWalletIds(t){ce.includeWalletIds=t},setExcludeWalletIds(t){ce.excludeWalletIds=t},setFeaturedWalletIds(t){ce.featuredWalletIds=t},setTokens(t){ce.tokens=t},setTermsConditionsUrl(t){ce.termsConditionsUrl=t},setPrivacyPolicyUrl(t){ce.privacyPolicyUrl=t},setCustomWallets(t){ce.customWallets=t},setIsSiweEnabled(t){ce.isSiweEnabled=t},setIsUniversalProvider(t){ce.isUniversalProvider=t},setSdkVersion(t){ce.sdkVersion=t},setMetadata(t){ce.metadata=t},setDisableAppend(t){ce.disableAppend=t},setEIP6963Enabled(t){ce.enableEIP6963=t},setDebug(t){ce.debug=t},setEnableWalletConnect(t){ce.enableWalletConnect=t},setEnableWalletGuide(t){ce.enableWalletGuide=t},setEnableAuthLogger(t){ce.enableAuthLogger=t},setEnableWallets(t){ce.enableWallets=t},setPreferUniversalLinks(t){ce.experimental_preferUniversalLinks=t},setHasMultipleAddresses(t){ce.hasMultipleAddresses=t},setSIWX(t){ce.siwx=t},setConnectMethodsOrder(t){ce.features={...ce.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){ce.features={...ce.features,walletFeaturesOrder:t}},setSocialsOrder(t){ce.features={...ce.features,socials:t}},setCollapseWallets(t){ce.features={...ce.features,collapseWallets:t}},setEnableEmbedded(t){ce.enableEmbedded=t},setAllowUnsupportedChain(t){ce.allowUnsupportedChain=t},setManualWCControl(t){ce.manualWCControl=t},setEnableNetworkSwitch(t){ce.enableNetworkSwitch=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,r])=>{r&&(ce.defaultAccountTypes[e]=r)})},setUniversalProviderConfigOverride(t){ce.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return ce.universalProviderConfigOverride},getSnapshot(){return Ko(ce)}},r_=Object.freeze({enabled:!0,events:[]}),n_=new qa({baseUrl:ae.getAnalyticsUrl(),clientId:null}),s_=5,i_=60*1e3,$n=Ye({...r_}),o_={state:$n,subscribeKey(t,e){return Rt($n,t,e)},async sendError(t,e){if(!$n.enabled)return;const r=Date.now();if($n.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return r-o<i_}).length>=s_)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};$n.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=F.state;await n_.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:ae.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch(i){console.error("Error sending telemetry event:",i)}},enable(){$n.enabled=!0},disable(){$n.enabled=!1},clearEvents(){$n.events=[]}};class Yo extends Error{constructor(e,r,n){super(e),this.name="AppKitError",this.category=r,this.originalError=n,Error.captureStackTrace&&Error.captureStackTrace(this,Yo)}}function Jf(t,e){const r=t instanceof Yo?t:new Yo(t instanceof Error?t.message:String(t),e,t);throw o_.sendError(r,r.category),r}function Cr(t,e="INTERNAL_SDK_ERROR"){const r={};return Object.keys(t).forEach(n=>{const s=t[n];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return Jf(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return Jf(a,e)}},r[n]=i}else r[n]=s}),r}const a_={handleMobileDeeplinkRedirect(t){const e=window.location.href,r=encodeURIComponent(e);if(t==="Phantom"&&!("phantom"in window)){const n=e.startsWith("https")?"https":"http",s=e.split("/")[2],i=encodeURIComponent(`${n}://${s}`);window.location.href=`https://phantom.app/ul/browse/${r}?ref=${i}`}P.state.activeChain===q.CHAIN.SOLANA&&t==="Coinbase Wallet"&&!("coinbaseSolana"in window)&&(window.location.href=`https://go.cb-w.com/dapp?cb_url=${r}`)}},tr=Ye({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),c_={state:tr,subscribeNetworkImages(t){return Bt(tr.networkImages,()=>t(tr.networkImages))},subscribeKey(t,e){return Rt(tr,t,e)},subscribe(t){return Bt(tr,()=>t(tr))},setWalletImage(t,e){tr.walletImages[t]=e},setNetworkImage(t,e){tr.networkImages[t]=e},setChainImage(t,e){tr.chainImages[t]=e},setConnectorImage(t,e){tr.connectorImages={...tr.connectorImages,[t]:e}},setTokenImage(t,e){tr.tokenImages[t]=e},setCurrencyImage(t,e){tr.currencyImages[t]=e}},$r=Cr(c_),u_={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},pl=Ye({networkImagePromises:{}}),ew={async fetchWalletImage(t){if(t)return await ue._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(pl.networkImagePromises[t]||(pl.networkImagePromises[t]=ue._fetchNetworkImage(t)),await pl.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return $r.state.walletImages[t]},getWalletImage(t){if(t!=null&&t.image_url)return t==null?void 0:t.image_url;if(t!=null&&t.image_id)return $r.state.walletImages[t.image_id]},getNetworkImage(t){var e,r,n;if((e=t==null?void 0:t.assets)!=null&&e.imageUrl)return(r=t==null?void 0:t.assets)==null?void 0:r.imageUrl;if((n=t==null?void 0:t.assets)!=null&&n.imageId)return $r.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return $r.state.networkImages[t]},getConnectorImage(t){if(t!=null&&t.imageUrl)return t.imageUrl;if(t!=null&&t.imageId)return $r.state.connectorImages[t.imageId]},getChainImage(t){return $r.state.networkImages[u_[t]]}},Dn=Ye({message:"",variant:"info",open:!1}),l_={state:Dn,subscribeKey(t,e){return Rt(Dn,t,e)},open(t,e){const{debug:r}=F.state,{shortMessage:n,longMessage:s}=t;r&&(Dn.message=n,Dn.variant=e,Dn.open=!0),s&&console.error(typeof s=="function"?s():s)},close(){Dn.open=!1,Dn.message="",Dn.variant="info"}},Lt=Cr(l_),d_=ae.getAnalyticsUrl(),h_=new qa({baseUrl:d_,clientId:null}),f_=["MODAL_CREATED"],dn=Ye({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),Ge={state:dn,subscribe(t){return Bt(dn,()=>t(dn))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:r}=F.state;return{projectId:t,st:e,sv:r||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(t){try{const e=ne.state.address;if(f_.includes(t.data.event)||typeof window>"u")return;await h_.post({path:"/e",params:Ge.getSdkProperties(),body:{eventId:ae.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e}}}),dn.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===q.HTTP_STATUS_CODES.FORBIDDEN&&!dn.reportedErrors.FORBIDDEN&&(Lt.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${Po()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),dn.reportedErrors.FORBIDDEN=!0)}},sendEvent(t){var e;dn.timestamp=Date.now(),dn.data=t,(e=F.state.features)!=null&&e.analytics&&Ge._sendAnalyticsEvent(dn)}},gl={PHANTOM:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",COINBASE:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393"},p_=ae.getApiUrl(),rr=new qa({baseUrl:p_,clientId:null}),g_=40,Xf=4,m_=20,ye=Ye({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),ue={state:ye,subscribeKey(t,e){return Rt(ye,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:r}=F.state;return{projectId:t,st:e||"appkit",sv:r||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return F.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${rr.baseUrl}/getWalletImage/${t}`,r=await rr.getBlob({path:e,params:ue._getSdkProperties()});$r.setWalletImage(t,URL.createObjectURL(r))},async _fetchNetworkImage(t){const e=`${rr.baseUrl}/public/getAssetImage/${t}`,r=await rr.getBlob({path:e,params:ue._getSdkProperties()});$r.setNetworkImage(t,URL.createObjectURL(r))},async _fetchConnectorImage(t){const e=`${rr.baseUrl}/public/getAssetImage/${t}`,r=await rr.getBlob({path:e,params:ue._getSdkProperties()});$r.setConnectorImage(t,URL.createObjectURL(r))},async _fetchCurrencyImage(t){const e=`${rr.baseUrl}/public/getCurrencyImage/${t}`,r=await rr.getBlob({path:e,params:ue._getSdkProperties()});$r.setCurrencyImage(t,URL.createObjectURL(r))},async _fetchTokenImage(t){const e=`${rr.baseUrl}/public/getTokenImage/${t}`,r=await rr.getBlob({path:e,params:ue._getSdkProperties()});$r.setTokenImage(t,URL.createObjectURL(r))},_filterWalletsByPlatform(t){return ae.isMobile()?t==null?void 0:t.filter(r=>r.mobile_link||r.id===gl.COINBASE||r.id===gl.PHANTOM&&P.state.activeChain==="solana"):t},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await rr.get({path:"/projects/v1/origins",params:ue._getSdkProperties()});return t}catch{return[]}},async fetchNetworkImages(){const t=P.getAllRequestedCaipNetworks(),e=t==null?void 0:t.map(({assets:r})=>r==null?void 0:r.imageId).filter(Boolean).filter(r=>!ew.getNetworkImageById(r));e&&await Promise.allSettled(e.map(r=>ue._fetchNetworkImage(r)))},async fetchConnectorImages(){const{connectors:t}=ee.state,e=t.map(({imageId:r})=>r).filter(Boolean);await Promise.allSettled(e.map(r=>ue._fetchConnectorImage(r)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>ue._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>ue._fetchTokenImage(e)))},async fetchWallets(t){var i;const e=t.exclude??[];ue._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(gl));const n=await rr.get({path:"/getWallets",params:{...ue._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:(i=t.include)==null?void 0:i.join(","),exclude:e.join(",")}});return{data:ue._filterWalletsByPlatform(n==null?void 0:n.data)||[],count:n==null?void 0:n.count}},async fetchFeaturedWallets(){const{featuredWalletIds:t}=F.state;if(t!=null&&t.length){const e={...ue._getSdkProperties(),page:1,entries:(t==null?void 0:t.length)??Xf,include:t},{data:r}=await ue.fetchWallets(e);r.sort((s,i)=>t.indexOf(s.id)-t.indexOf(i.id));const n=r.map(s=>s.image_id).filter(Boolean);await Promise.allSettled(n.map(s=>ue._fetchWalletImage(s))),ye.featured=r,ye.allFeatured=r}},async fetchRecommendedWallets(){try{ye.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:r}=F.state,n=[...e??[],...r??[]].filter(Boolean),s=P.getRequestedCaipNetworkIds().join(","),i={page:1,entries:Xf,include:t,exclude:n,chains:s},{data:o,count:a}=await ue.fetchWallets(i),c=Z.getRecentWallets(),u=o.map(d=>d.image_id).filter(Boolean),l=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...u,...l].map(d=>ue._fetchWalletImage(d))),ye.recommended=o,ye.allRecommended=o,ye.count=a??0}catch{}finally{ye.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:r,featuredWalletIds:n}=F.state,s=P.getRequestedCaipNetworkIds().join(","),i=[...ye.recommended.map(({id:l})=>l),...r??[],...n??[]].filter(Boolean),o={page:t,entries:g_,include:e,exclude:i,chains:s},{data:a,count:c}=await ue.fetchWallets(o),u=a.slice(0,m_).map(l=>l.image_id).filter(Boolean);await Promise.allSettled(u.map(l=>ue._fetchWalletImage(l))),ye.wallets=ae.uniqueBy([...ye.wallets,...ue._filterOutExtensions(a)],"id").filter(l=>{var d;return(d=l.chains)==null?void 0:d.some(h=>s.includes(h))}),ye.count=c>ye.count?c:ye.count,ye.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:r}=await ue.fetchWallets(e);r&&r.forEach(n=>{ye.excludedWallets.push({rdns:n.rdns,name:n.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:r,excludeWalletIds:n}=F.state,s=P.getRequestedCaipNetworkIds().join(",");ye.search=[];const i={page:1,entries:100,search:t==null?void 0:t.trim(),badge_type:e,include:r,exclude:n,chains:s},{data:o}=await ue.fetchWallets(i);Ge.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>ue._fetchWalletImage(c)),ae.wait(300)]),ye.search=ue._filterOutExtensions(o)},initPromise(t,e){const r=ye.promises[t];return r||(ye.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:r=!0,fetchNetworkImages:n=!0}={}){const s=[t&&ue.initPromise("connectorImages",ue.fetchConnectorImages),e&&ue.initPromise("featuredWallets",ue.fetchFeaturedWallets),r&&ue.initPromise("recommendedWallets",ue.fetchRecommendedWallets),n&&ue.initPromise("networkImages",ue.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){var t;(t=F.state.features)!=null&&t.analytics&&ue.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await rr.get({path:"/getAnalyticsConfig",params:ue._getSdkProperties()});F.setFeatures({analytics:t})}catch{F.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!(t!=null&&t.length)){ye.featured=ye.allFeatured,ye.recommended=ye.allRecommended;return}const e=P.getRequestedCaipNetworkIds().join(",");ye.featured=ye.allFeatured.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),ye.recommended=ye.allRecommended.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),ye.filteredWallets=ye.wallets.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))})},clearFilterByNamespaces(){ye.filteredWallets=[]},setFilterByNamespace(t){if(!t){ye.featured=ye.allFeatured,ye.recommended=ye.allRecommended;return}const e=P.getRequestedCaipNetworkIds().join(",");ye.featured=ye.allFeatured.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),ye.recommended=ye.allRecommended.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))}),ye.filteredWallets=ye.wallets.filter(r=>{var n;return(n=r.chains)==null?void 0:n.some(s=>e.includes(s))})}},Re=Ye({view:"Connect",history:["Connect"],transactionStack:[]}),y_={state:Re,subscribeKey(t,e){return Rt(Re,t,e)},pushTransactionStack(t){Re.transactionStack.push(t)},popTransactionStack(t){var r,n;const e=Re.transactionStack.pop();if(e)if(t)Ae.goBack(),(r=e==null?void 0:e.onCancel)==null||r.call(e);else{if(e.goBack)Ae.goBack();else if(e.replace){const i=Re.history.indexOf("ConnectingSiwe");i>0?Ae.goBackToIndex(i-1):(tt.close(!0),Re.history=[])}else e.view&&Ae.reset(e.view);(n=e==null?void 0:e.onSuccess)==null||n.call(e)}},push(t,e){t!==Re.view&&(Re.view=t,Re.history.push(t),Re.data=e)},reset(t,e){Re.view=t,Re.history=[t],Re.data=e},replace(t,e){Re.history.at(-1)===t||(Re.view=t,Re.history[Re.history.length-1]=t,Re.data=e)},goBack(){var e;const t=!P.state.activeCaipAddress&&Ae.state.view==="ConnectingFarcaster";if(Re.history.length>1&&!Re.history.includes("UnsupportedChain")){Re.history.pop();const[r]=Re.history.slice(-1);r&&(Re.view=r)}else tt.close();(e=Re.data)!=null&&e.wallet&&(Re.data.wallet=void 0),setTimeout(()=>{var r,n,s;if(t){ne.setFarcasterUrl(void 0,P.state.activeChain);const i=ee.getAuthConnector();(r=i==null?void 0:i.provider)==null||r.reload();const o=Ko(F.state);(s=(n=i==null?void 0:i.provider)==null?void 0:n.syncDappData)==null||s.call(n,{metadata:o.metadata,sdkVersion:o.sdkVersion,projectId:o.projectId,sdkType:o.sdkType})}},100)},goBackToIndex(t){if(Re.history.length>1){Re.history=Re.history.slice(0,t+1);const[e]=Re.history.slice(-1);e&&(Re.view=e)}}},Ae=Cr(y_),hn=Ye({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Td={state:hn,subscribe(t){return Bt(hn,()=>t(hn))},setThemeMode(t){hn.themeMode=t;try{const e=ee.getAuthConnector();if(e){const r=Td.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:r,w3mThemeVariables:An(r,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){hn.themeVariables={...hn.themeVariables,...t};try{const e=ee.getAuthConnector();if(e){const r=Td.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:r,w3mThemeVariables:An(hn.themeVariables,hn.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Ko(hn)}},Gt=Cr(Td),tw={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},Se=Ye({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...tw},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),w_={state:Se,subscribe(t){return Bt(Se,()=>{t(Se)})},subscribeKey(t,e){return Rt(Se,t,e)},initialize(t){t.forEach(e=>{const r=Z.getConnectedConnectorId(e);r&&ee.setConnectorId(r,e)})},setActiveConnector(t){t&&(Se.activeConnector=Rs(t))},setConnectors(t){t.filter(s=>!Se.allConnectors.some(i=>i.id===s.id&&ee.getConnectorName(i.name)===ee.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&Se.allConnectors.push(Rs(s))});const r=ee.getEnabledNamespaces(),n=ee.getEnabledConnectors(r);Se.connectors=ee.mergeMultiChainConnectors(n)},filterByNamespaces(t){Object.keys(Se.filterByNamespaceMap).forEach(e=>{Se.filterByNamespaceMap[e]=!1}),t.forEach(e=>{Se.filterByNamespaceMap[e]=!0}),ee.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){Se.filterByNamespaceMap[t]=e,ee.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=ee.getEnabledNamespaces(),e=ee.getEnabledConnectors(t),r=ee.areAllNamespacesEnabled();Se.connectors=ee.mergeMultiChainConnectors(e),r?ue.clearFilterByNamespaces():ue.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(Se.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return Se.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(Se.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=ee.generateConnectorMapByName(t),r=[];return e.forEach(n=>{const s=n[0],i=(s==null?void 0:s.id)===q.CONNECTOR_ID.AUTH;n.length>1&&s?r.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...n],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&r.push(s)}),r},generateConnectorMapByName(t){const e=new Map;return t.forEach(r=>{const{name:n}=r,s=ee.getConnectorName(n);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===r.chain)||i.push(r),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(r=>{e.find(n=>n.chain===r.chain)||e.push(r)}),e},addConnector(t){var e,r,n;if(t.id===q.CONNECTOR_ID.AUTH){const s=t,i=Ko(F.state),o=Gt.getSnapshot().themeMode,a=Gt.getSnapshot().themeVariables;(r=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||r.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(n=s==null?void 0:s.provider)==null||n.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:An(a,o)}),ee.setConnectors([t])}else ee.setConnectors([t])},getAuthConnector(t){var n;const e=t||P.state.activeChain,r=Se.connectors.find(s=>s.id===q.CONNECTOR_ID.AUTH);if(r)return(n=r==null?void 0:r.connectors)!=null&&n.length?r.connectors.find(i=>i.chain===e):r},getAnnouncedConnectorRdns(){return Se.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>{var e;return(e=t.info)==null?void 0:e.rdns})},getConnectorById(t){return Se.allConnectors.find(e=>e.id===t)},getConnector(t,e){return Se.allConnectors.filter(n=>n.chain===P.state.activeChain).find(n=>{var s;return n.explorerId===t||((s=n.info)==null?void 0:s.rdns)===e})},syncIfAuthConnector(t){var i,o;if(t.id!=="ID_AUTH")return;const e=t,r=Ko(F.state),n=Gt.getSnapshot().themeMode,s=Gt.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:r.metadata,sdkVersion:r.sdkVersion,sdkType:r.sdkType,projectId:r.projectId}),e.provider.syncTheme({themeMode:n,themeVariables:s,w3mThemeVariables:An(s,n)})},getConnectorsByNamespace(t){const e=Se.allConnectors.filter(r=>r.chain===t);return ee.mergeMultiChainConnectors(e)},selectWalletConnector(t){const e=ee.getConnector(t.id,t.rdns);a_.handleMobileDeeplinkRedirect((e==null?void 0:e.name)||t.name||""),e?Ae.push("ConnectingExternal",{connector:e}):Ae.push("ConnectingWalletConnect",{wallet:t})},getConnectors(t){return t?ee.getConnectorsByNamespace(t):ee.mergeMultiChainConnectors(Se.allConnectors)},setFilterByNamespace(t){Se.filterByNamespace=t,Se.connectors=ee.getConnectors(t),ue.setFilterByNamespace(t)},setConnectorId(t,e){t&&(Se.activeConnectorIds={...Se.activeConnectorIds,[e]:t},Z.setConnectedConnectorId(e,t))},removeConnectorId(t){Se.activeConnectorIds={...Se.activeConnectorIds,[t]:void 0},Z.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return Se.activeConnectorIds[t]},isConnected(t){return t?!!Se.activeConnectorIds[t]:Object.values(Se.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){Se.activeConnectorIds={...tw}}},ee=Cr(w_);function uc(t,e){return ee.getConnectorId(t)===e}function b_(t){const e=Array.from(P.state.chains.keys());let r=[];return t?(r.push([t,P.state.chains.get(t)]),uc(t,q.CONNECTOR_ID.WALLET_CONNECT)?e.forEach(n=>{n!==t&&uc(n,q.CONNECTOR_ID.WALLET_CONNECT)&&r.push([n,P.state.chains.get(n)])}):uc(t,q.CONNECTOR_ID.AUTH)&&e.forEach(n=>{n!==t&&uc(n,q.CONNECTOR_ID.AUTH)&&r.push([n,P.state.chains.get(n)])})):r=Array.from(P.state.chains.entries()),r}var lc={exports:{}},Qf;function v_(){if(Qf)return lc.exports;Qf=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(E,y,_){return Function.prototype.apply.call(E,y,_)},r;t&&typeof t.ownKeys=="function"?r=t.ownKeys:Object.getOwnPropertySymbols?r=function(E){return Object.getOwnPropertyNames(E).concat(Object.getOwnPropertySymbols(E))}:r=function(E){return Object.getOwnPropertyNames(E)};function n(A){console&&console.warn&&console.warn(A)}var s=Number.isNaN||function(E){return E!==E};function i(){i.init.call(this)}lc.exports=i,lc.exports.once=w,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(A){if(typeof A!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(A){if(typeof A!="number"||A<0||s(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");o=A}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(E){if(typeof E!="number"||E<0||s(E))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+E+".");return this._maxListeners=E,this};function c(A){return A._maxListeners===void 0?i.defaultMaxListeners:A._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(E){for(var y=[],_=1;_<arguments.length;_++)y.push(arguments[_]);var T=E==="error",S=this._events;if(S!==void 0)T=T&&S.error===void 0;else if(!T)return!1;if(T){var x;if(y.length>0&&(x=y[0]),x instanceof Error)throw x;var O=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw O.context=x,O}var L=S[E];if(L===void 0)return!1;if(typeof L=="function")e(L,this,y);else for(var M=L.length,R=p(L,M),_=0;_<M;++_)e(R[_],this,y);return!0};function u(A,E,y,_){var T,S,x;if(a(y),S=A._events,S===void 0?(S=A._events=Object.create(null),A._eventsCount=0):(S.newListener!==void 0&&(A.emit("newListener",E,y.listener?y.listener:y),S=A._events),x=S[E]),x===void 0)x=S[E]=y,++A._eventsCount;else if(typeof x=="function"?x=S[E]=_?[y,x]:[x,y]:_?x.unshift(y):x.push(y),T=c(A),T>0&&x.length>T&&!x.warned){x.warned=!0;var O=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(E)+" listeners added. Use emitter.setMaxListeners() to increase limit");O.name="MaxListenersExceededWarning",O.emitter=A,O.type=E,O.count=x.length,n(O)}return A}i.prototype.addListener=function(E,y){return u(this,E,y,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(E,y){return u(this,E,y,!0)};function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(A,E,y){var _={fired:!1,wrapFn:void 0,target:A,type:E,listener:y},T=l.bind(_);return T.listener=y,_.wrapFn=T,T}i.prototype.once=function(E,y){return a(y),this.on(E,d(this,E,y)),this},i.prototype.prependOnceListener=function(E,y){return a(y),this.prependListener(E,d(this,E,y)),this},i.prototype.removeListener=function(E,y){var _,T,S,x,O;if(a(y),T=this._events,T===void 0)return this;if(_=T[E],_===void 0)return this;if(_===y||_.listener===y)--this._eventsCount===0?this._events=Object.create(null):(delete T[E],T.removeListener&&this.emit("removeListener",E,_.listener||y));else if(typeof _!="function"){for(S=-1,x=_.length-1;x>=0;x--)if(_[x]===y||_[x].listener===y){O=_[x].listener,S=x;break}if(S<0)return this;S===0?_.shift():g(_,S),_.length===1&&(T[E]=_[0]),T.removeListener!==void 0&&this.emit("removeListener",E,O||y)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(E){var y,_,T;if(_=this._events,_===void 0)return this;if(_.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):_[E]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete _[E]),this;if(arguments.length===0){var S=Object.keys(_),x;for(T=0;T<S.length;++T)x=S[T],x!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=_[E],typeof y=="function")this.removeListener(E,y);else if(y!==void 0)for(T=y.length-1;T>=0;T--)this.removeListener(E,y[T]);return this};function h(A,E,y){var _=A._events;if(_===void 0)return[];var T=_[E];return T===void 0?[]:typeof T=="function"?y?[T.listener||T]:[T]:y?m(T):p(T,T.length)}i.prototype.listeners=function(E){return h(this,E,!0)},i.prototype.rawListeners=function(E){return h(this,E,!1)},i.listenerCount=function(A,E){return typeof A.listenerCount=="function"?A.listenerCount(E):f.call(A,E)},i.prototype.listenerCount=f;function f(A){var E=this._events;if(E!==void 0){var y=E[A];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]};function p(A,E){for(var y=new Array(E),_=0;_<E;++_)y[_]=A[_];return y}function g(A,E){for(;E+1<A.length;E++)A[E]=A[E+1];A.pop()}function m(A){for(var E=new Array(A.length),y=0;y<E.length;++y)E[y]=A[y].listener||A[y];return E}function w(A,E){return new Promise(function(y,_){function T(x){A.removeListener(E,S),_(x)}function S(){typeof A.removeListener=="function"&&A.removeListener("error",T),y([].slice.call(arguments))}v(A,E,S,{once:!0}),E!=="error"&&b(A,T,{once:!0})})}function b(A,E,y){typeof A.on=="function"&&v(A,"error",E,y)}function v(A,E,y,_){if(typeof A.on=="function")_.once?A.once(E,y):A.on(E,y);else if(typeof A.addEventListener=="function")A.addEventListener(E,function T(S){_.once&&A.removeEventListener(E,T),y(S)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A)}return lc.exports}var Ar=v_();const qh=xu(Ar);var ml={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Pd=function(t,e){return Pd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)n.hasOwnProperty(s)&&(r[s]=n[s])},Pd(t,e)};function E_(t,e){Pd(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var xd=function(){return xd=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},xd.apply(this,arguments)};function __(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function C_(t,e,r,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,r,i):o(e,r))||i);return s>3&&i&&Object.defineProperty(e,r,i),i}function A_(t,e){return function(r,n){e(r,n,t)}}function I_(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function S_(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(l){try{u(n.next(l))}catch(d){o(d)}}function c(l){try{u(n.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((n=n.apply(t,e||[])).next())})}function N_(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function T_(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}function P_(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Od(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function rw(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=n.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function x_(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(rw(arguments[e]));return t}function O_(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),s=0,e=0;e<r;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)n[s]=i[o];return n}function Zo(t){return this instanceof Zo?(this.v=t,this):new Zo(t)}function R_(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){n[h]&&(s[h]=function(f){return new Promise(function(p,g){i.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{c(n[h](f))}catch(p){d(i[0][3],p)}}function c(h){h.value instanceof Zo?Promise.resolve(h.value.v).then(u,l):d(i[0][2],h)}function u(h){a("next",h)}function l(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function $_(t){var e,r;return e={},n("next"),n("throw",function(s){throw s}),n("return"),e[Symbol.iterator]=function(){return this},e;function n(s,i){e[s]=t[s]?function(o){return(r=!r)?{value:Zo(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function D_(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Od=="function"?Od(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(i){r[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function k_(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function U_(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function L_(t){return t&&t.__esModule?t:{default:t}}function M_(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function B_(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const F_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return xd},__asyncDelegator:$_,__asyncGenerator:R_,__asyncValues:D_,__await:Zo,__awaiter:S_,__classPrivateFieldGet:M_,__classPrivateFieldSet:B_,__createBinding:T_,__decorate:C_,__exportStar:P_,__extends:E_,__generator:N_,__importDefault:L_,__importStar:U_,__makeTemplateObject:k_,__metadata:I_,__param:A_,__read:rw,__rest:__,__spread:x_,__spreadArrays:O_,__values:Od},Symbol.toStringTag,{value:"Module"})),za=FE(F_);var yl={},uo={},ep;function j_(){if(ep)return uo;ep=1,Object.defineProperty(uo,"__esModule",{value:!0}),uo.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return uo.delay=t,uo}var us={},wl={},ls={},tp;function q_(){return tp||(tp=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.ONE_THOUSAND=ls.ONE_HUNDRED=void 0,ls.ONE_HUNDRED=100,ls.ONE_THOUSAND=1e3),ls}var bl={},rp;function z_(){return rp||(rp=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(bl)),bl}var np;function nw(){return np||(np=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=za;e.__exportStar(q_(),t),e.__exportStar(z_(),t)}(wl)),wl}var sp;function H_(){if(sp)return us;sp=1,Object.defineProperty(us,"__esModule",{value:!0}),us.fromMiliseconds=us.toMiliseconds=void 0;const t=nw();function e(n){return n*t.ONE_THOUSAND}us.toMiliseconds=e;function r(n){return Math.floor(n/t.ONE_THOUSAND)}return us.fromMiliseconds=r,us}var ip;function W_(){return ip||(ip=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=za;e.__exportStar(j_(),t),e.__exportStar(H_(),t)}(yl)),yl}var ti={},op;function V_(){if(op)return ti;op=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const s=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:s})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return ti.Watch=t,ti.default=t,ti}var vl={},lo={},ap;function K_(){if(ap)return lo;ap=1,Object.defineProperty(lo,"__esModule",{value:!0}),lo.IWatch=void 0;class t{}return lo.IWatch=t,lo}var cp;function G_(){return cp||(cp=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),za.__exportStar(K_(),t)}(vl)),vl}var up;function Y_(){return up||(up=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=za;e.__exportStar(W_(),t),e.__exportStar(V_(),t),e.__exportStar(G_(),t),e.__exportStar(nw(),t)}(ml)),ml}var W=Y_();class Zs{}let Z_=class extends Zs{constructor(e){super()}};const lp=W.FIVE_SECONDS,Zi={pulse:"heartbeat_pulse"};let J_=class sw extends Z_{constructor(e){super(e),this.events=new Ar.EventEmitter,this.interval=lp,this.interval=(e==null?void 0:e.interval)||lp}static async init(e){const r=new sw(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),W.toMiliseconds(this.interval))}pulse(){this.events.emit(Zi.pulse)}};const X_=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Q_=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,eC=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function tC(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){rC(t);return}return e}function rC(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function dc(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const r=t.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!eC.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(X_.test(t)||Q_.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,tC)}return JSON.parse(t)}catch(n){if(e.strict)throw n;return t}}function nC(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function ht(t,...e){try{return nC(t(...e))}catch(r){return Promise.reject(r)}}function sC(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function iC(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Uc(t){if(sC(t))return String(t);if(iC(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Uc(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Rd="base64:";function oC(t){return typeof t=="string"?t:Rd+uC(t)}function aC(t){return typeof t!="string"||!t.startsWith(Rd)?t:cC(t.slice(Rd.length))}function cC(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function uC(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function Vt(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function lC(...t){return Vt(t.join(":"))}function hc(t){return t=Vt(t),t?t+":":""}function dC(t,e){if(e===void 0)return!0;let r=0,n=t.indexOf(":");for(;n>-1;)r++,n=t.indexOf(":",n+1);return r<=e}function hC(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const fC="memory",pC=()=>{const t=new Map;return{name:fC,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function gC(t={}){const e={mounts:{"":t.driver||pC()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=u=>{for(const l of e.mountpoints)if(u.startsWith(l))return{base:l,relativeKey:u.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:u,driver:e.mounts[""]}},n=(u,l)=>e.mountpoints.filter(d=>d.startsWith(u)||l&&u.startsWith(d)).map(d=>({relativeBase:u.length>d.length?u.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(u,l)=>{if(e.watching){l=Vt(l);for(const d of e.watchListeners)d(u,l)}},i=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await dp(e.mounts[u],s,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,l,d)=>{const h=new Map,f=p=>{let g=h.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},h.set(p.base,g)),g};for(const p of u){const g=typeof p=="string",m=Vt(g?p:p.key),w=g?void 0:p.value,b=g||!p.options?l:{...l,...p.options},v=r(m);f(v).items.push({key:m,value:w,relativeKey:v.relativeKey,options:b})}return Promise.all([...h.values()].map(p=>d(p))).then(p=>p.flat())},c={hasItem(u,l={}){u=Vt(u);const{relativeKey:d,driver:h}=r(u);return ht(h.hasItem,d,l)},getItem(u,l={}){u=Vt(u);const{relativeKey:d,driver:h}=r(u);return ht(h.getItem,d,l).then(f=>dc(f))},getItems(u,l={}){return a(u,l,d=>d.driver.getItems?ht(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),l).then(h=>h.map(f=>({key:lC(d.base,f.key),value:dc(f.value)}))):Promise.all(d.items.map(h=>ht(d.driver.getItem,h.relativeKey,h.options).then(f=>({key:h.key,value:dc(f)})))))},getItemRaw(u,l={}){u=Vt(u);const{relativeKey:d,driver:h}=r(u);return h.getItemRaw?ht(h.getItemRaw,d,l):ht(h.getItem,d,l).then(f=>aC(f))},async setItem(u,l,d={}){if(l===void 0)return c.removeItem(u);u=Vt(u);const{relativeKey:h,driver:f}=r(u);f.setItem&&(await ht(f.setItem,h,Uc(l),d),f.watch||s("update",u))},async setItems(u,l){await a(u,l,async d=>{if(d.driver.setItems)return ht(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:Uc(h.value),options:h.options})),l);d.driver.setItem&&await Promise.all(d.items.map(h=>ht(d.driver.setItem,h.relativeKey,Uc(h.value),h.options)))})},async setItemRaw(u,l,d={}){if(l===void 0)return c.removeItem(u,d);u=Vt(u);const{relativeKey:h,driver:f}=r(u);if(f.setItemRaw)await ht(f.setItemRaw,h,l,d);else if(f.setItem)await ht(f.setItem,h,oC(l),d);else return;f.watch||s("update",u)},async removeItem(u,l={}){typeof l=="boolean"&&(l={removeMeta:l}),u=Vt(u);const{relativeKey:d,driver:h}=r(u);h.removeItem&&(await ht(h.removeItem,d,l),(l.removeMeta||l.removeMata)&&await ht(h.removeItem,d+"$",l),h.watch||s("remove",u))},async getMeta(u,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),u=Vt(u);const{relativeKey:d,driver:h}=r(u),f=Object.create(null);if(h.getMeta&&Object.assign(f,await ht(h.getMeta,d,l)),!l.nativeOnly){const p=await ht(h.getItem,d+"$",l).then(g=>dc(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(u,l,d={}){return this.setItem(u+"$",l,d)},removeMeta(u,l={}){return this.removeItem(u+"$",l)},async getKeys(u,l={}){var m;u=hc(u);const d=n(u,!0);let h=[];const f=[];let p=!0;for(const w of d){(m=w.driver.flags)!=null&&m.maxDepth||(p=!1);const b=await ht(w.driver.getKeys,w.relativeBase,l);for(const v of b){const A=w.mountpoint+Vt(v);h.some(E=>A.startsWith(E))||f.push(A)}h=[w.mountpoint,...h.filter(v=>!v.startsWith(w.mountpoint))]}const g=l.maxDepth!==void 0&&!p;return f.filter(w=>(!g||dC(w,l.maxDepth))&&hC(w,u))},async clear(u,l={}){u=hc(u),await Promise.all(n(u,!1).map(async d=>{if(d.driver.clear)return ht(d.driver.clear,d.relativeBase,l);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",l);return Promise.all(h.map(f=>d.driver.removeItem(f,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>hp(u)))},async watch(u){return await i(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,l){if(u=hc(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[u]=l,e.watching&&Promise.resolve(dp(l,s,u)).then(d=>{e.unwatch[u]=d}).catch(console.error),c},async unmount(u,l=!0){var d,h;u=hc(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&((h=(d=e.unwatch)[u])==null||h.call(d),delete e.unwatch[u]),l&&await hp(e.mounts[u]),e.mountpoints=e.mountpoints.filter(f=>f!==u),delete e.mounts[u])},getMount(u=""){u=Vt(u)+":";const l=r(u);return{driver:l.driver,base:l.base}},getMounts(u="",l={}){return u=Vt(u),n(u,l.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(u,l={})=>c.getKeys(u,l),get:(u,l={})=>c.getItem(u,l),set:(u,l,d={})=>c.setItem(u,l,d),has:(u,l={})=>c.hasItem(u,l),del:(u,l={})=>c.removeItem(u,l),remove:(u,l={})=>c.removeItem(u,l)};return c}function dp(t,e,r){return t.watch?t.watch((n,s)=>e(n,r+s)):()=>{}}async function hp(t){typeof t.dispose=="function"&&await ht(t.dispose)}function Js(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function iw(t,e){let r;const n=()=>{if(r)return r;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),r=Js(s),r.then(i=>{i.onclose=()=>r=void 0},()=>{}),r};return(s,i)=>n().then(o=>i(o.transaction(e,s).objectStore(e)))}let El;function Ha(){return El||(El=iw("keyval-store","keyval")),El}function fp(t,e=Ha()){return e("readonly",r=>Js(r.get(t)))}function mC(t,e,r=Ha()){return r("readwrite",n=>(n.put(e,t),Js(n.transaction)))}function yC(t,e=Ha()){return e("readwrite",r=>(r.delete(t),Js(r.transaction)))}function wC(t=Ha()){return t("readwrite",e=>(e.clear(),Js(e.transaction)))}function bC(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Js(t.transaction)}function vC(t=Ha()){return t("readonly",e=>{if(e.getAllKeys)return Js(e.getAllKeys());const r=[];return bC(e,n=>r.push(n.key)).then(()=>r)})}const EC=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),_C=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(n,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function $s(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return _C(t)}catch{return t}}function Pn(t){return typeof t=="string"?t:EC(t)||""}const CC="idb-keyval";var AC=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=s=>e+s;let n;return t.dbName&&t.storeName&&(n=iw(t.dbName,t.storeName)),{name:CC,options:t,async hasItem(s){return!(typeof await fp(r(s),n)>"u")},async getItem(s){return await fp(r(s),n)??null},setItem(s,i){return mC(r(s),i,n)},removeItem(s){return yC(r(s),n)},getKeys(){return vC(n)},clear(){return wC(n)}}};const IC="WALLET_CONNECT_V2_INDEXED_DB",SC="keyvaluestorage";let NC=class{constructor(){this.indexedDb=gC({driver:AC({dbName:IC,storeName:SC})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,Pn(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var _l=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Lc={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,n){this[r]=String(n)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof _l<"u"&&_l.localStorage?Lc.exports=_l.localStorage:typeof window<"u"&&window.localStorage?Lc.exports=window.localStorage:Lc.exports=new e})();function TC(t){var e;return[t[0],$s((e=t[1])!=null?e:"")]}let PC=class{constructor(){this.localStorage=Lc.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(TC)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return $s(r)}async setItem(e,r){this.localStorage.setItem(e,Pn(r))}async removeItem(e){this.localStorage.removeItem(e)}};const xC="wc_storage_version",pp=1,OC=async(t,e,r)=>{const n=xC,s=await e.getItem(n);if(s&&s>=pp){r(e);return}const i=await t.getKeys();if(!i.length){r(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await t.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(n,pp),r(e),RC(t,o)},RC=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};let $C=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new PC;this.storage=e;try{const r=new NC;OC(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};var Cl,gp;function DC(){if(gp)return Cl;gp=1;function t(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Cl=e;function e(r,n,s){var i=s&&s.stringify||t,o=1;if(typeof r=="object"&&r!==null){var a=n.length+o;if(a===1)return r;var c=new Array(a);c[0]=i(r);for(var u=1;u<a;u++)c[u]=i(n[u]);return c.join(" ")}if(typeof r!="string")return r;var l=n.length;if(l===0)return r;for(var d="",h=1-o,f=-1,p=r&&r.length||0,g=0;g<p;){if(r.charCodeAt(g)===37&&g+1<p){switch(f=f>-1?f:0,r.charCodeAt(g+1)){case 100:case 102:if(h>=l||n[h]==null)break;f<g&&(d+=r.slice(f,g)),d+=Number(n[h]),f=g+2,g++;break;case 105:if(h>=l||n[h]==null)break;f<g&&(d+=r.slice(f,g)),d+=Math.floor(Number(n[h])),f=g+2,g++;break;case 79:case 111:case 106:if(h>=l||n[h]===void 0)break;f<g&&(d+=r.slice(f,g));var m=typeof n[h];if(m==="string"){d+="'"+n[h]+"'",f=g+2,g++;break}if(m==="function"){d+=n[h].name||"<anonymous>",f=g+2,g++;break}d+=i(n[h]),f=g+2,g++;break;case 115:if(h>=l)break;f<g&&(d+=r.slice(f,g)),d+=String(n[h]),f=g+2,g++;break;case 37:f<g&&(d+=r.slice(f,g)),d+="%",f=g+2,g++,h--;break}++h}++g}return f===-1?r:(f<p&&(d+=r.slice(f)),d)}return Cl}var Al,mp;function kC(){if(mp)return Al;mp=1;const t=DC();Al=s;const e=E().console||{},r={mapHttpRequest:p,mapHttpResponse:p,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:p,res:p,err:h};function n(y,_){return Array.isArray(y)?y.filter(function(S){return S!=="!stdSerializers.err"}):y===!0?Object.keys(_):!1}function s(y){y=y||{},y.browser=y.browser||{};const _=y.browser.transmit;if(_&&typeof _.send!="function")throw Error("pino: transmit option must have a send function");const T=y.browser.write||e;y.browser.write&&(y.browser.asObject=!0);const S=y.serializers||{},x=n(y.browser.serialize,S);let O=y.browser.serialize;Array.isArray(y.browser.serialize)&&y.browser.serialize.indexOf("!stdSerializers.err")>-1&&(O=!1);const L=["error","fatal","warn","info","debug","trace"];typeof T=="function"&&(T.error=T.fatal=T.warn=T.info=T.debug=T.trace=T),y.enabled===!1&&(y.level="silent");const M=y.level||"info",R=Object.create(T);R.log||(R.log=m),Object.defineProperty(R,"levelVal",{get:N}),Object.defineProperty(R,"level",{get:$,set:k});const I={transmit:_,serialize:x,asObject:y.browser.asObject,levels:L,timestamp:f(y)};R.levels=s.levels,R.level=M,R.setMaxListeners=R.getMaxListeners=R.emit=R.addListener=R.on=R.prependListener=R.once=R.prependOnceListener=R.removeListener=R.removeAllListeners=R.listeners=R.listenerCount=R.eventNames=R.write=R.flush=m,R.serializers=S,R._serialize=x,R._stdErrSerialize=O,R.child=D,_&&(R._logEvent=d());function N(){return this.level==="silent"?1/0:this.levels.values[this.level]}function $(){return this._level}function k(U){if(U!=="silent"&&!this.levels.values[U])throw Error("unknown level "+U);this._level=U,i(I,R,"error","log"),i(I,R,"fatal","error"),i(I,R,"warn","error"),i(I,R,"info","log"),i(I,R,"debug","log"),i(I,R,"trace","log")}function D(U,H){if(!U)throw new Error("missing bindings for child Pino");H=H||{},x&&U.serializers&&(H.serializers=U.serializers);const G=H.serializers;if(x&&G){var se=Object.assign({},S,G),K=y.browser.serialize===!0?Object.keys(se):x;delete U.serializers,c([U],K,se,this._stdErrSerialize)}function ie(ge){this._childLevel=(ge._childLevel|0)+1,this.error=u(ge,U,"error"),this.fatal=u(ge,U,"fatal"),this.warn=u(ge,U,"warn"),this.info=u(ge,U,"info"),this.debug=u(ge,U,"debug"),this.trace=u(ge,U,"trace"),se&&(this.serializers=se,this._serialize=K),_&&(this._logEvent=d([].concat(ge._logEvent.bindings,U)))}return ie.prototype=this,new ie(this)}return R}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=r,s.stdTimeFunctions=Object.assign({},{nullTime:w,epochTime:b,unixTime:v,isoTime:A});function i(y,_,T,S){const x=Object.getPrototypeOf(_);_[T]=_.levelVal>_.levels.values[T]?m:x[T]?x[T]:e[T]||e[S]||m,o(y,_,T)}function o(y,_,T){!y.transmit&&_[T]===m||(_[T]=function(S){return function(){const O=y.timestamp(),L=new Array(arguments.length),M=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var R=0;R<L.length;R++)L[R]=arguments[R];if(y.serialize&&!y.asObject&&c(L,this._serialize,this.serializers,this._stdErrSerialize),y.asObject?S.call(M,a(this,T,L,O)):S.apply(M,L),y.transmit){const I=y.transmit.level||_.level,N=s.levels.values[I],$=s.levels.values[T];if($<N)return;l(this,{ts:O,methodLevel:T,methodValue:$,transmitValue:s.levels.values[y.transmit.level||_.level],send:y.transmit.send,val:_.levelVal},L)}}}(_[T]))}function a(y,_,T,S){y._serialize&&c(T,y._serialize,y.serializers,y._stdErrSerialize);const x=T.slice();let O=x[0];const L={};S&&(L.time=S),L.level=s.levels.values[_];let M=(y._childLevel|0)+1;if(M<1&&(M=1),O!==null&&typeof O=="object"){for(;M--&&typeof x[0]=="object";)Object.assign(L,x.shift());O=x.length?t(x.shift(),x):void 0}else typeof O=="string"&&(O=t(x.shift(),x));return O!==void 0&&(L.msg=O),L}function c(y,_,T,S){for(const x in y)if(S&&y[x]instanceof Error)y[x]=s.stdSerializers.err(y[x]);else if(typeof y[x]=="object"&&!Array.isArray(y[x]))for(const O in y[x])_&&_.indexOf(O)>-1&&O in T&&(y[x][O]=T[O](y[x][O]))}function u(y,_,T){return function(){const S=new Array(1+arguments.length);S[0]=_;for(var x=1;x<S.length;x++)S[x]=arguments[x-1];return y[T].apply(this,S)}}function l(y,_,T){const S=_.send,x=_.ts,O=_.methodLevel,L=_.methodValue,M=_.val,R=y._logEvent.bindings;c(T,y._serialize||Object.keys(y.serializers),y.serializers,y._stdErrSerialize===void 0?!0:y._stdErrSerialize),y._logEvent.ts=x,y._logEvent.messages=T.filter(function(I){return R.indexOf(I)===-1}),y._logEvent.level.label=O,y._logEvent.level.value=L,S(O,y._logEvent,M),y._logEvent=d(R)}function d(y){return{ts:0,messages:[],bindings:y||[],level:{label:"",value:0}}}function h(y){const _={type:y.constructor.name,msg:y.message,stack:y.stack};for(const T in y)_[T]===void 0&&(_[T]=y[T]);return _}function f(y){return typeof y.timestamp=="function"?y.timestamp:y.timestamp===!1?w:b}function p(){return{}}function g(y){return y}function m(){}function w(){return!1}function b(){return Date.now()}function v(){return Math.round(Date.now()/1e3)}function A(){return new Date(Date.now()).toISOString()}function E(){function y(_){return typeof _<"u"&&_}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return y(self)||y(window)||y(this)||{}}}return Al}var Ei=kC();const Wa=xu(Ei),UC={level:"info"},Va="custom_context",zh=1e3*1024;let LC=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},yp=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new LC(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}},ow=class{constructor(e,r=zh){this.level=e??"error",this.levelValue=Ei.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new yp(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Ei.levels.values.error?console.error(e):r===Ei.levels.values.warn?console.warn(e):r===Ei.levels.values.debug?console.debug(e):r===Ei.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Pn({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new yp(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Pn({extraMetadata:e})),new Blob(r,{type:"application/json"})}},MC=class{constructor(e,r=zh){this.baseChunkLogger=new ow(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),n=document.createElement("a");n.href=r,n.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}},BC=class{constructor(e,r=zh){this.baseChunkLogger=new ow(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var FC=Object.defineProperty,jC=Object.defineProperties,qC=Object.getOwnPropertyDescriptors,wp=Object.getOwnPropertySymbols,zC=Object.prototype.hasOwnProperty,HC=Object.prototype.propertyIsEnumerable,bp=(t,e,r)=>e in t?FC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jc=(t,e)=>{for(var r in e||(e={}))zC.call(e,r)&&bp(t,r,e[r]);if(wp)for(var r of wp(e))HC.call(e,r)&&bp(t,r,e[r]);return t},Xc=(t,e)=>jC(t,qC(e));function Ji(t){return Xc(Jc({},t),{level:(t==null?void 0:t.level)||UC.level})}function WC(t,e=Va){return t[e]||""}function VC(t,e,r=Va){return t[r]=e,t}function Qt(t,e=Va){let r="";return typeof t.bindings>"u"?r=WC(t,e):r=t.bindings().context||"",r}function KC(t,e,r=Va){const n=Qt(t,r);return n.trim()?`${n}/${e}`:e}function $t(t,e,r=Va){const n=KC(t,e,r),s=t.child({context:n});return VC(s,n,r)}function GC(t){var e,r;const n=new MC((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Wa(Xc(Jc({},t.opts),{level:"trace",browser:Xc(Jc({},(r=t.opts)==null?void 0:r.browser),{write:s=>n.write(s)})})),chunkLoggerController:n}}function YC(t){var e;const r=new BC((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Wa(Xc(Jc({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function Hh(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?GC(t):YC(t)}var ZC=Object.defineProperty,JC=(t,e,r)=>e in t?ZC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,vp=(t,e,r)=>JC(t,typeof e!="symbol"?e+"":e,r);let XC=class extends Zs{constructor(e){super(),this.opts=e,vp(this,"protocol","wc"),vp(this,"version",2)}};var QC=Object.defineProperty,e1=(t,e,r)=>e in t?QC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,t1=(t,e,r)=>e1(t,e+"",r);let r1=class extends Zs{constructor(e,r){super(),this.core=e,this.logger=r,t1(this,"records",new Map)}},n1=class{constructor(e,r){this.logger=e,this.core=r}},s1=class extends Zs{constructor(e,r){super(),this.relayer=e,this.logger=r}},i1=class extends Zs{constructor(e){super()}},o1=class{constructor(e,r,n,s){this.core=e,this.logger=r,this.name=n}},a1=class extends Zs{constructor(e,r){super(),this.relayer=e,this.logger=r}},c1=class extends Zs{constructor(e,r){super(),this.core=e,this.logger=r}},u1=class{constructor(e,r,n){this.core=e,this.logger=r,this.store=n}},l1=class{constructor(e,r){this.projectId=e,this.logger=r}},d1=class{constructor(e,r,n){this.core=e,this.logger=r,this.telemetryEnabled=n}};var h1=Object.defineProperty,f1=(t,e,r)=>e in t?h1(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ep=(t,e,r)=>f1(t,typeof e!="symbol"?e+"":e,r);let p1=class{constructor(e){this.opts=e,Ep(this,"protocol","wc"),Ep(this,"version",2)}},g1=class{constructor(e){this.client=e}};function m1(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function aw(t,...e){if(!m1(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function _p(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function y1(t,e){aw(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const ri=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Il=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function w1(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function cw(t){return typeof t=="string"&&(t=w1(t)),aw(t),t}let b1=class{clone(){return this._cloneInto()}};function v1(t){const e=n=>t().update(cw(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function uw(t=32){if(ri&&typeof ri.getRandomValues=="function")return ri.getRandomValues(new Uint8Array(t));if(ri&&typeof ri.randomBytes=="function")return ri.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function E1(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}let _1=class extends b1{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Il(this.buffer)}update(e){_p(this);const{view:r,buffer:n,blockLen:s}=this;e=cw(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Il(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){_p(this),y1(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;E1(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Il(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const fc=BigInt(2**32-1),$d=BigInt(32);function lw(t,e=!1){return e?{h:Number(t&fc),l:Number(t>>$d&fc)}:{h:Number(t>>$d&fc)|0,l:Number(t&fc)|0}}function C1(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=lw(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const A1=(t,e)=>BigInt(t>>>0)<<$d|BigInt(e>>>0),I1=(t,e,r)=>t>>>r,S1=(t,e,r)=>t<<32-r|e>>>r,N1=(t,e,r)=>t>>>r|e<<32-r,T1=(t,e,r)=>t<<32-r|e>>>r,P1=(t,e,r)=>t<<64-r|e>>>r-32,x1=(t,e,r)=>t>>>r-32|e<<64-r,O1=(t,e)=>e,R1=(t,e)=>t,$1=(t,e,r)=>t<<r|e>>>32-r,D1=(t,e,r)=>e<<r|t>>>32-r,k1=(t,e,r)=>e<<r-32|t>>>64-r,U1=(t,e,r)=>t<<r-32|e>>>64-r;function L1(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const M1=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),B1=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,F1=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),j1=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,q1=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),z1=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,be={fromBig:lw,split:C1,toBig:A1,shrSH:I1,shrSL:S1,rotrSH:N1,rotrSL:T1,rotrBH:P1,rotrBL:x1,rotr32H:O1,rotr32L:R1,rotlSH:$1,rotlSL:D1,rotlBH:k1,rotlBL:U1,add:L1,add3L:M1,add3H:B1,add4L:F1,add4H:j1,add5H:z1,add5L:q1},[H1,W1]=be.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),kn=new Uint32Array(80),Un=new Uint32Array(80);let V1=class extends _1{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,r,n,s,i,o,a,c,u,l,d,h,f,p,g,m]}set(e,r,n,s,i,o,a,c,u,l,d,h,f,p,g,m){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,r){for(let v=0;v<16;v++,r+=4)kn[v]=e.getUint32(r),Un[v]=e.getUint32(r+=4);for(let v=16;v<80;v++){const A=kn[v-15]|0,E=Un[v-15]|0,y=be.rotrSH(A,E,1)^be.rotrSH(A,E,8)^be.shrSH(A,E,7),_=be.rotrSL(A,E,1)^be.rotrSL(A,E,8)^be.shrSL(A,E,7),T=kn[v-2]|0,S=Un[v-2]|0,x=be.rotrSH(T,S,19)^be.rotrBH(T,S,61)^be.shrSH(T,S,6),O=be.rotrSL(T,S,19)^be.rotrBL(T,S,61)^be.shrSL(T,S,6),L=be.add4L(_,O,Un[v-7],Un[v-16]),M=be.add4H(L,y,x,kn[v-7],kn[v-16]);kn[v]=M|0,Un[v]=L|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:w,Hl:b}=this;for(let v=0;v<80;v++){const A=be.rotrSH(d,h,14)^be.rotrSH(d,h,18)^be.rotrBH(d,h,41),E=be.rotrSL(d,h,14)^be.rotrSL(d,h,18)^be.rotrBL(d,h,41),y=d&f^~d&g,_=h&p^~h&m,T=be.add5L(b,E,_,W1[v],Un[v]),S=be.add5H(T,w,A,y,H1[v],kn[v]),x=T|0,O=be.rotrSH(n,s,28)^be.rotrBH(n,s,34)^be.rotrBH(n,s,39),L=be.rotrSL(n,s,28)^be.rotrBL(n,s,34)^be.rotrBL(n,s,39),M=n&i^n&a^i&a,R=s&o^s&c^o&c;w=g|0,b=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=be.add(u|0,l|0,S|0,x|0),u=a|0,l=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const I=be.add3L(x,L,R);n=be.add3H(I,S,O,M),s=I|0}({h:n,l:s}=be.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=be.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=be.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=be.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=be.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=be.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=be.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:w,l:b}=be.add(this.Hh|0,this.Hl|0,w|0,b|0),this.set(n,s,i,o,a,c,u,l,d,h,f,p,g,m,w,b)}roundClean(){kn.fill(0),Un.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const K1=v1(()=>new V1);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Wh=BigInt(0),dw=BigInt(1),G1=BigInt(2);function Vh(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Kh(t){if(!Vh(t))throw new Error("Uint8Array expected")}function Sl(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Y1=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Gh(t){Kh(t);let e="";for(let r=0;r<t.length;r++)e+=Y1[t[r]];return e}function hw(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Wh:BigInt("0x"+t)}const fn={_0:48,_9:57,A:65,F:70,a:97,f:102};function Cp(t){if(t>=fn._0&&t<=fn._9)return t-fn._0;if(t>=fn.A&&t<=fn.F)return t-(fn.A-10);if(t>=fn.a&&t<=fn.f)return t-(fn.a-10)}function fw(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=Cp(t.charCodeAt(i)),a=Cp(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Z1(t){return hw(Gh(t))}function Mc(t){return Kh(t),hw(Gh(Uint8Array.from(t).reverse()))}function pw(t,e){return fw(t.toString(16).padStart(e*2,"0"))}function Dd(t,e){return pw(t,e).reverse()}function pn(t,e,r){let n;if(typeof e=="string")try{n=fw(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Vh(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function Ap(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Kh(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}const Nl=t=>typeof t=="bigint"&&Wh<=t;function J1(t,e,r){return Nl(t)&&Nl(e)&&Nl(r)&&e<=t&&t<r}function ho(t,e,r,n){if(!J1(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function X1(t){let e;for(e=0;t>Wh;t>>=dw,e+=1);return e}const Q1=t=>(G1<<BigInt(t-1))-dw,eA={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Vh(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Yh(t,e,r={}){const n=(s,i,o)=>{const a=eA[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}function Ip(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const yt=BigInt(0),Qe=BigInt(1),ws=BigInt(2),tA=BigInt(3),kd=BigInt(4),Sp=BigInt(5),Np=BigInt(8);function ct(t,e){const r=t%e;return r>=yt?r:e+r}function rA(t,e,r){if(e<yt)throw new Error("invalid exponent, negatives unsupported");if(r<=yt)throw new Error("invalid modulus");if(r===Qe)return yt;let n=Qe;for(;e>yt;)e&Qe&&(n=n*t%r),t=t*t%r,e>>=Qe;return n}function Hr(t,e,r){let n=t;for(;e-- >yt;)n*=n,n%=r;return n}function Tp(t,e){if(t===yt)throw new Error("invert: expected non-zero number");if(e<=yt)throw new Error("invert: expected positive modulus, got "+e);let r=ct(t,e),n=e,s=yt,i=Qe;for(;r!==yt;){const o=n/r,a=n%r,c=s-i*o;n=r,r=a,s=i,i=c}if(n!==Qe)throw new Error("invert: does not exist");return ct(s,e)}function nA(t){const e=(t-Qe)/ws;let r,n,s;for(r=t-Qe,n=0;r%ws===yt;r/=ws,n++);for(s=ws;s<t&&rA(s,e,t)!==t-Qe;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+Qe)/kd;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(r+Qe)/ws;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,s),r),l=o.pow(a,i),d=o.pow(a,r);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(d);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const f=o.pow(u,Qe<<BigInt(c-h-1));u=o.sqr(f),l=o.mul(l,f),d=o.mul(d,u),c=h}return l}}function sA(t){if(t%kd===tA){const e=(t+Qe)/kd;return function(r,n){const s=r.pow(n,e);if(!r.eql(r.sqr(s),n))throw new Error("Cannot find square root");return s}}if(t%Np===Sp){const e=(t-Sp)/Np;return function(r,n){const s=r.mul(n,ws),i=r.pow(s,e),o=r.mul(n,i),a=r.mul(r.mul(o,ws),i),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return nA(t)}const iA=(t,e)=>(ct(t,e)&Qe)===Qe,oA=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function aA(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=oA.reduce((n,s)=>(n[s]="function",n),e);return Yh(t,r)}function cA(t,e,r){if(r<yt)throw new Error("invalid exponent, negatives unsupported");if(r===yt)return t.ONE;if(r===Qe)return e;let n=t.ONE,s=e;for(;r>yt;)r&Qe&&(n=t.mul(n,s)),s=t.sqr(s),r>>=Qe;return n}function uA(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function gw(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function mw(t,e,r=!1,n={}){if(t<=yt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=gw(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:Q1(s),ZERO:yt,ONE:Qe,create:c=>ct(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return yt<=c&&c<t},is0:c=>c===yt,isOdd:c=>(c&Qe)===Qe,neg:c=>ct(-c,t),eql:(c,u)=>c===u,sqr:c=>ct(c*c,t),add:(c,u)=>ct(c+u,t),sub:(c,u)=>ct(c-u,t),mul:(c,u)=>ct(c*u,t),pow:(c,u)=>cA(a,c,u),div:(c,u)=>ct(c*Tp(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Tp(c,t),sqrt:n.sqrt||(c=>(o||(o=sA(t)),o(a,c))),invertBatch:c=>uA(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>r?Dd(c,i):pw(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?Mc(c):Z1(c)}});return Object.freeze(a)}const Pp=BigInt(0),pc=BigInt(1);function Tl(t,e){const r=e.negate();return t?r:e}function yw(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Pl(t,e){yw(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function lA(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function dA(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const xl=new WeakMap,ww=new WeakMap;function Ol(t){return ww.get(t)||1}function hA(t,e){return{constTimeNegate:Tl,hasPrecomputes(r){return Ol(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>Pp;)n&pc&&(s=s.add(i)),i=i.double(),n>>=pc;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=Pl(n,e),o=[];let a=r,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){const{windows:i,windowSize:o}=Pl(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),l=2**r,d=BigInt(r);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&u);s>>=d,p>o&&(p-=l,s+=pc);const g=f,m=f+Math.abs(p)-1,w=h%2!==0,b=p<0;p===0?c=c.add(Tl(w,n[g])):a=a.add(Tl(b,n[m]))}return{p:a,f:c}},wNAFUnsafe(r,n,s,i=t.ZERO){const{windows:o,windowSize:a}=Pl(r,e),c=BigInt(2**r-1),u=2**r,l=BigInt(r);for(let d=0;d<o;d++){const h=d*a;if(s===Pp)break;let f=Number(s&c);if(s>>=l,f>a&&(f-=u,s+=pc),f===0)continue;let p=n[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(r,n,s){let i=xl.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&xl.set(n,s(i))),i},wNAFCached(r,n,s){const i=Ol(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=Ol(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){yw(n,e),ww.set(r,n),xl.delete(r)}}}function fA(t,e,r,n){if(lA(r,t),dA(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=X1(BigInt(r.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let d=u;d>=0;d-=o){c.fill(s);for(let f=0;f<n.length;f++){const p=n[f],g=Number(p>>BigInt(d)&BigInt(a));c[g]=c[g].add(r[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(l=l.add(h),d!==0)for(let f=0;f<o;f++)l=l.double()}return l}function pA(t){return aA(t.Fp),Yh(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...gw(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Tr=BigInt(0),jt=BigInt(1),gc=BigInt(2),gA=BigInt(8),mA={zip215:!0};function yA(t){const e=pA(t);return Yh(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function wA(t){const e=yA(t),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,u=gc<<BigInt(a*8)-jt,l=r.create,d=mw(e.n,e.nBitLength),h=e.uvRatio||((I,N)=>{try{return{isValid:!0,value:r.sqrt(I*r.inv(N))}}catch{return{isValid:!1,value:Tr}}}),f=e.adjustScalarBytes||(I=>I),p=e.domain||((I,N,$)=>{if(Sl("phflag",$),N.length||$)throw new Error("Contexts/pre-hash are not supported");return I});function g(I,N){ho("coordinate "+I,N,Tr,u)}function m(I){if(!(I instanceof v))throw new Error("ExtendedPoint expected")}const w=Ip((I,N)=>{const{ex:$,ey:k,ez:D}=I,U=I.is0();N==null&&(N=U?gA:r.inv(D));const H=l($*N),G=l(k*N),se=l(D*N);if(U)return{x:Tr,y:jt};if(se!==jt)throw new Error("invZ was invalid");return{x:H,y:G}}),b=Ip(I=>{const{a:N,d:$}=e;if(I.is0())throw new Error("bad point: ZERO");const{ex:k,ey:D,ez:U,et:H}=I,G=l(k*k),se=l(D*D),K=l(U*U),ie=l(K*K),ge=l(G*N),ze=l(K*l(ge+se)),De=l(ie+l($*l(G*se)));if(ze!==De)throw new Error("bad point: equation left != right (1)");const Ie=l(k*D),Pt=l(U*H);if(Ie!==Pt)throw new Error("bad point: equation left != right (2)");return!0});class v{constructor(N,$,k,D){this.ex=N,this.ey=$,this.ez=k,this.et=D,g("x",N),g("y",$),g("z",k),g("t",D),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(N){if(N instanceof v)throw new Error("extended point not allowed");const{x:$,y:k}=N||{};return g("x",$),g("y",k),new v($,k,jt,l($*k))}static normalizeZ(N){const $=r.invertBatch(N.map(k=>k.ez));return N.map((k,D)=>k.toAffine($[D])).map(v.fromAffine)}static msm(N,$){return fA(v,d,N,$)}_setWindowSize(N){y.setWindowSize(this,N)}assertValidity(){b(this)}equals(N){m(N);const{ex:$,ey:k,ez:D}=this,{ex:U,ey:H,ez:G}=N,se=l($*G),K=l(U*D),ie=l(k*G),ge=l(H*D);return se===K&&ie===ge}is0(){return this.equals(v.ZERO)}negate(){return new v(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:N}=e,{ex:$,ey:k,ez:D}=this,U=l($*$),H=l(k*k),G=l(gc*l(D*D)),se=l(N*U),K=$+k,ie=l(l(K*K)-U-H),ge=se+H,ze=ge-G,De=se-H,Ie=l(ie*ze),Pt=l(ge*De),bt=l(ie*De),Dt=l(ze*ge);return new v(Ie,Pt,Dt,bt)}add(N){m(N);const{a:$,d:k}=e,{ex:D,ey:U,ez:H,et:G}=this,{ex:se,ey:K,ez:ie,et:ge}=N;if($===BigInt(-1)){const Ff=l((U-D)*(K+se)),jf=l((U+D)*(K-se)),ll=l(jf-Ff);if(ll===Tr)return this.double();const qf=l(H*gc*ge),zf=l(G*gc*ie),Hf=zf+qf,Wf=jf+Ff,Vf=zf-qf,gE=l(Hf*ll),mE=l(Wf*Vf),yE=l(Hf*Vf),wE=l(ll*Wf);return new v(gE,mE,wE,yE)}const ze=l(D*se),De=l(U*K),Ie=l(G*k*ge),Pt=l(H*ie),bt=l((D+U)*(se+K)-ze-De),Dt=Pt-Ie,dr=Pt+Ie,hr=l(De-$*ze),ei=l(bt*Dt),hE=l(dr*hr),fE=l(bt*hr),pE=l(Dt*dr);return new v(ei,hE,pE,fE)}subtract(N){return this.add(N.negate())}wNAF(N){return y.wNAFCached(this,N,v.normalizeZ)}multiply(N){const $=N;ho("scalar",$,jt,n);const{p:k,f:D}=this.wNAF($);return v.normalizeZ([k,D])[0]}multiplyUnsafe(N,$=v.ZERO){const k=N;return ho("scalar",k,Tr,n),k===Tr?E:this.is0()||k===jt?this:y.wNAFCachedUnsafe(this,k,v.normalizeZ,$)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return y.unsafeLadder(this,n).is0()}toAffine(N){return w(this,N)}clearCofactor(){const{h:N}=e;return N===jt?this:this.multiplyUnsafe(N)}static fromHex(N,$=!1){const{d:k,a:D}=e,U=r.BYTES;N=pn("pointHex",N,U),Sl("zip215",$);const H=N.slice(),G=N[U-1];H[U-1]=G&-129;const se=Mc(H),K=$?u:r.ORDER;ho("pointHex.y",se,Tr,K);const ie=l(se*se),ge=l(ie-jt),ze=l(k*ie-D);let{isValid:De,value:Ie}=h(ge,ze);if(!De)throw new Error("Point.fromHex: invalid y coordinate");const Pt=(Ie&jt)===jt,bt=(G&128)!==0;if(!$&&Ie===Tr&&bt)throw new Error("Point.fromHex: x=0 and x_0=1");return bt!==Pt&&(Ie=l(-Ie)),v.fromAffine({x:Ie,y:se})}static fromPrivateKey(N){return S(N).point}toRawBytes(){const{x:N,y:$}=this.toAffine(),k=Dd($,r.BYTES);return k[k.length-1]|=N&jt?128:0,k}toHex(){return Gh(this.toRawBytes())}}v.BASE=new v(e.Gx,e.Gy,jt,l(e.Gx*e.Gy)),v.ZERO=new v(Tr,jt,jt,Tr);const{BASE:A,ZERO:E}=v,y=hA(v,a*8);function _(I){return ct(I,n)}function T(I){return _(Mc(I))}function S(I){const N=r.BYTES;I=pn("private key",I,N);const $=pn("hashed private key",i(I),2*N),k=f($.slice(0,N)),D=$.slice(N,2*N),U=T(k),H=A.multiply(U),G=H.toRawBytes();return{head:k,prefix:D,scalar:U,point:H,pointBytes:G}}function x(I){return S(I).pointBytes}function O(I=new Uint8Array,...N){const $=Ap(...N);return T(i(p($,pn("context",I),!!s)))}function L(I,N,$={}){I=pn("message",I),s&&(I=s(I));const{prefix:k,scalar:D,pointBytes:U}=S(N),H=O($.context,k,I),G=A.multiply(H).toRawBytes(),se=O($.context,G,U,I),K=_(H+se*D);ho("signature.s",K,Tr,n);const ie=Ap(G,Dd(K,r.BYTES));return pn("result",ie,r.BYTES*2)}const M=mA;function R(I,N,$,k=M){const{context:D,zip215:U}=k,H=r.BYTES;I=pn("signature",I,2*H),N=pn("message",N),$=pn("publicKey",$,H),U!==void 0&&Sl("zip215",U),s&&(N=s(N));const G=Mc(I.slice(H,2*H));let se,K,ie;try{se=v.fromHex($,U),K=v.fromHex(I.slice(0,H),U),ie=A.multiplyUnsafe(G)}catch{return!1}if(!U&&se.isSmallOrder())return!1;const ge=O(D,K.toRawBytes(),se.toRawBytes(),N);return K.add(se.multiplyUnsafe(ge)).subtract(ie).clearCofactor().equals(v.ZERO)}return A._setWindowSize(8),{CURVE:e,getPublicKey:x,sign:L,verify:R,ExtendedPoint:v,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>o(r.BYTES),precompute(I=8,N=v.BASE){return N._setWindowSize(I),N.multiply(BigInt(3)),N}}}}BigInt(0),BigInt(1);const Zh=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),xp=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const bA=BigInt(1),Op=BigInt(2);BigInt(3);const vA=BigInt(5),EA=BigInt(8);function _A(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=Zh,o=t*t%i*t%i,a=Hr(o,Op,i)*o%i,c=Hr(a,bA,i)*t%i,u=Hr(c,vA,i)*c%i,l=Hr(u,e,i)*u%i,d=Hr(l,r,i)*l%i,h=Hr(d,n,i)*d%i,f=Hr(h,s,i)*h%i,p=Hr(f,s,i)*h%i,g=Hr(p,e,i)*u%i;return{pow_p_5_8:Hr(g,Op,i)*t%i,b2:o}}function CA(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function AA(t,e){const r=Zh,n=ct(e*e*e,r),s=ct(n*n*e,r),i=_A(t*s).pow_p_5_8;let o=ct(t*n*i,r);const a=ct(e*o*o,r),c=o,u=ct(o*xp,r),l=a===t,d=a===ct(-t,r),h=a===ct(-t*xp,r);return l&&(o=c),(d||h)&&(o=u),iA(o,r)&&(o=ct(-o,r)),{isValid:l||d,value:o}}const IA=mw(Zh,void 0,!0),SA={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:IA,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:EA,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:K1,randomBytes:uw,adjustScalarBytes:CA,uvRatio:AA},bw=wA(SA),NA="EdDSA",TA="JWT",Qc=".",Ru="base64url",vw="utf8",Ew="utf8",PA=":",xA="did",OA="key",Rp="base58btc",RA="z",$A="K36",DA=32;function Jh(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function _w(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Jh(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Cw(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const r=_w(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return Jh(r)}function kA(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,w=0,b=p.length;w!==b&&p[w]===0;)w++,g++;for(var v=(b-w)*l+1>>>0,A=new Uint8Array(v);w!==b;){for(var E=p[w],y=0,_=v-1;(E!==0||y<m)&&_!==-1;_--,y++)E+=256*A[_]>>>0,A[_]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");m=y,w++}for(var T=v-m;T!==v&&A[T]===0;)T++;for(var S=c.repeat(g);T<v;++T)S+=t.charAt(A[T]);return S}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,w=0;p[g]===c;)m++,g++;for(var b=(p.length-g)*u+1>>>0,v=new Uint8Array(b);p[g];){var A=r[p.charCodeAt(g)];if(A===255)return;for(var E=0,y=b-1;(A!==0||E<w)&&y!==-1;y--,E++)A+=a*v[y]>>>0,v[y]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");w=E,g++}if(p[g]!==" "){for(var _=b-w;_!==b&&v[_]===0;)_++;for(var T=new Uint8Array(m+(b-_)),S=m;_!==b;)T[S++]=v[_++];return T}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var UA=kA,LA=UA;const Aw=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},MA=t=>new TextEncoder().encode(t),BA=t=>new TextDecoder().decode(t);let FA=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},jA=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Iw(this,e)}},qA=class{constructor(e){this.decoders=e}or(e){return Iw(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Iw=(t,e)=>new qA({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let zA=class{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new FA(e,r,n),this.decoder=new jA(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const $u=({name:t,prefix:e,encode:r,decode:n})=>new zA(t,e,r,n),Ka=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=LA(r,e);return $u({prefix:t,name:e,encode:n,decode:i=>Aw(s(i))})},HA=(t,e,r,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},WA=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},St=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>$u({prefix:e,name:t,encode(s){return WA(s,n,r)},decode(s){return HA(s,n,r,t)}}),VA=$u({prefix:"\0",name:"identity",encode:t=>BA(t),decode:t=>MA(t)});var KA=Object.freeze({__proto__:null,identity:VA});const GA=St({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var YA=Object.freeze({__proto__:null,base2:GA});const ZA=St({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var JA=Object.freeze({__proto__:null,base8:ZA});const XA=Ka({prefix:"9",name:"base10",alphabet:"0123456789"});var QA=Object.freeze({__proto__:null,base10:XA});const eI=St({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),tI=St({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var rI=Object.freeze({__proto__:null,base16:eI,base16upper:tI});const nI=St({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sI=St({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),iI=St({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),oI=St({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),aI=St({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),cI=St({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),uI=St({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lI=St({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),dI=St({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var hI=Object.freeze({__proto__:null,base32:nI,base32upper:sI,base32pad:iI,base32padupper:oI,base32hex:aI,base32hexupper:cI,base32hexpad:uI,base32hexpadupper:lI,base32z:dI});const fI=Ka({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pI=Ka({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var gI=Object.freeze({__proto__:null,base36:fI,base36upper:pI});const mI=Ka({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),yI=Ka({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var wI=Object.freeze({__proto__:null,base58btc:mI,base58flickr:yI});const bI=St({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),vI=St({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),EI=St({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),_I=St({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var CI=Object.freeze({__proto__:null,base64:bI,base64pad:vI,base64url:EI,base64urlpad:_I});const Sw=Array.from(""),AI=Sw.reduce((t,e,r)=>(t[r]=e,t),[]),II=Sw.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function SI(t){return t.reduce((e,r)=>(e+=AI[r],e),"")}function NI(t){const e=[];for(const r of t){const n=II[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const TI=$u({prefix:"",name:"base256emoji",encode:SI,decode:NI});var PI=Object.freeze({__proto__:null,base256emoji:TI}),xI=Nw,$p=128,OI=-128,RI=Math.pow(2,31);function Nw(t,e,r){e=e||[],r=r||0;for(var n=r;t>=RI;)e[r++]=t&255|$p,t/=128;for(;t&OI;)e[r++]=t&255|$p,t>>>=7;return e[r]=t|0,Nw.bytes=r-n+1,e}var $I=Ud,DI=128,Dp=127;function Ud(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Ud.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&Dp)<<s:(o&Dp)*Math.pow(2,s),s+=7}while(o>=DI);return Ud.bytes=i-n,r}var kI=Math.pow(2,7),UI=Math.pow(2,14),LI=Math.pow(2,21),MI=Math.pow(2,28),BI=Math.pow(2,35),FI=Math.pow(2,42),jI=Math.pow(2,49),qI=Math.pow(2,56),zI=Math.pow(2,63),HI=function(t){return t<kI?1:t<UI?2:t<LI?3:t<MI?4:t<BI?5:t<FI?6:t<jI?7:t<qI?8:t<zI?9:10},WI={encode:xI,decode:$I,encodingLength:HI},Tw=WI;const kp=(t,e,r=0)=>(Tw.encode(t,e,r),e),Up=t=>Tw.encodingLength(t),Ld=(t,e)=>{const r=e.byteLength,n=Up(t),s=n+Up(r),i=new Uint8Array(s+r);return kp(t,i,0),kp(r,i,n),i.set(e,s),new VI(t,r,e,i)};let VI=class{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}};const Pw=({name:t,code:e,encode:r})=>new KI(t,e,r);let KI=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Ld(this.code,r):r.then(n=>Ld(this.code,n))}else throw Error("Unknown type, must be binary type")}};const xw=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),GI=Pw({name:"sha2-256",code:18,encode:xw("SHA-256")}),YI=Pw({name:"sha2-512",code:19,encode:xw("SHA-512")});var ZI=Object.freeze({__proto__:null,sha256:GI,sha512:YI});const Ow=0,JI="identity",Rw=Aw,XI=t=>Ld(Ow,Rw(t)),QI={code:Ow,name:JI,encode:Rw,digest:XI};var eS=Object.freeze({__proto__:null,identity:QI});new TextEncoder,new TextDecoder;const Lp={...KA,...YA,...JA,...QA,...rI,...hI,...gI,...wI,...CI,...PI};({...ZI,...eS});function $w(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Mp=$w("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Rl=$w("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=_w(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Dw={utf8:Mp,"utf-8":Mp,hex:Lp.base16,latin1:Rl,ascii:Rl,binary:Rl,...Lp};function Du(t,e="utf8"){const r=Dw[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function Xi(t,e="utf8"){const r=Dw[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Jh(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function Bp(t){return $s(Du(Xi(t,Ru),vw))}function eu(t){return Du(Xi(Pn(t),vw),Ru)}function kw(t){const e=Xi($A,Rp),r=RA+Du(Cw([e,t]),Rp);return[xA,OA,r].join(PA)}function tS(t){return Du(t,Ru)}function rS(t){return Xi(t,Ru)}function nS(t){return Xi([eu(t.header),eu(t.payload)].join(Qc),Ew)}function sS(t){return[eu(t.header),eu(t.payload),tS(t.signature)].join(Qc)}function Md(t){const e=t.split(Qc),r=Bp(e[0]),n=Bp(e[1]),s=rS(e[2]),i=Xi(e.slice(0,2).join(Qc),Ew);return{header:r,payload:n,signature:s,data:i}}function Fp(t=uw(DA)){const e=bw.getPublicKey(t);return{secretKey:Cw([t,e]),publicKey:e}}async function iS(t,e,r,n,s=W.fromMiliseconds(Date.now())){const i={alg:NA,typ:TA},o=kw(n.publicKey),a=s+r,c={iss:o,sub:t,aud:e,iat:s,exp:a},u=nS({header:i,payload:c}),l=bw.sign(u,n.secretKey.slice(0,32));return sS({header:i,payload:c,signature:l})}var jp=function(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))},oS=function(){function t(e,r,n){this.name=e,this.version=r,this.os=n,this.type="browser"}return t}(),aS=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),cS=function(){function t(e,r,n,s){this.name=e,this.version=r,this.os=n,this.bot=s,this.type="bot-device"}return t}(),uS=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),lS=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),dS=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,hS=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,qp=3,fS=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",dS]],zp=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function pS(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new lS:typeof navigator<"u"?mS(navigator.userAgent):wS()}function gS(t){return t!==""&&fS.reduce(function(e,r){var n=r[0],s=r[1];if(e)return e;var i=s.exec(t);return!!i&&[n,i]},!1)}function mS(t){var e=gS(t);if(!e)return null;var r=e[0],n=e[1];if(r==="searchbot")return new uS;var s=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);s?s.length<qp&&(s=jp(jp([],s,!0),bS(qp-s.length),!0)):s=[];var i=s.join("."),o=yS(t),a=hS.exec(t);return a&&a[1]?new cS(r,i,o,a[1]):new oS(r,i,o)}function yS(t){for(var e=0,r=zp.length;e<r;e++){var n=zp[e],s=n[0],i=n[1],o=i.exec(t);if(o)return s}return null}function wS(){var t=typeof process<"u"&&process.version;return t?new aS(process.version.slice(1)):null}function bS(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Be={},Hp;function Uw(){if(Hp)return Be;Hp=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.getLocalStorage=Be.getLocalStorageOrThrow=Be.getCrypto=Be.getCryptoOrThrow=Be.getLocation=Be.getLocationOrThrow=Be.getNavigator=Be.getNavigatorOrThrow=Be.getDocument=Be.getDocumentOrThrow=Be.getFromWindowOrThrow=Be.getFromWindow=void 0;function t(h){let f;return typeof window<"u"&&typeof window[h]<"u"&&(f=window[h]),f}Be.getFromWindow=t;function e(h){const f=t(h);if(!f)throw new Error(`${h} is not defined in Window`);return f}Be.getFromWindowOrThrow=e;function r(){return e("document")}Be.getDocumentOrThrow=r;function n(){return t("document")}Be.getDocument=n;function s(){return e("navigator")}Be.getNavigatorOrThrow=s;function i(){return t("navigator")}Be.getNavigator=i;function o(){return e("location")}Be.getLocationOrThrow=o;function a(){return t("location")}Be.getLocation=a;function c(){return e("crypto")}Be.getCryptoOrThrow=c;function u(){return t("crypto")}Be.getCrypto=u;function l(){return e("localStorage")}Be.getLocalStorageOrThrow=l;function d(){return t("localStorage")}return Be.getLocalStorage=d,Be}var Ds=Uw(),fo={},Wp;function vS(){if(Wp)return fo;Wp=1,Object.defineProperty(fo,"__esModule",{value:!0}),fo.getWindowMetadata=void 0;const t=Uw();function e(){let r,n;try{r=t.getDocumentOrThrow(),n=t.getLocationOrThrow()}catch{return null}function s(){const f=r.getElementsByTagName("link"),p=[];for(let g=0;g<f.length;g++){const m=f[g],w=m.getAttribute("rel");if(w&&w.toLowerCase().indexOf("icon")>-1){const b=m.getAttribute("href");if(b)if(b.toLowerCase().indexOf("https:")===-1&&b.toLowerCase().indexOf("http:")===-1&&b.indexOf("//")!==0){let v=n.protocol+"//"+n.host;if(b.indexOf("/")===0)v+=b;else{const A=n.pathname.split("/");A.pop();const E=A.join("/");v+=E+"/"+b}p.push(v)}else if(b.indexOf("//")===0){const v=n.protocol+b;p.push(v)}else p.push(b)}}return p}function i(...f){const p=r.getElementsByTagName("meta");for(let g=0;g<p.length;g++){const m=p[g],w=["itemprop","property","name"].map(b=>m.getAttribute(b)).filter(b=>b?f.includes(b):!1);if(w.length&&w){const b=m.getAttribute("content");if(b)return b}}return""}function o(){let f=i("name","og:site_name","og:title","twitter:title");return f||(f=r.title),f}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),u=a(),l=n.origin,d=s();return{description:u,url:l,icons:d,name:c}}return fo.getWindowMetadata=e,fo}var ES=vS();const _S="1.0.8";let Ir=class Bd extends Error{constructor(e,r={}){var o;const n=r.cause instanceof Bd?r.cause.details:(o=r.cause)!=null&&o.message?r.cause.message:r.details,s=r.cause instanceof Bd&&r.cause.docsPath||r.docsPath,i=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...n?[`Details: ${n}`]:[],`Version: abitype@${_S}`].join(`
`);super(i),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),r.cause&&(this.cause=r.cause),this.details=n,this.docsPath=s,this.metaMessages=r.metaMessages,this.shortMessage=e}};function On(t,e){const r=t.exec(e);return r==null?void 0:r.groups}const Lw=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Mw=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,Bw=/^\(.+?\).*?$/,Vp=/^tuple(?<array>(\[(\d*)\])*)$/;function Fd(t){let e=t.type;if(Vp.test(t.type)&&"components"in t){e="(";const r=t.components.length;for(let s=0;s<r;s++){const i=t.components[s];e+=Fd(i),s<r-1&&(e+=", ")}const n=On(Vp,t.type);return e+=`)${(n==null?void 0:n.array)??""}`,Fd({...t,type:e})}return"indexed"in t&&t.indexed&&(e=`${e} indexed`),t.name?`${e} ${t.name}`:e}function po(t){let e="";const r=t.length;for(let n=0;n<r;n++){const s=t[n];e+=Fd(s),n!==r-1&&(e+=", ")}return e}function CS(t){var e;return t.type==="function"?`function ${t.name}(${po(t.inputs)})${t.stateMutability&&t.stateMutability!=="nonpayable"?` ${t.stateMutability}`:""}${(e=t.outputs)!=null&&e.length?` returns (${po(t.outputs)})`:""}`:t.type==="event"?`event ${t.name}(${po(t.inputs)})`:t.type==="error"?`error ${t.name}(${po(t.inputs)})`:t.type==="constructor"?`constructor(${po(t.inputs)})${t.stateMutability==="payable"?" payable":""}`:t.type==="fallback"?`fallback() external${t.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const Fw=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function AS(t){return Fw.test(t)}function IS(t){return On(Fw,t)}const jw=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function SS(t){return jw.test(t)}function NS(t){return On(jw,t)}const qw=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function TS(t){return qw.test(t)}function PS(t){return On(qw,t)}const zw=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function Hw(t){return zw.test(t)}function xS(t){return On(zw,t)}const Ww=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function OS(t){return Ww.test(t)}function RS(t){return On(Ww,t)}const Vw=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function $S(t){return Vw.test(t)}function DS(t){return On(Vw,t)}const kS=/^receive\(\) external payable$/;function US(t){return kS.test(t)}const LS=new Set(["indexed"]),jd=new Set(["calldata","memory","storage"]);class MS extends Ir{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class BS extends Ir{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class FS extends Ir{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class jS extends Ir{constructor({param:e,name:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${r}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class qS extends Ir{constructor({param:e,type:r,modifier:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${n}" not allowed${r?` in "${r}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class zS extends Ir{constructor({param:e,type:r,modifier:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${n}" not allowed${r?` in "${r}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${n}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class HS extends Ir{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class Qi extends Ir{constructor({signature:e,type:r}){super(`Invalid ${r} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class WS extends Ir{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class VS extends Ir{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class KS extends Ir{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class GS extends Ir{constructor({current:e,depth:r}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${r>0?"opening":"closing"} parentheses.`],details:`Depth "${r}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function YS(t,e,r){let n="";if(r)for(const s of Object.entries(r)){if(!s)continue;let i="";for(const o of s[1])i+=`[${o.type}${o.name?`:${o.name}`:""}]`;n+=`(${s[0]}{${i}})`}return e?`${e}:${t}${n}`:t}const $l=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function ZS(t,e={}){if(TS(t))return JS(t,e);if(SS(t))return XS(t,e);if(AS(t))return QS(t,e);if(OS(t))return eN(t,e);if($S(t))return tN(t);if(US(t))return{type:"receive",stateMutability:"payable"};throw new WS({signature:t})}function JS(t,e={}){const r=PS(t);if(!r)throw new Qi({signature:t,type:"function"});const n=Dr(r.parameters),s=[],i=n.length;for(let a=0;a<i;a++)s.push(ks(n[a],{modifiers:jd,structs:e,type:"function"}));const o=[];if(r.returns){const a=Dr(r.returns),c=a.length;for(let u=0;u<c;u++)o.push(ks(a[u],{modifiers:jd,structs:e,type:"function"}))}return{name:r.name,type:"function",stateMutability:r.stateMutability??"nonpayable",inputs:s,outputs:o}}function XS(t,e={}){const r=NS(t);if(!r)throw new Qi({signature:t,type:"event"});const n=Dr(r.parameters),s=[],i=n.length;for(let o=0;o<i;o++)s.push(ks(n[o],{modifiers:LS,structs:e,type:"event"}));return{name:r.name,type:"event",inputs:s}}function QS(t,e={}){const r=IS(t);if(!r)throw new Qi({signature:t,type:"error"});const n=Dr(r.parameters),s=[],i=n.length;for(let o=0;o<i;o++)s.push(ks(n[o],{structs:e,type:"error"}));return{name:r.name,type:"error",inputs:s}}function eN(t,e={}){const r=RS(t);if(!r)throw new Qi({signature:t,type:"constructor"});const n=Dr(r.parameters),s=[],i=n.length;for(let o=0;o<i;o++)s.push(ks(n[o],{structs:e,type:"constructor"}));return{type:"constructor",stateMutability:r.stateMutability??"nonpayable",inputs:s}}function tN(t){const e=DS(t);if(!e)throw new Qi({signature:t,type:"fallback"});return{type:"fallback",stateMutability:e.stateMutability??"nonpayable"}}const rN=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,nN=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,sN=/^u?int$/;function ks(t,e){var d,h;const r=YS(t,e==null?void 0:e.type,e==null?void 0:e.structs);if($l.has(r))return $l.get(r);const n=Bw.test(t),s=On(n?nN:rN,t);if(!s)throw new FS({param:t});if(s.name&&oN(s.name))throw new jS({param:t,name:s.name});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=(e==null?void 0:e.structs)??{};let c,u={};if(n){c="tuple";const f=Dr(s.type),p=[],g=f.length;for(let m=0;m<g;m++)p.push(ks(f[m],{structs:a}));u={components:p}}else if(s.type in a)c="tuple",u={components:a[s.type]};else if(sN.test(s.type))c=`${s.type}256`;else if(c=s.type,(e==null?void 0:e.type)!=="struct"&&!Kw(c))throw new BS({type:c});if(s.modifier){if(!((h=(d=e==null?void 0:e.modifiers)==null?void 0:d.has)!=null&&h.call(d,s.modifier)))throw new qS({param:t,type:e==null?void 0:e.type,modifier:s.modifier});if(jd.has(s.modifier)&&!aN(c,!!s.array))throw new zS({param:t,type:e==null?void 0:e.type,modifier:s.modifier})}const l={type:`${c}${s.array??""}`,...i,...o,...u};return $l.set(r,l),l}function Dr(t,e=[],r="",n=0){const s=t.trim().length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return n===0?Dr(a,[...e,r.trim()]):Dr(a,e,`${r}${o}`,n);case"(":return Dr(a,e,`${r}${o}`,n+1);case")":return Dr(a,e,`${r}${o}`,n-1);default:return Dr(a,e,`${r}${o}`,n)}}if(r==="")return e;if(n!==0)throw new GS({current:r,depth:n});return e.push(r.trim()),e}function Kw(t){return t==="address"||t==="bool"||t==="function"||t==="string"||Lw.test(t)||Mw.test(t)}const iN=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function oN(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||Lw.test(t)||Mw.test(t)||iN.test(t)}function aN(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function cN(t){const e={},r=t.length;for(let o=0;o<r;o++){const a=t[o];if(!Hw(a))continue;const c=xS(a);if(!c)throw new Qi({signature:a,type:"struct"});const u=c.properties.split(";"),l=[],d=u.length;for(let h=0;h<d;h++){const p=u[h].trim();if(!p)continue;const g=ks(p,{type:"struct"});l.push(g)}if(!l.length)throw new VS({signature:a});e[c.name]=l}const n={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];n[a]=Gw(c,e)}return n}const uN=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function Gw(t,e,r=new Set){const n=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(Bw.test(o.type))n.push(o);else{const c=On(uN,o.type);if(!(c!=null&&c.type))throw new HS({abiParameter:o});const{array:u,type:l}=c;if(l in e){if(r.has(l))throw new KS({type:l});n.push({...o,type:`tuple${u??""}`,components:Gw(e[l]??[],e,new Set([...r,l]))})}else if(Kw(l))n.push(o);else throw new MS({type:l})}}return n}function Yw(t){const e=cN(t),r=[],n=t.length;for(let s=0;s<n;s++){const i=t[s];Hw(i)||r.push(ZS(i,e))}return r}function Jo(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Kp(t){return Jo(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const Zw="2.23.2";let go={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:r})=>e?`${t??"https://viem.sh"}${e}${r?`#${r}`:""}`:void 0,version:`viem@${Zw}`},ku=class qd extends Error{constructor(e,r={}){var a;const n=(()=>{var c;return r.cause instanceof qd?r.cause.details:(c=r.cause)!=null&&c.message?r.cause.message:r.details})(),s=r.cause instanceof qd&&r.cause.docsPath||r.docsPath,i=(a=go.getDocsUrl)==null?void 0:a.call(go,{...r,docsPath:s}),o=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...go.version?[`Version: ${go.version}`]:[]].join(`
`);super(o,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=e,this.version=Zw}walk(e){return Jw(this,e)}};function Jw(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?Jw(t.cause,e):e?null:t}let Xw=class extends ku{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}};function eo(t,{dir:e,size:r=32}={}){return typeof t=="string"?lN(t,{dir:e,size:r}):dN(t,{dir:e,size:r})}function lN(t,{dir:e,size:r=32}={}){if(r===null)return t;const n=t.replace("0x","");if(n.length>r*2)throw new Xw({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](r*2,"0")}`}function dN(t,{dir:e,size:r=32}={}){if(r===null)return t;if(t.length>r)throw new Xw({size:t.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let s=0;s<r;s++){const i=e==="right";n[i?s:r-s-1]=t[i?s:t.length-s-1]}return n}let hN=class extends ku{constructor({max:e,min:r,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${r} to ${e})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}},fN=class extends ku{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function to(t,{size:e}){if(Kp(t)>e)throw new fN({givenSize:Kp(t),maxSize:e})}function zd(t,e={}){const{signed:r}=e;e.size&&to(t,{size:e.size});const n=BigInt(t);if(!r)return n;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function pN(t,e={}){return Number(zd(t,e))}const gN=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Hd(t,e={}){return typeof t=="number"||typeof t=="bigint"?eb(t,e):typeof t=="string"?wN(t,e):typeof t=="boolean"?mN(t,e):Qw(t,e)}function mN(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(to(r,{size:e.size}),eo(r,{size:e.size})):r}function Qw(t,e={}){let r="";for(let s=0;s<t.length;s++)r+=gN[t[s]];const n=`0x${r}`;return typeof e.size=="number"?(to(n,{size:e.size}),eo(n,{dir:"right",size:e.size})):n}function eb(t,e={}){const{signed:r,size:n}=e,s=BigInt(t);let i;n?r?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&r?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new hN({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:r,size:n,value:`${t}${c}`})}const a=`0x${(r&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?eo(a,{size:n}):a}const yN=new TextEncoder;function wN(t,e={}){const r=yN.encode(t);return Qw(r,e)}const bN=new TextEncoder;function vN(t,e={}){return typeof t=="number"||typeof t=="bigint"?_N(t,e):typeof t=="boolean"?EN(t,e):Jo(t)?tb(t,e):rb(t,e)}function EN(t,e={}){const r=new Uint8Array(1);return r[0]=Number(t),typeof e.size=="number"?(to(r,{size:e.size}),eo(r,{size:e.size})):r}const gn={zero:48,nine:57,A:65,F:70,a:97,f:102};function Gp(t){if(t>=gn.zero&&t<=gn.nine)return t-gn.zero;if(t>=gn.A&&t<=gn.F)return t-(gn.A-10);if(t>=gn.a&&t<=gn.f)return t-(gn.a-10)}function tb(t,e={}){let r=t;e.size&&(to(r,{size:e.size}),r=eo(r,{dir:"right",size:e.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Gp(n.charCodeAt(a++)),u=Gp(n.charCodeAt(a++));if(c===void 0||u===void 0)throw new ku(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+u}return i}function _N(t,e){const r=eb(t,e);return tb(r)}function rb(t,e={}){const r=bN.encode(t);return typeof e.size=="number"?(to(r,{size:e.size}),eo(r,{dir:"right",size:e.size})):r}function tu(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function CN(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Uu(t,...e){if(!CN(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function oj(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");tu(t.outputLen),tu(t.blockLen)}function Yp(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function AN(t,e){Uu(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const mc=BigInt(2**32-1),Zp=BigInt(32);function IN(t,e=!1){return e?{h:Number(t&mc),l:Number(t>>Zp&mc)}:{h:Number(t>>Zp&mc)|0,l:Number(t&mc)|0}}function SN(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=IN(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const NN=(t,e,r)=>t<<r|e>>>32-r,TN=(t,e,r)=>e<<r|t>>>32-r,PN=(t,e,r)=>e<<r-32|t>>>64-r,xN=(t,e,r)=>t<<r-32|e>>>64-r,ni=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ON(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function aj(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function cj(t,e){return t<<32-e|t>>>e}const Jp=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function RN(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Xp(t){for(let e=0;e<t.length;e++)t[e]=RN(t[e])}function $N(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function nb(t){return typeof t=="string"&&(t=$N(t)),Uu(t),t}function uj(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Uu(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}let DN=class{clone(){return this._cloneInto()}};function kN(t){const e=n=>t().update(nb(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function dj(t=32){if(ni&&typeof ni.getRandomValues=="function")return ni.getRandomValues(new Uint8Array(t));if(ni&&typeof ni.randomBytes=="function")return ni.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const sb=[],ib=[],ob=[],UN=BigInt(0),mo=BigInt(1),LN=BigInt(2),MN=BigInt(7),BN=BigInt(256),FN=BigInt(113);for(let t=0,e=mo,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],sb.push(2*(5*n+r)),ib.push((t+1)*(t+2)/2%64);let s=UN;for(let i=0;i<7;i++)e=(e<<mo^(e>>MN)*FN)%BN,e&LN&&(s^=mo<<(mo<<BigInt(i))-mo);ob.push(s)}const[jN,qN]=SN(ob,!0),Qp=(t,e,r)=>r>32?PN(t,e,r):NN(t,e,r),eg=(t,e,r)=>r>32?xN(t,e,r):TN(t,e,r);function zN(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],l=r[c+1],d=Qp(u,l,1)^r[a],h=eg(u,l,1)^r[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=ib[o],c=Qp(s,i,a),u=eg(s,i,a),l=sb[o];s=t[l],i=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=jN[n],t[1]^=qN[n]}r.fill(0)}let HN=class ab extends DN{constructor(e,r,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,tu(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ON(this.state)}keccak(){Jp||Xp(this.state32),zN(this.state32,this.rounds),Jp||Xp(this.state32),this.posOut=0,this.pos=0}update(e){Yp(this);const{blockLen:r,state:n}=this;e=nb(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Yp(this,!1),Uu(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return tu(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(AN(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new ab(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const WN=(t,e,r)=>kN(()=>new HN(e,t,r)),VN=WN(1,136,256/8);function cb(t,e){const r=e||"hex",n=VN(Jo(t,{strict:!1})?vN(t):t);return r==="bytes"?n:Hd(n)}let KN=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}};const Dl=new KN(8192);function GN(t,e){if(Dl.has(`${t}.${e}`))return Dl.get(`${t}.${e}`);const r=t.substring(2).toLowerCase(),n=cb(rb(r),"bytes"),s=r.split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Dl.set(`${t}.${e}`,i),i}function YN(t){const e=cb(`0x${t.substring(4)}`).substring(26);return GN(`0x${e}`)}async function ZN({hash:t,signature:e}){const r=Jo(t)?t:Hd(t),{secp256k1:n}=await Ut(async()=>{const{secp256k1:o}=await import("./BopAASPx.js");return{secp256k1:o}},[],import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:l,v:d,yParity:h}=e,f=Number(h??d),p=tg(f);return new n.Signature(zd(u),zd(l)).addRecoveryBit(p)}const o=Jo(e)?e:Hd(e),a=pN(`0x${o.slice(130)}`),c=tg(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(r.substring(2)).toHex(!1)}`}function tg(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function JN({hash:t,signature:e}){return YN(await ZN({hash:t,signature:e}))}const si=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function XN(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ru(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Us(t,...e){if(!XN(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function fj(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ru(t.outputLen),ru(t.blockLen)}function nu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ub(t,e){Us(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function QN(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Xo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function kl(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Wr(t,e){return t<<32-e|t>>>e}const eT=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function tT(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function rT(t){for(let e=0;e<t.length;e++)t[e]=tT(t[e]);return t}const rg=eT?t=>t:rT,nT=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",sT=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function pj(t){if(Us(t),nT)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=sT[t[r]];return e}function iT(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Xh(t){return typeof t=="string"&&(t=iT(t)),Us(t),t}function gj(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Us(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}class lb{}function db(t){const e=n=>t().update(Xh(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function mj(t=32){if(si&&typeof si.getRandomValues=="function")return si.getRandomValues(new Uint8Array(t));if(si&&typeof si.randomBytes=="function")return Uint8Array.from(si.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}function oT(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}function aT(t,e,r){return t&e^~t&r}function cT(t,e,r){return t&e^t&r^e&r}class uT extends lb{constructor(e,r,n,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.buffer=new Uint8Array(e),this.view=kl(this.buffer)}update(e){nu(this),e=Xh(e),Us(e);const{view:r,buffer:n,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=kl(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){nu(this),ub(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,Xo(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;oT(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=kl(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%r&&e.buffer.set(n),e}clone(){return this._cloneInto()}}const Ln=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),yc=BigInt(2**32-1),ng=BigInt(32);function lT(t,e=!1){return e?{h:Number(t&yc),l:Number(t>>ng&yc)}:{h:Number(t>>ng&yc)|0,l:Number(t&yc)|0}}function dT(t,e=!1){const r=t.length;let n=new Uint32Array(r),s=new Uint32Array(r);for(let i=0;i<r;i++){const{h:o,l:a}=lT(t[i],e);[n[i],s[i]]=[o,a]}return[n,s]}const hT=(t,e,r)=>t<<r|e>>>32-r,fT=(t,e,r)=>e<<r|t>>>32-r,pT=(t,e,r)=>e<<r-32|t>>>64-r,gT=(t,e,r)=>t<<r-32|e>>>64-r,mT=BigInt(0),yo=BigInt(1),yT=BigInt(2),wT=BigInt(7),bT=BigInt(256),vT=BigInt(113),hb=[],fb=[],pb=[];for(let t=0,e=yo,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],hb.push(2*(5*n+r)),fb.push((t+1)*(t+2)/2%64);let s=mT;for(let i=0;i<7;i++)e=(e<<yo^(e>>wT)*vT)%bT,e&yT&&(s^=yo<<(yo<<BigInt(i))-yo);pb.push(s)}const gb=dT(pb,!0),ET=gb[0],_T=gb[1],sg=(t,e,r)=>r>32?pT(t,e,r):hT(t,e,r),ig=(t,e,r)=>r>32?gT(t,e,r):fT(t,e,r);function CT(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],l=r[c+1],d=sg(u,l,1)^r[a],h=ig(u,l,1)^r[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=fb[o],c=sg(s,i,a),u=ig(s,i,a),l=hb[o];s=t[l],i=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=ET[n],t[1]^=_T[n]}Xo(r)}class Qh extends lb{constructor(e,r,n,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,ru(n),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=QN(this.state)}clone(){return this._cloneInto()}keccak(){rg(this.state32),CT(this.state32,this.rounds),rg(this.state32),this.posOut=0,this.pos=0}update(e){nu(this),e=Xh(e),Us(e);const{blockLen:r,state:n}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){nu(this,!1),Us(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ru(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ub(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Xo(this.state)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Qh(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const AT=(t,e,r)=>db(()=>new Qh(e,t,r)),IT=AT(1,136,256/8),ST=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Mn=new Uint32Array(64);class NT extends uT{constructor(e=32){super(64,e,8,!1),this.A=Ln[0]|0,this.B=Ln[1]|0,this.C=Ln[2]|0,this.D=Ln[3]|0,this.E=Ln[4]|0,this.F=Ln[5]|0,this.G=Ln[6]|0,this.H=Ln[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)Mn[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Mn[d-15],f=Mn[d-2],p=Wr(h,7)^Wr(h,18)^h>>>3,g=Wr(f,17)^Wr(f,19)^f>>>10;Mn[d]=g+Mn[d-7]+p+Mn[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=Wr(a,6)^Wr(a,11)^Wr(a,25),f=l+h+aT(a,c,u)+ST[d]+Mn[d]|0,g=(Wr(n,2)^Wr(n,13)^Wr(n,22))+cT(n,s,i)|0;l=u,u=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+g|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,s,i,o,a,c,u,l)}roundClean(){Xo(Mn)}destroy(){this.set(0,0,0,0,0,0,0,0),Xo(this.buffer)}}const TT=db(()=>new NT),PT=TT;function xT(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let u=0;u<e.length;u++)e[u]=255;for(let u=0;u<t.length;u++){const l=t.charAt(u),d=l.charCodeAt(0);if(e[d]!==255)throw new TypeError(l+" is ambiguous");e[d]=u}const r=t.length,n=t.charAt(0),s=Math.log(r)/Math.log(256),i=Math.log(256)/Math.log(r);function o(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";let l=0,d=0,h=0;const f=u.length;for(;h!==f&&u[h]===0;)h++,l++;const p=(f-h)*i+1>>>0,g=new Uint8Array(p);for(;h!==f;){let b=u[h],v=0;for(let A=p-1;(b!==0||v<d)&&A!==-1;A--,v++)b+=256*g[A]>>>0,g[A]=b%r>>>0,b=b/r>>>0;if(b!==0)throw new Error("Non-zero carry");d=v,h++}let m=p-d;for(;m!==p&&g[m]===0;)m++;let w=n.repeat(l);for(;m<p;++m)w+=t.charAt(g[m]);return w}function a(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;let l=0,d=0,h=0;for(;u[l]===n;)d++,l++;const f=(u.length-l)*s+1>>>0,p=new Uint8Array(f);for(;l<u.length;){const b=u.charCodeAt(l);if(b>255)return;let v=e[b];if(v===255)return;let A=0;for(let E=f-1;(v!==0||A<h)&&E!==-1;E--,A++)v+=r*p[E]>>>0,p[E]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");h=A,l++}let g=f-h;for(;g!==f&&p[g]===0;)g++;const m=new Uint8Array(d+(f-g));let w=d;for(;g!==f;)m[w++]=p[g++];return m}function c(u){const l=a(u);if(l)return l;throw new Error("Non-base"+r+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var OT="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const mb=xT(OT);function yb(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function ko(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const r=yb(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return r}function RT(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,w=0,b=p.length;w!==b&&p[w]===0;)w++,g++;for(var v=(b-w)*l+1>>>0,A=new Uint8Array(v);w!==b;){for(var E=p[w],y=0,_=v-1;(E!==0||y<m)&&_!==-1;_--,y++)E+=256*A[_]>>>0,A[_]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");m=y,w++}for(var T=v-m;T!==v&&A[T]===0;)T++;for(var S=c.repeat(g);T<v;++T)S+=t.charAt(A[T]);return S}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,w=0;p[g]===c;)m++,g++;for(var b=(p.length-g)*u+1>>>0,v=new Uint8Array(b);p[g];){var A=r[p.charCodeAt(g)];if(A===255)return;for(var E=0,y=b-1;(A!==0||E<w)&&y!==-1;y--,E++)A+=a*v[y]>>>0,v[y]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");w=E,g++}if(p[g]!==" "){for(var _=b-w;_!==b&&v[_]===0;)_++;for(var T=new Uint8Array(m+(b-_)),S=m;_!==b;)T[S++]=v[_++];return T}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var $T=RT,DT=$T;const kT=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},UT=t=>new TextEncoder().encode(t),LT=t=>new TextDecoder().decode(t);class MT{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class BT{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return wb(this,e)}}class FT{constructor(e){this.decoders=e}or(e){return wb(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const wb=(t,e)=>new FT({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class jT{constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new MT(e,r,n),this.decoder=new BT(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Lu=({name:t,prefix:e,encode:r,decode:n})=>new jT(t,e,r,n),Ga=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=DT(r,e);return Lu({prefix:t,name:e,encode:n,decode:i=>kT(s(i))})},qT=(t,e,r,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},zT=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Nt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Lu({prefix:e,name:t,encode(s){return zT(s,n,r)},decode(s){return qT(s,n,r,t)}}),HT=Lu({prefix:"\0",name:"identity",encode:t=>LT(t),decode:t=>UT(t)}),WT=Object.freeze(Object.defineProperty({__proto__:null,identity:HT},Symbol.toStringTag,{value:"Module"})),VT=Nt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),KT=Object.freeze(Object.defineProperty({__proto__:null,base2:VT},Symbol.toStringTag,{value:"Module"})),GT=Nt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),YT=Object.freeze(Object.defineProperty({__proto__:null,base8:GT},Symbol.toStringTag,{value:"Module"})),ZT=Ga({prefix:"9",name:"base10",alphabet:"0123456789"}),JT=Object.freeze(Object.defineProperty({__proto__:null,base10:ZT},Symbol.toStringTag,{value:"Module"})),XT=Nt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),QT=Nt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),eP=Object.freeze(Object.defineProperty({__proto__:null,base16:XT,base16upper:QT},Symbol.toStringTag,{value:"Module"})),tP=Nt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),rP=Nt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),nP=Nt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sP=Nt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),iP=Nt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),oP=Nt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),aP=Nt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),cP=Nt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),uP=Nt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),lP=Object.freeze(Object.defineProperty({__proto__:null,base32:tP,base32hex:iP,base32hexpad:aP,base32hexpadupper:cP,base32hexupper:oP,base32pad:nP,base32padupper:sP,base32upper:rP,base32z:uP},Symbol.toStringTag,{value:"Module"})),dP=Ga({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hP=Ga({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),fP=Object.freeze(Object.defineProperty({__proto__:null,base36:dP,base36upper:hP},Symbol.toStringTag,{value:"Module"})),pP=Ga({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),gP=Ga({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),mP=Object.freeze(Object.defineProperty({__proto__:null,base58btc:pP,base58flickr:gP},Symbol.toStringTag,{value:"Module"})),yP=Nt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),wP=Nt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),bP=Nt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vP=Nt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),EP=Object.freeze(Object.defineProperty({__proto__:null,base64:yP,base64pad:wP,base64url:bP,base64urlpad:vP},Symbol.toStringTag,{value:"Module"})),bb=Array.from(""),_P=bb.reduce((t,e,r)=>(t[r]=e,t),[]),CP=bb.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function AP(t){return t.reduce((e,r)=>(e+=_P[r],e),"")}function IP(t){const e=[];for(const r of t){const n=CP[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const SP=Lu({prefix:"",name:"base256emoji",encode:AP,decode:IP}),NP=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:SP},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const og={...WT,...KT,...YT,...JT,...eP,...lP,...fP,...mP,...EP,...NP};function vb(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const ag=vb("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ul=vb("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=yb(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Eb={utf8:ag,"utf-8":ag,hex:og.base16,latin1:Ul,ascii:Ul,binary:Ul,...og};function vr(t,e="utf8"){const r=Eb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Zt(t,e="utf8"){const r=Eb[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}const TP={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var PP={};const xP=":";function Ni(t){const[e,r]=t.split(xP);return{namespace:e,reference:r}}function _b(t,e){return t.includes(":")?[t]:e.chains||[]}var OP=Object.defineProperty,RP=Object.defineProperties,$P=Object.getOwnPropertyDescriptors,cg=Object.getOwnPropertySymbols,DP=Object.prototype.hasOwnProperty,kP=Object.prototype.propertyIsEnumerable,ug=(t,e,r)=>e in t?OP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,lg=(t,e)=>{for(var r in e||(e={}))DP.call(e,r)&&ug(t,r,e[r]);if(cg)for(var r of cg(e))kP.call(e,r)&&ug(t,r,e[r]);return t},UP=(t,e)=>RP(t,$P(e));const LP="ReactNative",cr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},MP="js";function su(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function cs(){return!Ds.getDocument()&&!!Ds.getNavigator()&&navigator.product===LP}function BP(){return cs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function FP(){return cs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Ya(){return!su()&&!!Ds.getNavigator()&&!!Ds.getDocument()}function Za(){return cs()?cr.reactNative:su()?cr.node:Ya()?cr.browser:cr.unknown}function dg(){var t;try{return cs()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function jP(t,e){const r=new URLSearchParams(t);for(const n of Object.keys(e).sort())if(e.hasOwnProperty(n)){const s=e[n];s!==void 0&&r.set(n,s)}return r.toString()}function qP(t){var e,r;const n=Cb();try{return t!=null&&t.url&&n.url&&t.url!==n.url&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${n.url}. This is probably unintended and can lead to issues.`),t.url=n.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),UP(lg(lg({},n),t),{url:(t==null?void 0:t.url)||n.url,name:(t==null?void 0:t.name)||n.name,description:(t==null?void 0:t.description)||n.description,icons:(r=t==null?void 0:t.icons)!=null&&r.length&&t.icons.length>0?t.icons:n.icons})}catch(s){return console.warn("Error populating app metadata",s),t||n}}function Cb(){return ES.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function zP(){if(Za()===cr.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const t=pS();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function HP(){var t;const e=Za();return e===cr.browser?[e,((t=Ds.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function Ab(t,e,r){const n=zP(),s=HP();return[[t,e].join("-"),[MP,r].join("-"),n,s].join("/")}function WP({protocol:t,version:e,relayUrl:r,sdkVersion:n,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=r.split("?"),l=Ab(t,e,n),d={auth:s,ua:l,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=jP(u[1]||"",d);return u[0]+"?"+h}function _s(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Wd(t){return Object.fromEntries(t.entries())}function Vd(t){return new Map(Object.entries(t))}function ms(t=W.FIVE_MINUTES,e){const r=W.toMiliseconds(t||W.FIVE_MINUTES);let n,s,i,o;return{resolve:a=>{i&&n&&(clearTimeout(i),n(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},r),n=a,s=c})}}function Kn(t,e,r){return new Promise(async(n,s)=>{const i=setTimeout(()=>s(new Error(r)),e);try{const o=await t;n(o)}catch(o){s(o)}clearTimeout(i)})}function Ib(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function VP(t){return Ib("topic",t)}function KP(t){return Ib("id",t)}function Sb(t){const[e,r]=t.split(":"),n={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")n.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return n}function ot(t,e){return W.fromMiliseconds(Date.now()+W.toMiliseconds(t))}function qn(t){return Date.now()>=W.toMiliseconds(t)}function $e(t,e){return`${t}${e?`:${e}`:""}`}function Bc(t=[],e=[]){return[...new Set([...t,...e])]}async function GP({id:t,topic:e,wcDeepLink:r}){var n;try{if(!r)return;const s=typeof r=="string"?JSON.parse(r):r,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=YP(i,t,e),a=Za();if(a===cr.browser){if(!((n=Ds.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}ZP(o)}else a===cr.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function YP(t,e,r){const n=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${ex(n,!0)}`}else s=`${s}/wc?${n}`;return s}function ZP(t){let e="_self";QP()?e="_top":(XP()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function JP(t,e){let r="";try{if(Ya()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(n){console.error(n)}return r}function hg(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),n=r.indexOf(e);return r[n+2]}function fg(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function ef(){return typeof process<"u"&&PP.IS_VITEST==="true"}function XP(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function QP(){try{return window.self!==window.top}catch{return!1}}function ex(t,e=!1){const r=Buffer.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function Nb(t){return Buffer.from(t,"base64").toString("utf-8")}function tx(t){return new Promise(e=>setTimeout(e,t))}function Qo(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function rx(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ja(t,...e){if(!rx(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function tf(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Qo(t.outputLen),Qo(t.blockLen)}function Ri(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Tb(t,e){Ja(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const wc=BigInt(2**32-1),pg=BigInt(32);function nx(t,e=!1){return e?{h:Number(t&wc),l:Number(t>>pg&wc)}:{h:Number(t>>pg&wc)|0,l:Number(t&wc)|0}}function sx(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=nx(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const ix=(t,e,r)=>t<<r|e>>>32-r,ox=(t,e,r)=>e<<r|t>>>32-r,ax=(t,e,r)=>e<<r-32|t>>>64-r,cx=(t,e,r)=>t<<r-32|e>>>64-r,ii=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function ux(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ll(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Vr(t,e){return t<<32-e|t>>>e}const gg=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function lx(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function mg(t){for(let e=0;e<t.length;e++)t[e]=lx(t[e])}function dx(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function $i(t){return typeof t=="string"&&(t=dx(t)),Ja(t),t}function hx(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Ja(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}let rf=class{clone(){return this._cloneInto()}};function Pb(t){const e=n=>t().update($i(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ro(t=32){if(ii&&typeof ii.getRandomValues=="function")return ii.getRandomValues(new Uint8Array(t));if(ii&&typeof ii.randomBytes=="function")return ii.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const xb=[],Ob=[],Rb=[],fx=BigInt(0),wo=BigInt(1),px=BigInt(2),gx=BigInt(7),mx=BigInt(256),yx=BigInt(113);for(let t=0,e=wo,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],xb.push(2*(5*n+r)),Ob.push((t+1)*(t+2)/2%64);let s=fx;for(let i=0;i<7;i++)e=(e<<wo^(e>>gx)*yx)%mx,e&px&&(s^=wo<<(wo<<BigInt(i))-wo);Rb.push(s)}const[wx,bx]=sx(Rb,!0),yg=(t,e,r)=>r>32?ax(t,e,r):ix(t,e,r),wg=(t,e,r)=>r>32?cx(t,e,r):ox(t,e,r);function vx(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let o=0;o<10;o++)r[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=r[c],l=r[c+1],d=yg(u,l,1)^r[a],h=wg(u,l,1)^r[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Ob[o],c=yg(s,i,a),u=wg(s,i,a),l=xb[o];s=t[l],i=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)r[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~r[(a+2)%10]&r[(a+4)%10]}t[0]^=wx[n],t[1]^=bx[n]}r.fill(0)}let Ex=class $b extends rf{constructor(e,r,n,s=!1,i=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=n,this.enableXOF=s,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Qo(n),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ux(this.state)}keccak(){gg||mg(this.state32),vx(this.state32,this.rounds),gg||mg(this.state32),this.posOut=0,this.pos=0}update(e){Ri(this);const{blockLen:r,state:n}=this;e=$i(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);for(let a=0;a<o;a++)n[this.pos++]^=e[i++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:n,blockLen:s}=this;e[n]^=r,(r&128)!==0&&n===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ri(this,!1),Ja(e),this.finish();const r=this.state,{blockLen:n}=this;for(let s=0,i=e.length;s<i;){this.posOut>=n&&this.keccak();const o=Math.min(n-this.posOut,i-s);e.set(r.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Qo(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Tb(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:n,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new $b(r,n,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=n,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const _x=(t,e,r)=>Pb(()=>new Ex(e,t,r)),Cx=_x(1,136,256/8),Ax="https://rpc.walletconnect.org/v1";function Db(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Buffer.from(Cx(r)).toString("hex")}async function Ix(t,e,r,n,s,i){switch(r.t){case"eip191":return await Sx(t,e,r.s);case"eip1271":return await Nx(t,e,r.s,n,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function Sx(t,e,r){return(await JN({hash:Db(e),signature:r})).toLowerCase()===t.toLowerCase()}async function Nx(t,e,r,n,s,i){const o=Ni(n);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${n}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",u="0000000000000000000000000000000000000000000000000000000000000041",l=r.substring(2),d=Db(e).substring(2),h=a+d+c+u+l,f=await fetch(`${i||Ax}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Tx(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function Tx(){return Date.now()+Math.floor(Math.random()*1e3)}function Px(t){const e=atob(t),r=new Uint8Array(e.length);for(let o=0;o<e.length;o++)r[o]=e.charCodeAt(o);const n=r[0];if(n===0)throw new Error("No signatures found");const s=1+n*64;if(r.length<s)throw new Error("Transaction data too short for claimed signature count");if(r.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return mb.encode(i)}var xx=Object.defineProperty,Ox=Object.defineProperties,Rx=Object.getOwnPropertyDescriptors,bg=Object.getOwnPropertySymbols,$x=Object.prototype.hasOwnProperty,Dx=Object.prototype.propertyIsEnumerable,vg=(t,e,r)=>e in t?xx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,kx=(t,e)=>{for(var r in e||(e={}))$x.call(e,r)&&vg(t,r,e[r]);if(bg)for(var r of bg(e))Dx.call(e,r)&&vg(t,r,e[r]);return t},Ux=(t,e)=>Ox(t,Rx(e));const Lx="did:pkh:",nf=t=>t==null?void 0:t.split(":"),Mx=t=>{const e=t&&nf(t);if(e)return t.includes(Lx)?e[3]:e[1]},Kd=t=>{const e=t&&nf(t);if(e)return e[2]+":"+e[3]},iu=t=>{const e=t&&nf(t);if(e)return e.pop()};async function Eg(t){const{cacao:e,projectId:r}=t,{s:n,p:s}=e,i=kb(s,s.iss),o=iu(s.iss);return await Ix(o,i,n,Kd(s.iss),r)}const kb=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,n=iu(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${Mx(e)}`,c=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,l=t.exp?`Expiration Time: ${t.exp}`:void 0,d=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,f=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=Fc(t.resources);if(p){const g=ea(p);s=Kx(s,g)}return[r,n,"",s,"",i,o,a,c,u,l,d,h,f].filter(g=>g!=null).join(`
`)};function Bx(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function Fx(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Ls(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const n=t.att[r];if(Array.isArray(n))throw new Error(`Resource must be an object: ${r}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(n).forEach(s=>{const i=n[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function jx(t,e,r,n={}){return r==null||r.sort((s,i)=>s.localeCompare(i)),{att:{[t]:qx(e,r,n)}}}function qx(t,e,r={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const n=e.map(s=>({[`${t}/${s}`]:[r]}));return Object.assign({},...n)}function Ub(t){return Ls(t),`urn:recap:${Bx(t).replace(/=/g,"")}`}function ea(t){const e=Fx(t.replace("urn:recap:",""));return Ls(e),e}function zx(t,e,r){const n=jx(t,e,r);return Ub(n)}function Hx(t){return t&&t.includes("urn:recap:")}function Wx(t,e){const r=ea(t),n=ea(e),s=Vx(r,n);return Ub(s)}function Vx(t,e){Ls(t),Ls(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),n={att:{}};return r.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,u;n.att[s]=Ux(kx({},n.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((u=e.att[s])==null?void 0:u[a])})})}),n}function Kx(t="",e){Ls(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const n=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const u={};c.forEach(d=>{u[d.ability]||(u[d.ability]=[]),u[d.ability].push(d.action)});const l=Object.keys(u).map(d=>(s++,`(${s}) '${d}': '${u[d].join("', '")}' for '${a}'.`));n.push(l.join(", ").replace(".,","."))});const i=n.join(" "),o=`${r}${i}`;return`${t?t+" ":""}${o}`}function _g(t){var e;const r=ea(t);Ls(r);const n=(e=r.att)==null?void 0:e.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function Cg(t){const e=ea(t);Ls(e);const r=[];return Object.values(e.att).forEach(n=>{Object.values(n).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&r.push(s[0].chains)})}),[...new Set(r.flat())]}function Fc(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return Hx(e)?e:void 0}function Ml(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Lb(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function or(t,...e){if(!Lb(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Ag(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Gx(t,e){or(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Ig(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const Zn=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Yx=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Zx=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Zx)throw new Error("Non little-endian hardware is not supported");function Jx(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Gd(t){if(typeof t=="string")t=Jx(t);else if(Lb(t))t=Yd(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function Xx(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Qx(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const eO=(t,e)=>{function r(n,...s){if(or(n),t.nonceLength!==void 0){const u=s[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?or(u):or(u,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&or(s[1]);const o=e(n,...s),a=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");or(l)}};let c=!1;return{encrypt(u,l){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,or(u),a(o.encrypt.length,l),o.encrypt(u,l)},decrypt(u,l){if(or(u),i&&u.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,l),o.decrypt(u,l)}}}return Object.assign(r,t),r};function Sg(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!tO(e))throw new Error("invalid output, must be aligned");return e}function Ng(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i);t.setUint32(e+4,o,n),t.setUint32(e+0,a,n)}function tO(t){return t.byteOffset%4===0}function Yd(t){return Uint8Array.from(t)}function Di(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const Mb=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),rO=Mb("expand 16-byte k"),nO=Mb("expand 32-byte k"),sO=Zn(rO),iO=Zn(nO);function Ne(t,e){return t<<e|t>>>32-e}function Zd(t){return t.byteOffset%4===0}const bc=64,oO=16,Bb=2**32-1,Tg=new Uint32Array;function aO(t,e,r,n,s,i,o,a){const c=s.length,u=new Uint8Array(bc),l=Zn(u),d=Zd(s)&&Zd(i),h=d?Zn(s):Tg,f=d?Zn(i):Tg;for(let p=0;p<c;o++){if(t(e,r,n,l,o,a),o>=Bb)throw new Error("arx: counter overflow");const g=Math.min(bc,c-p);if(d&&g===bc){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let w=0,b;w<oO;w++)b=m+w,f[b]=h[b]^l[w];p+=bc;continue}for(let m=0,w;m<g;m++)w=p+m,i[w]=s[w]^u[m];p+=g}}function cO(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:s,counterRight:i,rounds:o}=Xx({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Ml(s),Ml(o),Ig(i),Ig(r),(a,c,u,l,d=0)=>{or(a),or(c),or(u);const h=u.length;if(l===void 0&&(l=new Uint8Array(h)),or(l),Ml(d),d<0||d>=Bb)throw new Error("arx: counter overflow");if(l.length<h)throw new Error(`arx: output (${l.length}) is shorter than data (${h})`);const f=[];let p=a.length,g,m;if(p===32)f.push(g=Yd(a)),m=iO;else if(p===16&&r)g=new Uint8Array(32),g.set(a),g.set(a,16),m=sO,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Zd(c)||f.push(c=Yd(c));const w=Zn(g);if(n){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(m,w,Zn(c.subarray(0,16)),w),c=c.subarray(16)}const b=16-s;if(b!==c.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){const A=new Uint8Array(12);A.set(c,i?0:12-c.length),c=A,f.push(c)}const v=Zn(c);return aO(t,m,w,v,u,l,d,o),Di(...f),l}}const vt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class uO{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Gd(e),or(e,32);const r=vt(e,0),n=vt(e,2),s=vt(e,4),i=vt(e,6),o=vt(e,8),a=vt(e,10),c=vt(e,12),u=vt(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=vt(e,16+2*l)}process(e,r,n=!1){const s=n?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],u=o[2],l=o[3],d=o[4],h=o[5],f=o[6],p=o[7],g=o[8],m=o[9],w=vt(e,r+0),b=vt(e,r+2),v=vt(e,r+4),A=vt(e,r+6),E=vt(e,r+8),y=vt(e,r+10),_=vt(e,r+12),T=vt(e,r+14);let S=i[0]+(w&8191),x=i[1]+((w>>>13|b<<3)&8191),O=i[2]+((b>>>10|v<<6)&8191),L=i[3]+((v>>>7|A<<9)&8191),M=i[4]+((A>>>4|E<<12)&8191),R=i[5]+(E>>>1&8191),I=i[6]+((E>>>14|y<<2)&8191),N=i[7]+((y>>>11|_<<5)&8191),$=i[8]+((_>>>8|T<<8)&8191),k=i[9]+(T>>>5|s),D=0,U=D+S*a+x*(5*m)+O*(5*g)+L*(5*p)+M*(5*f);D=U>>>13,U&=8191,U+=R*(5*h)+I*(5*d)+N*(5*l)+$*(5*u)+k*(5*c),D+=U>>>13,U&=8191;let H=D+S*c+x*a+O*(5*m)+L*(5*g)+M*(5*p);D=H>>>13,H&=8191,H+=R*(5*f)+I*(5*h)+N*(5*d)+$*(5*l)+k*(5*u),D+=H>>>13,H&=8191;let G=D+S*u+x*c+O*a+L*(5*m)+M*(5*g);D=G>>>13,G&=8191,G+=R*(5*p)+I*(5*f)+N*(5*h)+$*(5*d)+k*(5*l),D+=G>>>13,G&=8191;let se=D+S*l+x*u+O*c+L*a+M*(5*m);D=se>>>13,se&=8191,se+=R*(5*g)+I*(5*p)+N*(5*f)+$*(5*h)+k*(5*d),D+=se>>>13,se&=8191;let K=D+S*d+x*l+O*u+L*c+M*a;D=K>>>13,K&=8191,K+=R*(5*m)+I*(5*g)+N*(5*p)+$*(5*f)+k*(5*h),D+=K>>>13,K&=8191;let ie=D+S*h+x*d+O*l+L*u+M*c;D=ie>>>13,ie&=8191,ie+=R*a+I*(5*m)+N*(5*g)+$*(5*p)+k*(5*f),D+=ie>>>13,ie&=8191;let ge=D+S*f+x*h+O*d+L*l+M*u;D=ge>>>13,ge&=8191,ge+=R*c+I*a+N*(5*m)+$*(5*g)+k*(5*p),D+=ge>>>13,ge&=8191;let ze=D+S*p+x*f+O*h+L*d+M*l;D=ze>>>13,ze&=8191,ze+=R*u+I*c+N*a+$*(5*m)+k*(5*g),D+=ze>>>13,ze&=8191;let De=D+S*g+x*p+O*f+L*h+M*d;D=De>>>13,De&=8191,De+=R*l+I*u+N*c+$*a+k*(5*m),D+=De>>>13,De&=8191;let Ie=D+S*m+x*g+O*p+L*f+M*h;D=Ie>>>13,Ie&=8191,Ie+=R*d+I*l+N*u+$*c+k*a,D+=Ie>>>13,Ie&=8191,D=(D<<2)+D|0,D=D+U|0,U=D&8191,D=D>>>13,H+=D,i[0]=U,i[1]=H,i[2]=G,i[3]=se,i[4]=K,i[5]=ie,i[6]=ge,i[7]=ze,i[8]=De,i[9]=Ie}finalize(){const{h:e,pad:r}=this,n=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,n[0]=e[0]+5,s=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+s,s=n[a]>>>13,n[a]&=8191;n[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)n[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+r[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+r[a]|0)+(o>>>16)|0,e[a]=o&65535;Di(n)}update(e){Ag(this);const{buffer:r,blockLen:n}=this;e=Gd(e);const s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);if(o===n){for(;n<=s-i;i+=n)this.process(e,i);continue}r.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){Di(this.h,this.r,this.buffer,this.pad)}digestInto(e){Ag(this),Gx(e,this),this.finished=!0;const{buffer:r,h:n}=this;let{pos:s}=this;if(s){for(r[s++]=1;s<16;s++)r[s]=0;this.process(r,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=n[o]>>>0,e[i++]=n[o]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}}function lO(t){const e=(n,s)=>t(s).update(Gd(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}const dO=lO(t=>new uO(t));function hO(t,e,r,n,s,i=20){let o=t[0],a=t[1],c=t[2],u=t[3],l=e[0],d=e[1],h=e[2],f=e[3],p=e[4],g=e[5],m=e[6],w=e[7],b=s,v=r[0],A=r[1],E=r[2],y=o,_=a,T=c,S=u,x=l,O=d,L=h,M=f,R=p,I=g,N=m,$=w,k=b,D=v,U=A,H=E;for(let se=0;se<i;se+=2)y=y+x|0,k=Ne(k^y,16),R=R+k|0,x=Ne(x^R,12),y=y+x|0,k=Ne(k^y,8),R=R+k|0,x=Ne(x^R,7),_=_+O|0,D=Ne(D^_,16),I=I+D|0,O=Ne(O^I,12),_=_+O|0,D=Ne(D^_,8),I=I+D|0,O=Ne(O^I,7),T=T+L|0,U=Ne(U^T,16),N=N+U|0,L=Ne(L^N,12),T=T+L|0,U=Ne(U^T,8),N=N+U|0,L=Ne(L^N,7),S=S+M|0,H=Ne(H^S,16),$=$+H|0,M=Ne(M^$,12),S=S+M|0,H=Ne(H^S,8),$=$+H|0,M=Ne(M^$,7),y=y+O|0,H=Ne(H^y,16),N=N+H|0,O=Ne(O^N,12),y=y+O|0,H=Ne(H^y,8),N=N+H|0,O=Ne(O^N,7),_=_+L|0,k=Ne(k^_,16),$=$+k|0,L=Ne(L^$,12),_=_+L|0,k=Ne(k^_,8),$=$+k|0,L=Ne(L^$,7),T=T+M|0,D=Ne(D^T,16),R=R+D|0,M=Ne(M^R,12),T=T+M|0,D=Ne(D^T,8),R=R+D|0,M=Ne(M^R,7),S=S+x|0,U=Ne(U^S,16),I=I+U|0,x=Ne(x^I,12),S=S+x|0,U=Ne(U^S,8),I=I+U|0,x=Ne(x^I,7);let G=0;n[G++]=o+y|0,n[G++]=a+_|0,n[G++]=c+T|0,n[G++]=u+S|0,n[G++]=l+x|0,n[G++]=d+O|0,n[G++]=h+L|0,n[G++]=f+M|0,n[G++]=p+R|0,n[G++]=g+I|0,n[G++]=m+N|0,n[G++]=w+$|0,n[G++]=b+k|0,n[G++]=v+D|0,n[G++]=A+U|0,n[G++]=E+H|0}const fO=cO(hO,{counterRight:!1,counterLength:4,allowShortKeys:!1}),pO=new Uint8Array(16),Pg=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(pO.subarray(r))},gO=new Uint8Array(32);function xg(t,e,r,n,s){const i=t(e,r,gO),o=dO.create(i);s&&Pg(o,s),Pg(o,n);const a=new Uint8Array(16),c=Yx(a);Ng(c,0,BigInt(s?s.length:0),!0),Ng(c,8,BigInt(n.length),!0),o.update(a);const u=o.digest();return Di(i,a),u}const mO=t=>(e,r,n)=>({encrypt(s,i){const o=s.length;i=Sg(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,r,a,a,1);const c=xg(t,e,r,a,n);return i.set(c,o),Di(c),i},decrypt(s,i){i=Sg(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=xg(t,e,r,o,n);if(!Qx(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,r,i,i,1),Di(c),i}}),Fb=eO({blockSize:64,nonceLength:12,tagLength:16},mO(fO));let jb=class extends rf{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,tf(e);const n=$i(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Ri(this),this.iHash.update(e),this}digestInto(e){Ri(this),Ja(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Mu=(t,e,r)=>new jb(t,e).update(r).digest();Mu.create=(t,e)=>new jb(t,e);function yO(t,e,r){return tf(t),r===void 0&&(r=new Uint8Array(t.outputLen)),Mu(t,$i(r),$i(e))}const Bl=new Uint8Array([0]),Og=new Uint8Array;function wO(t,e,r,n=32){if(tf(t),Qo(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const s=Math.ceil(n/t.outputLen);r===void 0&&(r=Og);const i=new Uint8Array(s*t.outputLen),o=Mu.create(t,e),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let u=0;u<s;u++)Bl[0]=u+1,a.update(u===0?Og:c).update(r).update(Bl).digestInto(c),i.set(c,t.outputLen*u),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),Bl.fill(0),i.slice(0,n)}const bO=(t,e,r,n,s)=>wO(t,yO(t,e,r),n,s);function vO(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,u=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+u,a,n)}function EO(t,e,r){return t&e^~t&r}function _O(t,e,r){return t&e^t&r^e&r}let CO=class extends rf{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ll(this.buffer)}update(e){Ri(this);const{view:r,buffer:n,blockLen:s}=this;e=$i(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Ll(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ri(this),Tb(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let d=o;d<s;d++)r[d]=0;vO(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Ll(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}};const AO=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Bn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Fn=new Uint32Array(64);class IO extends CO{constructor(){super(64,32,8,!1),this.A=Bn[0]|0,this.B=Bn[1]|0,this.C=Bn[2]|0,this.D=Bn[3]|0,this.E=Bn[4]|0,this.F=Bn[5]|0,this.G=Bn[6]|0,this.H=Bn[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let d=0;d<16;d++,r+=4)Fn[d]=e.getUint32(r,!1);for(let d=16;d<64;d++){const h=Fn[d-15],f=Fn[d-2],p=Vr(h,7)^Vr(h,18)^h>>>3,g=Vr(f,17)^Vr(f,19)^f>>>10;Fn[d]=g+Fn[d-7]+p+Fn[d-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=Vr(a,6)^Vr(a,11)^Vr(a,25),f=l+h+EO(a,c,u)+AO[d]+Fn[d]|0,p=(Vr(n,2)^Vr(n,13)^Vr(n,22))+_O(n,s,i)|0;l=u,u=c,c=a,a=o+f|0,o=i,i=s,s=n,n=f+p|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(n,s,i,o,a,c,u,l)}roundClean(){Fn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Xa=Pb(()=>new IO);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Bu=BigInt(0),Fu=BigInt(1),SO=BigInt(2);function Ms(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Qa(t){if(!Ms(t))throw new Error("Uint8Array expected")}function ki(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const NO=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ui(t){Qa(t);let e="";for(let r=0;r<t.length;r++)e+=NO[t[r]];return e}function Ii(t){const e=t.toString(16);return e.length&1?"0"+e:e}function sf(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Bu:BigInt("0x"+t)}const mn={_0:48,_9:57,A:65,F:70,a:97,f:102};function Rg(t){if(t>=mn._0&&t<=mn._9)return t-mn._0;if(t>=mn.A&&t<=mn.F)return t-(mn.A-10);if(t>=mn.a&&t<=mn.f)return t-(mn.a-10)}function Li(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=Rg(t.charCodeAt(i)),a=Rg(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function Ts(t){return sf(Ui(t))}function ta(t){return Qa(t),sf(Ui(Uint8Array.from(t).reverse()))}function Mi(t,e){return Li(t.toString(16).padStart(e*2,"0"))}function ju(t,e){return Mi(t,e).reverse()}function TO(t){return Li(Ii(t))}function ir(t,e,r){let n;if(typeof e=="string")try{n=Li(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Ms(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function ra(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];Qa(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}function PO(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function xO(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Fl=t=>typeof t=="bigint"&&Bu<=t;function qu(t,e,r){return Fl(t)&&Fl(e)&&Fl(r)&&e<=t&&t<r}function In(t,e,r,n){if(!qu(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function qb(t){let e;for(e=0;t>Bu;t>>=Fu,e+=1);return e}function OO(t,e){return t>>BigInt(e)&Fu}function RO(t,e,r){return t|(r?Fu:Bu)<<BigInt(e)}const of=t=>(SO<<BigInt(t-1))-Fu,jl=t=>new Uint8Array(t),$g=t=>Uint8Array.from(t);function zb(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=jl(t),s=jl(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...l)=>r(s,n,...l),c=(l=jl())=>{s=a($g([0]),l),n=a(),l.length!==0&&(s=a($g([1]),l),n=a())},u=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const d=[];for(;l<e;){n=a();const h=n.slice();d.push(h),l+=n.length}return ra(...d)};return(l,d)=>{o(),c(l);let h;for(;!(h=d(u()));)c();return o(),h}}const $O={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Ms(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function no(t,e,r={}){const n=(s,i,o)=>{const a=$O[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}const DO=()=>{throw new Error("not implemented")};function Jd(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}var kO=Object.freeze({__proto__:null,isBytes:Ms,abytes:Qa,abool:ki,bytesToHex:Ui,numberToHexUnpadded:Ii,hexToNumber:sf,hexToBytes:Li,bytesToNumberBE:Ts,bytesToNumberLE:ta,numberToBytesBE:Mi,numberToBytesLE:ju,numberToVarBytesBE:TO,ensureBytes:ir,concatBytes:ra,equalBytes:PO,utf8ToBytes:xO,inRange:qu,aInRange:In,bitLen:qb,bitGet:OO,bitSet:RO,bitMask:of,createHmacDrbg:zb,validateObject:no,notImplemented:DO,memoized:Jd});const wt=BigInt(0),et=BigInt(1),bs=BigInt(2),UO=BigInt(3),Xd=BigInt(4),Dg=BigInt(5),kg=BigInt(8);function Yt(t,e){const r=t%e;return r>=wt?r:e+r}function Hb(t,e,r){if(e<wt)throw new Error("invalid exponent, negatives unsupported");if(r<=wt)throw new Error("invalid modulus");if(r===et)return wt;let n=et;for(;e>wt;)e&et&&(n=n*t%r),t=t*t%r,e>>=et;return n}function Rr(t,e,r){let n=t;for(;e-- >wt;)n*=n,n%=r;return n}function Qd(t,e){if(t===wt)throw new Error("invert: expected non-zero number");if(e<=wt)throw new Error("invert: expected positive modulus, got "+e);let r=Yt(t,e),n=e,s=wt,i=et;for(;r!==wt;){const o=n/r,a=n%r,c=s-i*o;n=r,r=a,s=i,i=c}if(n!==et)throw new Error("invert: does not exist");return Yt(s,e)}function LO(t){const e=(t-et)/bs;let r,n,s;for(r=t-et,n=0;r%bs===wt;r/=bs,n++);for(s=bs;s<t&&Hb(s,e,t)!==t-et;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+et)/Xd;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(r+et)/bs;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=n,u=o.pow(o.mul(o.ONE,s),r),l=o.pow(a,i),d=o.pow(a,r);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(d);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const f=o.pow(u,et<<BigInt(c-h-1));u=o.sqr(f),l=o.mul(l,f),d=o.mul(d,u),c=h}return l}}function MO(t){if(t%Xd===UO){const e=(t+et)/Xd;return function(r,n){const s=r.pow(n,e);if(!r.eql(r.sqr(s),n))throw new Error("Cannot find square root");return s}}if(t%kg===Dg){const e=(t-Dg)/kg;return function(r,n){const s=r.mul(n,bs),i=r.pow(s,e),o=r.mul(n,i),a=r.mul(r.mul(o,bs),i),c=r.mul(o,r.sub(a,r.ONE));if(!r.eql(r.sqr(c),n))throw new Error("Cannot find square root");return c}}return LO(t)}const BO=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function FO(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=BO.reduce((n,s)=>(n[s]="function",n),e);return no(t,r)}function jO(t,e,r){if(r<wt)throw new Error("invalid exponent, negatives unsupported");if(r===wt)return t.ONE;if(r===et)return e;let n=t.ONE,s=e;for(;r>wt;)r&et&&(n=t.mul(n,s)),s=t.sqr(s),r>>=et;return n}function qO(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function Wb(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Vb(t,e,r=!1,n={}){if(t<=wt)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=Wb(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:of(s),ZERO:wt,ONE:et,create:c=>Yt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return wt<=c&&c<t},is0:c=>c===wt,isOdd:c=>(c&et)===et,neg:c=>Yt(-c,t),eql:(c,u)=>c===u,sqr:c=>Yt(c*c,t),add:(c,u)=>Yt(c+u,t),sub:(c,u)=>Yt(c-u,t),mul:(c,u)=>Yt(c*u,t),pow:(c,u)=>jO(a,c,u),div:(c,u)=>Yt(c*Qd(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Qd(c,t),sqrt:n.sqrt||(c=>(o||(o=MO(t)),o(a,c))),invertBatch:c=>qO(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>r?ju(c,i):Mi(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?ta(c):Ts(c)}});return Object.freeze(a)}function Kb(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Gb(t){const e=Kb(t);return e+Math.ceil(e/2)}function zO(t,e,r=!1){const n=t.length,s=Kb(e),i=Gb(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?ta(t):Ts(t),a=Yt(o,e-et)+et;return r?ju(a,s):Mi(a,s)}const Ug=BigInt(0),vc=BigInt(1);function ql(t,e){const r=e.negate();return t?r:e}function Yb(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function zl(t,e){Yb(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function HO(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function WO(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Hl=new WeakMap,Zb=new WeakMap;function Wl(t){return Zb.get(t)||1}function VO(t,e){return{constTimeNegate:ql,hasPrecomputes(r){return Wl(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>Ug;)n&vc&&(s=s.add(i)),i=i.double(),n>>=vc;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=zl(n,e),o=[];let a=r,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){const{windows:i,windowSize:o}=zl(r,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**r-1),l=2**r,d=BigInt(r);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&u);s>>=d,p>o&&(p-=l,s+=vc);const g=f,m=f+Math.abs(p)-1,w=h%2!==0,b=p<0;p===0?c=c.add(ql(w,n[g])):a=a.add(ql(b,n[m]))}return{p:a,f:c}},wNAFUnsafe(r,n,s,i=t.ZERO){const{windows:o,windowSize:a}=zl(r,e),c=BigInt(2**r-1),u=2**r,l=BigInt(r);for(let d=0;d<o;d++){const h=d*a;if(s===Ug)break;let f=Number(s&c);if(s>>=l,f>a&&(f-=u,s+=vc),f===0)continue;let p=n[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(r,n,s){let i=Hl.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&Hl.set(n,s(i))),i},wNAFCached(r,n,s){const i=Wl(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=Wl(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){Yb(n,e),Zb.set(r,n),Hl.delete(r)}}}function KO(t,e,r,n){if(HO(r,t),WO(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=qb(BigInt(r.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let d=u;d>=0;d-=o){c.fill(s);for(let f=0;f<n.length;f++){const p=n[f],g=Number(p>>BigInt(d)&BigInt(a));c[g]=c[g].add(r[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(l=l.add(h),d!==0)for(let f=0;f<o;f++)l=l.double()}return l}function Jb(t){return FO(t.Fp),no(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Wb(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const oi=BigInt(0),Vl=BigInt(1);function GO(t){return no(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function YO(t){const e=GO(t),{P:r}=e,n=b=>Yt(b,r),s=e.montgomeryBits,i=Math.ceil(s/8),o=e.nByteLength,a=e.adjustScalarBytes||(b=>b),c=e.powPminus2||(b=>Hb(b,r-BigInt(2),r));function u(b,v,A){const E=n(b*(v-A));return v=n(v-E),A=n(A+E),[v,A]}const l=(e.a-BigInt(2))/BigInt(4);function d(b,v){In("u",b,oi,r),In("scalar",v,oi,r);const A=v,E=b;let y=Vl,_=oi,T=b,S=Vl,x=oi,O;for(let M=BigInt(s-1);M>=oi;M--){const R=A>>M&Vl;x^=R,O=u(x,y,T),y=O[0],T=O[1],O=u(x,_,S),_=O[0],S=O[1],x=R;const I=y+_,N=n(I*I),$=y-_,k=n($*$),D=N-k,U=T+S,H=T-S,G=n(H*I),se=n(U*$),K=G+se,ie=G-se;T=n(K*K),S=n(E*n(ie*ie)),y=n(N*k),_=n(D*(N+n(l*D)))}O=u(x,y,T),y=O[0],T=O[1],O=u(x,_,S),_=O[0],S=O[1];const L=c(_);return n(y*L)}function h(b){return ju(n(b),i)}function f(b){const v=ir("u coordinate",b,i);return o===32&&(v[31]&=127),ta(v)}function p(b){const v=ir("scalar",b),A=v.length;if(A!==i&&A!==o){let E=""+i+" or "+o;throw new Error("invalid scalar, expected "+E+" bytes, got "+A)}return ta(a(v))}function g(b,v){const A=f(v),E=p(b),y=d(A,E);if(y===oi)throw new Error("invalid private or public key received");return h(y)}const m=h(e.Gu);function w(b){return g(b,m)}return{scalarMult:g,scalarMultBase:w,getSharedSecret:(b,v)=>g(b,v),getPublicKey:b=>w(b),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:m}}const eh=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const ZO=BigInt(1),Lg=BigInt(2),JO=BigInt(3),XO=BigInt(5);BigInt(8);function QO(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=eh,o=t*t%i*t%i,a=Rr(o,Lg,i)*o%i,c=Rr(a,ZO,i)*t%i,u=Rr(c,XO,i)*c%i,l=Rr(u,e,i)*u%i,d=Rr(l,r,i)*l%i,h=Rr(d,n,i)*d%i,f=Rr(h,s,i)*h%i,p=Rr(f,s,i)*h%i,g=Rr(p,e,i)*u%i;return{pow_p_5_8:Rr(g,Lg,i)*t%i,b2:o}}function e2(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const th=YO({P:eh,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=eh,{pow_p_5_8:r,b2:n}=QO(t);return Yt(Rr(r,JO,e)*n,e)},adjustScalarBytes:e2,randomBytes:ro});function Mg(t){t.lowS!==void 0&&ki("lowS",t.lowS),t.prehash!==void 0&&ki("prehash",t.prehash)}function t2(t){const e=Jb(t);no(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:r2,hexToBytes:n2}=kO;class s2 extends Error{constructor(e=""){super(e)}}const En={Err:s2,_tlv:{encode:(t,e)=>{const{Err:r}=En;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=Ii(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?Ii(s.length/2|128):"";return Ii(t)+i+s+e},decode(t,e){const{Err:r}=En;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const u=e.subarray(n,n+c);if(u.length!==c)throw new r("tlv.decode: length bytes not complete");if(u[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=En;if(t<Cn)throw new e("integer: negative integers are not allowed");let r=Ii(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=En;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return r2(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=En,s=typeof t=="string"?n2(t):t;Qa(s);const{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:u,l}=n.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=En,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}},Cn=BigInt(0),ft=BigInt(1);BigInt(2);const Bg=BigInt(3);BigInt(4);function i2(t){const e=t2(t),{Fp:r}=e,n=Vb(e.n,e.nBitLength),s=e.toBytes||((g,m,w)=>{const b=m.toAffine();return ra(Uint8Array.from([4]),r.toBytes(b.x),r.toBytes(b.y))}),i=e.fromBytes||(g=>{const m=g.subarray(1),w=r.fromBytes(m.subarray(0,r.BYTES)),b=r.fromBytes(m.subarray(r.BYTES,2*r.BYTES));return{x:w,y:b}});function o(g){const{a:m,b:w}=e,b=r.sqr(g),v=r.mul(b,g);return r.add(r.add(v,r.mul(g,m)),w)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(g){return qu(g,ft,e.n)}function c(g){const{allowedPrivateKeyLengths:m,nByteLength:w,wrapPrivateKey:b,n:v}=e;if(m&&typeof g!="bigint"){if(Ms(g)&&(g=Ui(g)),typeof g!="string"||!m.includes(g.length))throw new Error("invalid private key");g=g.padStart(w*2,"0")}let A;try{A=typeof g=="bigint"?g:Ts(ir("private key",g,w))}catch{throw new Error("invalid private key, expected hex or "+w+" bytes, got "+typeof g)}return b&&(A=Yt(A,v)),In("private key",A,ft,v),A}function u(g){if(!(g instanceof h))throw new Error("ProjectivePoint expected")}const l=Jd((g,m)=>{const{px:w,py:b,pz:v}=g;if(r.eql(v,r.ONE))return{x:w,y:b};const A=g.is0();m==null&&(m=A?r.ONE:r.inv(v));const E=r.mul(w,m),y=r.mul(b,m),_=r.mul(v,m);if(A)return{x:r.ZERO,y:r.ZERO};if(!r.eql(_,r.ONE))throw new Error("invZ was invalid");return{x:E,y}}),d=Jd(g=>{if(g.is0()){if(e.allowInfinityPoint&&!r.is0(g.py))return;throw new Error("bad point: ZERO")}const{x:m,y:w}=g.toAffine();if(!r.isValid(m)||!r.isValid(w))throw new Error("bad point: x or y not FE");const b=r.sqr(w),v=o(m);if(!r.eql(b,v))throw new Error("bad point: equation left != right");if(!g.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class h{constructor(m,w,b){if(this.px=m,this.py=w,this.pz=b,m==null||!r.isValid(m))throw new Error("x required");if(w==null||!r.isValid(w))throw new Error("y required");if(b==null||!r.isValid(b))throw new Error("z required");Object.freeze(this)}static fromAffine(m){const{x:w,y:b}=m||{};if(!m||!r.isValid(w)||!r.isValid(b))throw new Error("invalid affine point");if(m instanceof h)throw new Error("projective point not allowed");const v=A=>r.eql(A,r.ZERO);return v(w)&&v(b)?h.ZERO:new h(w,b,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(m){const w=r.invertBatch(m.map(b=>b.pz));return m.map((b,v)=>b.toAffine(w[v])).map(h.fromAffine)}static fromHex(m){const w=h.fromAffine(i(ir("pointHex",m)));return w.assertValidity(),w}static fromPrivateKey(m){return h.BASE.multiply(c(m))}static msm(m,w){return KO(h,n,m,w)}_setWindowSize(m){p.setWindowSize(this,m)}assertValidity(){d(this)}hasEvenY(){const{y:m}=this.toAffine();if(r.isOdd)return!r.isOdd(m);throw new Error("Field doesn't support isOdd")}equals(m){u(m);const{px:w,py:b,pz:v}=this,{px:A,py:E,pz:y}=m,_=r.eql(r.mul(w,y),r.mul(A,v)),T=r.eql(r.mul(b,y),r.mul(E,v));return _&&T}negate(){return new h(this.px,r.neg(this.py),this.pz)}double(){const{a:m,b:w}=e,b=r.mul(w,Bg),{px:v,py:A,pz:E}=this;let y=r.ZERO,_=r.ZERO,T=r.ZERO,S=r.mul(v,v),x=r.mul(A,A),O=r.mul(E,E),L=r.mul(v,A);return L=r.add(L,L),T=r.mul(v,E),T=r.add(T,T),y=r.mul(m,T),_=r.mul(b,O),_=r.add(y,_),y=r.sub(x,_),_=r.add(x,_),_=r.mul(y,_),y=r.mul(L,y),T=r.mul(b,T),O=r.mul(m,O),L=r.sub(S,O),L=r.mul(m,L),L=r.add(L,T),T=r.add(S,S),S=r.add(T,S),S=r.add(S,O),S=r.mul(S,L),_=r.add(_,S),O=r.mul(A,E),O=r.add(O,O),S=r.mul(O,L),y=r.sub(y,S),T=r.mul(O,x),T=r.add(T,T),T=r.add(T,T),new h(y,_,T)}add(m){u(m);const{px:w,py:b,pz:v}=this,{px:A,py:E,pz:y}=m;let _=r.ZERO,T=r.ZERO,S=r.ZERO;const x=e.a,O=r.mul(e.b,Bg);let L=r.mul(w,A),M=r.mul(b,E),R=r.mul(v,y),I=r.add(w,b),N=r.add(A,E);I=r.mul(I,N),N=r.add(L,M),I=r.sub(I,N),N=r.add(w,v);let $=r.add(A,y);return N=r.mul(N,$),$=r.add(L,R),N=r.sub(N,$),$=r.add(b,v),_=r.add(E,y),$=r.mul($,_),_=r.add(M,R),$=r.sub($,_),S=r.mul(x,N),_=r.mul(O,R),S=r.add(_,S),_=r.sub(M,S),S=r.add(M,S),T=r.mul(_,S),M=r.add(L,L),M=r.add(M,L),R=r.mul(x,R),N=r.mul(O,N),M=r.add(M,R),R=r.sub(L,R),R=r.mul(x,R),N=r.add(N,R),L=r.mul(M,N),T=r.add(T,L),L=r.mul($,N),_=r.mul(I,_),_=r.sub(_,L),L=r.mul(I,M),S=r.mul($,S),S=r.add(S,L),new h(_,T,S)}subtract(m){return this.add(m.negate())}is0(){return this.equals(h.ZERO)}wNAF(m){return p.wNAFCached(this,m,h.normalizeZ)}multiplyUnsafe(m){const{endo:w,n:b}=e;In("scalar",m,Cn,b);const v=h.ZERO;if(m===Cn)return v;if(this.is0()||m===ft)return this;if(!w||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,m,h.normalizeZ);let{k1neg:A,k1:E,k2neg:y,k2:_}=w.splitScalar(m),T=v,S=v,x=this;for(;E>Cn||_>Cn;)E&ft&&(T=T.add(x)),_&ft&&(S=S.add(x)),x=x.double(),E>>=ft,_>>=ft;return A&&(T=T.negate()),y&&(S=S.negate()),S=new h(r.mul(S.px,w.beta),S.py,S.pz),T.add(S)}multiply(m){const{endo:w,n:b}=e;In("scalar",m,ft,b);let v,A;if(w){const{k1neg:E,k1:y,k2neg:_,k2:T}=w.splitScalar(m);let{p:S,f:x}=this.wNAF(y),{p:O,f:L}=this.wNAF(T);S=p.constTimeNegate(E,S),O=p.constTimeNegate(_,O),O=new h(r.mul(O.px,w.beta),O.py,O.pz),v=S.add(O),A=x.add(L)}else{const{p:E,f:y}=this.wNAF(m);v=E,A=y}return h.normalizeZ([v,A])[0]}multiplyAndAddUnsafe(m,w,b){const v=h.BASE,A=(y,_)=>_===Cn||_===ft||!y.equals(v)?y.multiplyUnsafe(_):y.multiply(_),E=A(this,w).add(A(m,b));return E.is0()?void 0:E}toAffine(m){return l(this,m)}isTorsionFree(){const{h:m,isTorsionFree:w}=e;if(m===ft)return!0;if(w)return w(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:m,clearCofactor:w}=e;return m===ft?this:w?w(h,this):this.multiplyUnsafe(e.h)}toRawBytes(m=!0){return ki("isCompressed",m),this.assertValidity(),s(h,this,m)}toHex(m=!0){return ki("isCompressed",m),Ui(this.toRawBytes(m))}}h.BASE=new h(e.Gx,e.Gy,r.ONE),h.ZERO=new h(r.ZERO,r.ONE,r.ZERO);const f=e.nBitLength,p=VO(h,e.endo?Math.ceil(f/2):f);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function o2(t){const e=Jb(t);return no(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function a2(t){const e=o2(t),{Fp:r,n}=e,s=r.BYTES+1,i=2*r.BYTES+1;function o(R){return Yt(R,n)}function a(R){return Qd(R,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:u,weierstrassEquation:l,isWithinCurveOrder:d}=i2({...e,toBytes(R,I,N){const $=I.toAffine(),k=r.toBytes($.x),D=ra;return ki("isCompressed",N),N?D(Uint8Array.from([I.hasEvenY()?2:3]),k):D(Uint8Array.from([4]),k,r.toBytes($.y))},fromBytes(R){const I=R.length,N=R[0],$=R.subarray(1);if(I===s&&(N===2||N===3)){const k=Ts($);if(!qu(k,ft,r.ORDER))throw new Error("Point is not on curve");const D=l(k);let U;try{U=r.sqrt(D)}catch(G){const se=G instanceof Error?": "+G.message:"";throw new Error("Point is not on curve"+se)}const H=(U&ft)===ft;return(N&1)===1!==H&&(U=r.neg(U)),{x:k,y:U}}else if(I===i&&N===4){const k=r.fromBytes($.subarray(0,r.BYTES)),D=r.fromBytes($.subarray(r.BYTES,2*r.BYTES));return{x:k,y:D}}else{const k=s,D=i;throw new Error("invalid Point, expected length of "+k+", or uncompressed "+D+", got "+I)}}}),h=R=>Ui(Mi(R,e.nByteLength));function f(R){const I=n>>ft;return R>I}function p(R){return f(R)?o(-R):R}const g=(R,I,N)=>Ts(R.slice(I,N));class m{constructor(I,N,$){this.r=I,this.s=N,this.recovery=$,this.assertValidity()}static fromCompact(I){const N=e.nByteLength;return I=ir("compactSignature",I,N*2),new m(g(I,0,N),g(I,N,2*N))}static fromDER(I){const{r:N,s:$}=En.toSig(ir("DER",I));return new m(N,$)}assertValidity(){In("r",this.r,ft,n),In("s",this.s,ft,n)}addRecoveryBit(I){return new m(this.r,this.s,I)}recoverPublicKey(I){const{r:N,s:$,recovery:k}=this,D=y(ir("msgHash",I));if(k==null||![0,1,2,3].includes(k))throw new Error("recovery id invalid");const U=k===2||k===3?N+e.n:N;if(U>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const H=(k&1)===0?"02":"03",G=c.fromHex(H+h(U)),se=a(U),K=o(-D*se),ie=o($*se),ge=c.BASE.multiplyAndAddUnsafe(G,K,ie);if(!ge)throw new Error("point at infinify");return ge.assertValidity(),ge}hasHighS(){return f(this.s)}normalizeS(){return this.hasHighS()?new m(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Li(this.toDERHex())}toDERHex(){return En.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Li(this.toCompactHex())}toCompactHex(){return h(this.r)+h(this.s)}}const w={isValidPrivateKey(R){try{return u(R),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{const R=Gb(e.n);return zO(e.randomBytes(R),e.n)},precompute(R=8,I=c.BASE){return I._setWindowSize(R),I.multiply(BigInt(3)),I}};function b(R,I=!0){return c.fromPrivateKey(R).toRawBytes(I)}function v(R){const I=Ms(R),N=typeof R=="string",$=(I||N)&&R.length;return I?$===s||$===i:N?$===2*s||$===2*i:R instanceof c}function A(R,I,N=!0){if(v(R))throw new Error("first arg must be private key");if(!v(I))throw new Error("second arg must be public key");return c.fromHex(I).multiply(u(R)).toRawBytes(N)}const E=e.bits2int||function(R){if(R.length>8192)throw new Error("input is too large");const I=Ts(R),N=R.length*8-e.nBitLength;return N>0?I>>BigInt(N):I},y=e.bits2int_modN||function(R){return o(E(R))},_=of(e.nBitLength);function T(R){return In("num < 2^"+e.nBitLength,R,Cn,_),Mi(R,e.nByteLength)}function S(R,I,N=x){if(["recovered","canonical"].some(De=>De in N))throw new Error("sign() legacy options not supported");const{hash:$,randomBytes:k}=e;let{lowS:D,prehash:U,extraEntropy:H}=N;D==null&&(D=!0),R=ir("msgHash",R),Mg(N),U&&(R=ir("prehashed msgHash",$(R)));const G=y(R),se=u(I),K=[T(se),T(G)];if(H!=null&&H!==!1){const De=H===!0?k(r.BYTES):H;K.push(ir("extraEntropy",De))}const ie=ra(...K),ge=G;function ze(De){const Ie=E(De);if(!d(Ie))return;const Pt=a(Ie),bt=c.BASE.multiply(Ie).toAffine(),Dt=o(bt.x);if(Dt===Cn)return;const dr=o(Pt*o(ge+Dt*se));if(dr===Cn)return;let hr=(bt.x===Dt?0:2)|Number(bt.y&ft),ei=dr;return D&&f(dr)&&(ei=p(dr),hr^=1),new m(Dt,ei,hr)}return{seed:ie,k2sig:ze}}const x={lowS:e.lowS,prehash:!1},O={lowS:e.lowS,prehash:!1};function L(R,I,N=x){const{seed:$,k2sig:k}=S(R,I,N),D=e;return zb(D.hash.outputLen,D.nByteLength,D.hmac)($,k)}c.BASE._setWindowSize(8);function M(R,I,N,$=O){var dr;const k=R;I=ir("msgHash",I),N=ir("publicKey",N);const{lowS:D,prehash:U,format:H}=$;if(Mg($),"strict"in $)throw new Error("options.strict was renamed to lowS");if(H!==void 0&&H!=="compact"&&H!=="der")throw new Error("format must be compact or der");const G=typeof k=="string"||Ms(k),se=!G&&!H&&typeof k=="object"&&k!==null&&typeof k.r=="bigint"&&typeof k.s=="bigint";if(!G&&!se)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let K,ie;try{if(se&&(K=new m(k.r,k.s)),G){try{H!=="compact"&&(K=m.fromDER(k))}catch(hr){if(!(hr instanceof En.Err))throw hr}!K&&H!=="der"&&(K=m.fromCompact(k))}ie=c.fromHex(N)}catch{return!1}if(!K||D&&K.hasHighS())return!1;U&&(I=e.hash(I));const{r:ge,s:ze}=K,De=y(I),Ie=a(ze),Pt=o(De*Ie),bt=o(ge*Ie),Dt=(dr=c.BASE.multiplyAndAddUnsafe(ie,Pt,bt))==null?void 0:dr.toAffine();return Dt?o(Dt.x)===ge:!1}return{CURVE:e,getPublicKey:b,getSharedSecret:A,sign:L,verify:M,ProjectivePoint:c,Signature:m,utils:w}}function c2(t){return{hash:t,hmac:(e,...r)=>Mu(t,e,hx(...r)),randomBytes:ro}}function u2(t,e){const r=n=>a2({...t,...c2(n)});return{...r(e),create:r}}const Xb=Vb(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),l2=Xb.create(BigInt("-3")),d2=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),h2=u2({a:l2,b:d2,Fp:Xb,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Xa),Qb="base10",Mt="base16",Ur="base64pad",Hn="base64url",ec="utf8",e0=0,Sn=1,tc=2,f2=0,Fg=1,Uo=12,af=32;function p2(){const t=th.utils.randomPrivateKey(),e=th.getPublicKey(t);return{privateKey:Zt(t,Mt),publicKey:Zt(e,Mt)}}function rh(){const t=ro(af);return Zt(t,Mt)}function g2(t,e){const r=th.getSharedSecret(vr(t,Mt),vr(e,Mt)),n=bO(Xa,r,void 0,void 0,af);return Zt(n,Mt)}function jc(t){const e=Xa(vr(t,Mt));return Zt(e,Mt)}function Qr(t){const e=Xa(vr(t,ec));return Zt(e,Mt)}function t0(t){return vr(`${t}`,Qb)}function Bs(t){return Number(Zt(t,Qb))}function r0(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function n0(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),r=(4-e.length%4)%4;return e+"=".repeat(r)}function m2(t){const e=t0(typeof t.type<"u"?t.type:e0);if(Bs(e)===Sn&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?vr(t.senderPublicKey,Mt):void 0,n=typeof t.iv<"u"?vr(t.iv,Mt):ro(Uo),s=vr(t.symKey,Mt),i=Fb(s,n).encrypt(vr(t.message,ec)),o=s0({type:e,sealed:i,iv:n,senderPublicKey:r});return t.encoding===Hn?r0(o):o}function y2(t){const e=vr(t.symKey,Mt),{sealed:r,iv:n}=na({encoded:t.encoded,encoding:t.encoding}),s=Fb(e,n).decrypt(r);if(s===null)throw new Error("Failed to decrypt");return Zt(s,ec)}function w2(t,e){const r=t0(tc),n=ro(Uo),s=vr(t,ec),i=s0({type:r,sealed:s,iv:n});return e===Hn?r0(i):i}function b2(t,e){const{sealed:r}=na({encoded:t,encoding:e});return Zt(r,ec)}function s0(t){if(Bs(t.type)===tc)return Zt(ko([t.type,t.sealed]),Ur);if(Bs(t.type)===Sn){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Zt(ko([t.type,t.senderPublicKey,t.iv,t.sealed]),Ur)}return Zt(ko([t.type,t.iv,t.sealed]),Ur)}function na(t){const e=(t.encoding||Ur)===Hn?n0(t.encoded):t.encoded,r=vr(e,Ur),n=r.slice(f2,Fg),s=Fg;if(Bs(n)===Sn){const c=s+af,u=c+Uo,l=r.slice(s,c),d=r.slice(c,u),h=r.slice(u);return{type:n,sealed:h,iv:d,senderPublicKey:l}}if(Bs(n)===tc){const c=r.slice(s),u=ro(Uo);return{type:n,sealed:c,iv:u}}const i=s+Uo,o=r.slice(s,i),a=r.slice(i);return{type:n,sealed:a,iv:o}}function v2(t,e){const r=na({encoded:t,encoding:e==null?void 0:e.encoding});return i0({type:Bs(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Zt(r.senderPublicKey,Mt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function i0(t){const e=(t==null?void 0:t.type)||e0;if(e===Sn){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function jg(t){return t.type===Sn&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function qg(t){return t.type===tc}function E2(t){const e=Buffer.from(t.x,"base64"),r=Buffer.from(t.y,"base64");return ko([new Uint8Array([4]),e,r])}function _2(t,e){const[r,n,s]=t.split("."),i=Buffer.from(n0(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${r}.${n}`,u=Xa(c),l=E2(e);if(!h2.verify(ko([o,a]),u,l))throw new Error("Invalid signature");return Md(t).payload}const C2="irn";function ou(t){return(t==null?void 0:t.relay)||{protocol:C2}}function xo(t){const e=TP[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function A2(t,e="-"){const r={},n="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(n)){const i=s.replace(n,""),o=t[s];r[i]=o}}),r}function zg(t){if(!t.includes("wc:")){const u=Nb(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,n=t.substring(0,e),s=t.substring(e+1,r).split("@"),i=typeof r<"u"?t.substring(r):"",o=new URLSearchParams(i),a={};o.forEach((u,l)=>{a[l]=u});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:n,topic:I2(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:A2(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function I2(t){return t.startsWith("//")?t.substring(2):t}function S2(t,e="-"){const r="relay",n={};return Object.keys(t).forEach(s=>{const i=s,o=r+e+i;t[i]&&(n[o]=t[i])}),n}function Hg(t){const e=new URLSearchParams,r=S2(t.relay);Object.keys(r).sort().forEach(s=>{e.set(s,r[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const n=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${n}`}function Ec(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}function so(t){const e=[];return t.forEach(r=>{const[n,s]=r.split(":");e.push(`${n}:${s}`)}),e}function N2(t){const e=[];return Object.values(t).forEach(r=>{e.push(...so(r.accounts))}),e}function T2(t,e){const r=[];return Object.values(t).forEach(n=>{so(n.accounts).includes(e)&&r.push(...n.methods)}),r}function P2(t,e){const r=[];return Object.values(t).forEach(n=>{so(n.accounts).includes(e)&&r.push(...n.events)}),r}function cf(t){return t.includes(":")}function Oo(t){return cf(t)?t.split(":")[0]:t}function x2(t){const e={};return t==null||t.forEach(r=>{var n;const[s,i]=r.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(r),(n=e[s].chains)==null||n.push(`${s}:${i}`)}),e}function Wg(t,e){e=e.map(n=>n.replace("did:pkh:",""));const r=x2(e);for(const[n,s]of Object.entries(r))s.methods?s.methods=Bc(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return r}const O2={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},R2={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function V(t,e){const{message:r,code:n}=R2[t];return{message:e?`${r} ${e}`:r,code:n}}function Me(t,e){const{message:r,code:n}=O2[t];return{message:e?`${r} ${e}`:r,code:n}}function Jn(t,e){return!!Array.isArray(t)}function sa(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function At(t){return typeof t>"u"}function nt(t,e){return e&&At(t)?!0:typeof t=="string"&&!!t.trim().length}function uf(t,e){return e&&At(t)?!0:typeof t=="number"&&!isNaN(t)}function $2(t,e){const{requiredNamespaces:r}=e,n=Object.keys(t.namespaces),s=Object.keys(r);let i=!0;return _s(s,n)?(n.forEach(o=>{const{accounts:a,methods:c,events:u}=t.namespaces[o],l=so(a),d=r[o];(!_s(_b(o,d),l)||!_s(d.methods,c)||!_s(d.events,u))&&(i=!1)}),i):!1}function au(t){return nt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function D2(t){if(nt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&au(r)}}return!1}function k2(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(nt(t,!1)){if(e(t))return!0;const r=Nb(t);return e(r)}}catch{}return!1}function U2(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function L2(t){return t==null?void 0:t.topic}function M2(t,e){let r=null;return nt(t==null?void 0:t.publicKey,!1)||(r=V("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function Vg(t){let e=!0;return Jn(t)?t.length&&(e=t.every(r=>nt(r,!1))):e=!1,e}function B2(t,e,r){let n=null;return Jn(e)&&e.length?e.forEach(s=>{n||au(s)||(n=Me("UNSUPPORTED_CHAINS",`${r}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):au(t)||(n=Me("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function F2(t,e,r){let n=null;return Object.entries(t).forEach(([s,i])=>{if(n)return;const o=B2(s,_b(s,i),`${e} ${r}`);o&&(n=o)}),n}function j2(t,e){let r=null;return Jn(t)?t.forEach(n=>{r||D2(n)||(r=Me("UNSUPPORTED_ACCOUNTS",`${e}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Me("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function q2(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=j2(n==null?void 0:n.accounts,`${e} namespace`);s&&(r=s)}),r}function z2(t,e){let r=null;return Vg(t==null?void 0:t.methods)?Vg(t==null?void 0:t.events)||(r=Me("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=Me("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function o0(t,e){let r=null;return Object.values(t).forEach(n=>{if(r)return;const s=z2(n,`${e}, namespace`);s&&(r=s)}),r}function H2(t,e,r){let n=null;if(t&&sa(t)){const s=o0(t,e);s&&(n=s);const i=F2(t,e,r);i&&(n=i)}else n=V("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return n}function Kl(t,e){let r=null;if(t&&sa(t)){const n=o0(t,e);n&&(r=n);const s=q2(t,e);s&&(r=s)}else r=V("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function a0(t){return nt(t.protocol,!0)}function W2(t,e){let r=!1;return t?t&&Jn(t)&&t.length&&t.forEach(n=>{r=a0(n)}):r=!0,r}function V2(t){return typeof t=="number"}function Kt(t){return typeof t<"u"&&typeof t!==null}function K2(t){return!(!t||typeof t!="object"||!t.code||!uf(t.code,!1)||!t.message||!nt(t.message,!1))}function G2(t){return!(At(t)||!nt(t.method,!1))}function Y2(t){return!(At(t)||At(t.result)&&At(t.error)||!uf(t.id,!1)||!nt(t.jsonrpc,!1))}function Z2(t){return!(At(t)||!nt(t.name,!1))}function Kg(t,e){return!(!au(e)||!N2(t).includes(e))}function J2(t,e,r){return nt(r,!1)?T2(t,e).includes(r):!1}function X2(t,e,r){return nt(r,!1)?P2(t,e).includes(r):!1}function Gg(t,e,r){let n=null;const s=Q2(t),i=eR(e),o=Object.keys(s),a=Object.keys(i),c=Yg(Object.keys(t)),u=Yg(Object.keys(e)),l=c.filter(d=>!u.includes(d));return l.length&&(n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${l.toString()}
      Received: ${Object.keys(e).toString()}`)),_s(o,a)||(n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||n)return;const h=so(e[d].accounts);h.includes(d)||(n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{n||(_s(s[d].methods,i[d].methods)?_s(s[d].events,i[d].events)||(n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${d}`)):n=V("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${d}`))}),n}function Q2(t){const e={};return Object.keys(t).forEach(r=>{var n;r.includes(":")?e[r]=t[r]:(n=t[r].chains)==null||n.forEach(s=>{e[s]={methods:t[r].methods,events:t[r].events}})}),e}function Yg(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function eR(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const n=so(t[r].accounts);n==null||n.forEach(s=>{e[s]={accounts:t[r].accounts.filter(i=>i.includes(`${s}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function tR(t,e){return uf(t,!1)&&t<=e.max&&t>=e.min}function Zg(){const t=Za();return new Promise(e=>{switch(t){case cr.browser:e(rR());break;case cr.reactNative:e(nR());break;case cr.node:e(sR());break;default:e(!0)}})}function rR(){return Ya()&&(navigator==null?void 0:navigator.onLine)}async function nR(){if(cs()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function sR(){return!0}function iR(t){switch(Za()){case cr.browser:oR(t);break;case cr.reactNative:aR(t);break}}function oR(t){!cs()&&Ya()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function aR(t){cs()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}const Gl={};class bo{static get(e){return Gl[e]}static set(e,r){Gl[e]=r}static delete(e){delete Gl[e]}}const cR="PARSE_ERROR",uR="INVALID_REQUEST",lR="METHOD_NOT_FOUND",dR="INVALID_PARAMS",c0="INTERNAL_ERROR",lf="SERVER_ERROR",hR=[-32700,-32600,-32601,-32602,-32603],Lo={[cR]:{code:-32700,message:"Parse error"},[uR]:{code:-32600,message:"Invalid Request"},[lR]:{code:-32601,message:"Method not found"},[dR]:{code:-32602,message:"Invalid params"},[c0]:{code:-32603,message:"Internal error"},[lf]:{code:-32e3,message:"Server error"}},u0=lf;function fR(t){return hR.includes(t)}function Jg(t){return Object.keys(Lo).includes(t)?Lo[t]:Lo[u0]}function pR(t){const e=Object.values(Lo).find(r=>r.code===t);return e||Lo[u0]}function l0(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var Yl={},yn={},Xg;function gR(){if(Xg)return yn;Xg=1,Object.defineProperty(yn,"__esModule",{value:!0}),yn.isBrowserCryptoAvailable=yn.getSubtleCrypto=yn.getBrowerCrypto=void 0;function t(){return(Xr==null?void 0:Xr.crypto)||(Xr==null?void 0:Xr.msCrypto)||{}}yn.getBrowerCrypto=t;function e(){const n=t();return n.subtle||n.webkitSubtle}yn.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return yn.isBrowserCryptoAvailable=r,yn}var wn={},Qg;function mR(){if(Qg)return wn;Qg=1,Object.defineProperty(wn,"__esModule",{value:!0}),wn.isBrowser=wn.isNode=wn.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}wn.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}wn.isNode=e;function r(){return!t()&&!e()}return wn.isBrowser=r,wn}var em;function yR(){return em||(em=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=za;e.__exportStar(gR(),t),e.__exportStar(mR(),t)}(Yl)),Yl}var wR=yR();function Zr(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Cs(t=6){return BigInt(Zr(t))}function Gn(t,e,r){return{id:r||Zr(),jsonrpc:"2.0",method:t,params:e}}function zu(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Hu(t,e,r){return{id:t,jsonrpc:"2.0",error:bR(e)}}function bR(t,e){return typeof t>"u"?Jg(c0):(typeof t=="string"&&(t=Object.assign(Object.assign({},Jg(lf)),{message:t})),fR(t.code)&&(t=pR(t.code)),t)}let vR=class{},ER=class extends vR{constructor(){super()}},_R=class extends ER{constructor(e){super()}};const CR="^https?:",AR="^wss?:";function IR(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function d0(t,e){const r=IR(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function tm(t){return d0(t,CR)}function rm(t){return d0(t,AR)}function SR(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function h0(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function df(t){return h0(t)&&"method"in t}function Wu(t){return h0(t)&&(Jr(t)||br(t))}function Jr(t){return"result"in t}function br(t){return"error"in t}let Sr=class extends _R{constructor(e){super(e),this.events=new Ar.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Gn(e.method,e.params||[],e.id||Cs().toString()),r)}async requestStrict(e,r){return new Promise(async(n,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{br(i)?s(i.error):n(i.result)});try{await this.connection.send(e,r)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Wu(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const NR=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),TR=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",nm=t=>t.split("?")[0],sm=10,PR=NR();let xR=class{constructor(e){if(this.url=e,this.events=new Ar.EventEmitter,this.registering=!1,!rm(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Pn(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!rm(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,n)=>{const s=wR.isReactNative()?void 0:{rejectUnauthorized:!SR(e)},i=new PR(e,[],s);TR()?i.onerror=o=>{const a=o;n(this.emitError(a.error))}:i.on("error",o=>{n(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),r(i)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?$s(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),s=n.message||n.toString(),i=Hu(e,s);this.events.emit("payload",i)}parseError(e,r=this.url){return l0(e,nm(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>sm&&this.events.setMaxListeners(sm)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${nm(this.url)}`));return this.events.emit("register_error",r),r}};var OR={};const f0="wc",p0=2,nh="core",nn=`${f0}@2:${nh}:`,RR={logger:"error"},$R={database:":memory:"},DR="crypto",im="client_ed25519_seed",kR=W.ONE_DAY,UR="keychain",LR="0.3",MR="messages",BR="0.3",om=W.SIX_HOURS,FR="publisher",g0="irn",jR="error",m0="wss://relay.walletconnect.org",qR="relayer",gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},zR="_subscription",fr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},HR=.1,sh="2.20.2",Ve={link_mode:"link_mode",relay:"relay"},qc={inbound:"inbound",outbound:"outbound"},WR="0.3",VR="WALLETCONNECT_CLIENT_ID",am="WALLETCONNECT_LINK_MODE_APPS",sr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},KR="subscription",GR="0.3",YR="pairing",ZR="0.3",vo={wc_pairingDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:W.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:W.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:W.ONE_DAY,prompt:!1,tag:0},res:{ttl:W.ONE_DAY,prompt:!1,tag:0}}},vs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Pr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},JR="history",XR="0.3",QR="expirer",wr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},e$="0.3",t$="verify-api",r$="https://verify.walletconnect.com",y0="https://verify.walletconnect.org",Mo=y0,n$=`${Mo}/v3`,s$=[r$,y0],i$="echo",o$="https://echo.walletconnect.com",Yr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},vn={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},xr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},ds={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},hs={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Eo={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},a$=.1,c$="event-client",u$=86400,l$="https://pulse.walletconnect.org/batch";function d$(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,w=0,b=p.length;w!==b&&p[w]===0;)w++,g++;for(var v=(b-w)*l+1>>>0,A=new Uint8Array(v);w!==b;){for(var E=p[w],y=0,_=v-1;(E!==0||y<m)&&_!==-1;_--,y++)E+=256*A[_]>>>0,A[_]=E%a>>>0,E=E/a>>>0;if(E!==0)throw new Error("Non-zero carry");m=y,w++}for(var T=v-m;T!==v&&A[T]===0;)T++;for(var S=c.repeat(g);T<v;++T)S+=t.charAt(A[T]);return S}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,w=0;p[g]===c;)m++,g++;for(var b=(p.length-g)*u+1>>>0,v=new Uint8Array(b);p[g];){var A=r[p.charCodeAt(g)];if(A===255)return;for(var E=0,y=b-1;(A!==0||E<w)&&y!==-1;y--,E++)A+=a*v[y]>>>0,v[y]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");w=E,g++}if(p[g]!==" "){for(var _=b-w;_!==b&&v[_]===0;)_++;for(var T=new Uint8Array(m+(b-_)),S=m;_!==b;)T[S++]=v[_++];return T}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var h$=d$,f$=h$;const w0=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},p$=t=>new TextEncoder().encode(t),g$=t=>new TextDecoder().decode(t);class m${constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class y${constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return b0(this,e)}}class w${constructor(e){this.decoders=e}or(e){return b0(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const b0=(t,e)=>new w$({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class b${constructor(e,r,n,s){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new m$(e,r,n),this.decoder=new y$(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Vu=({name:t,prefix:e,encode:r,decode:n})=>new b$(t,e,r,n),rc=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:s}=f$(r,e);return Vu({prefix:t,name:e,encode:n,decode:i=>w0(s(i))})},v$=(t,e,r,n)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|d,a+=r,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},E$=(t,e,r)=>{const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i},Tt=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Vu({prefix:e,name:t,encode(s){return E$(s,n,r)},decode(s){return v$(s,n,r,t)}}),_$=Vu({prefix:"\0",name:"identity",encode:t=>g$(t),decode:t=>p$(t)});var C$=Object.freeze({__proto__:null,identity:_$});const A$=Tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var I$=Object.freeze({__proto__:null,base2:A$});const S$=Tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var N$=Object.freeze({__proto__:null,base8:S$});const T$=rc({prefix:"9",name:"base10",alphabet:"0123456789"});var P$=Object.freeze({__proto__:null,base10:T$});const x$=Tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),O$=Tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var R$=Object.freeze({__proto__:null,base16:x$,base16upper:O$});const $$=Tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),D$=Tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),k$=Tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),U$=Tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),L$=Tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),M$=Tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),B$=Tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),F$=Tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),j$=Tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var q$=Object.freeze({__proto__:null,base32:$$,base32upper:D$,base32pad:k$,base32padupper:U$,base32hex:L$,base32hexupper:M$,base32hexpad:B$,base32hexpadupper:F$,base32z:j$});const z$=rc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),H$=rc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var W$=Object.freeze({__proto__:null,base36:z$,base36upper:H$});const V$=rc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),K$=rc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var G$=Object.freeze({__proto__:null,base58btc:V$,base58flickr:K$});const Y$=Tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Z$=Tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),J$=Tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),X$=Tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Q$=Object.freeze({__proto__:null,base64:Y$,base64pad:Z$,base64url:J$,base64urlpad:X$});const v0=Array.from(""),e3=v0.reduce((t,e,r)=>(t[r]=e,t),[]),t3=v0.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function r3(t){return t.reduce((e,r)=>(e+=e3[r],e),"")}function n3(t){const e=[];for(const r of t){const n=t3[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}const s3=Vu({prefix:"",name:"base256emoji",encode:r3,decode:n3});var i3=Object.freeze({__proto__:null,base256emoji:s3}),o3=E0,cm=128,a3=-128,c3=Math.pow(2,31);function E0(t,e,r){e=e||[],r=r||0;for(var n=r;t>=c3;)e[r++]=t&255|cm,t/=128;for(;t&a3;)e[r++]=t&255|cm,t>>>=7;return e[r]=t|0,E0.bytes=r-n+1,e}var u3=ih,l3=128,um=127;function ih(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw ih.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&um)<<s:(o&um)*Math.pow(2,s),s+=7}while(o>=l3);return ih.bytes=i-n,r}var d3=Math.pow(2,7),h3=Math.pow(2,14),f3=Math.pow(2,21),p3=Math.pow(2,28),g3=Math.pow(2,35),m3=Math.pow(2,42),y3=Math.pow(2,49),w3=Math.pow(2,56),b3=Math.pow(2,63),v3=function(t){return t<d3?1:t<h3?2:t<f3?3:t<p3?4:t<g3?5:t<m3?6:t<y3?7:t<w3?8:t<b3?9:10},E3={encode:o3,decode:u3,encodingLength:v3},_0=E3;const lm=(t,e,r=0)=>(_0.encode(t,e,r),e),dm=t=>_0.encodingLength(t),oh=(t,e)=>{const r=e.byteLength,n=dm(t),s=n+dm(r),i=new Uint8Array(s+r);return lm(t,i,0),lm(r,i,n),i.set(e,s),new _3(t,r,e,i)};class _3{constructor(e,r,n,s){this.code=e,this.size=r,this.digest=n,this.bytes=s}}const C0=({name:t,code:e,encode:r})=>new C3(t,e,r);class C3{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?oh(this.code,r):r.then(n=>oh(this.code,n))}else throw Error("Unknown type, must be binary type")}}const A0=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),A3=C0({name:"sha2-256",code:18,encode:A0("SHA-256")}),I3=C0({name:"sha2-512",code:19,encode:A0("SHA-512")});var S3=Object.freeze({__proto__:null,sha256:A3,sha512:I3});const I0=0,N3="identity",S0=w0,T3=t=>oh(I0,S0(t)),P3={code:I0,name:N3,encode:S0,digest:T3};var x3=Object.freeze({__proto__:null,identity:P3});new TextEncoder,new TextDecoder;const hm={...C$,...I$,...N$,...P$,...R$,...q$,...W$,...G$,...Q$,...i3};({...S3,...x3});function O3(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function N0(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const fm=N0("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Zl=N0("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=O3(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),R3={utf8:fm,"utf-8":fm,hex:hm.base16,latin1:Zl,ascii:Zl,binary:Zl,...hm};function $3(t,e="utf8"){const r=R3[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}var D3=Object.defineProperty,k3=(t,e,r)=>e in t?D3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Kr=(t,e,r)=>k3(t,typeof e!="symbol"?e+"":e,r);class U3{constructor(e,r){this.core=e,this.logger=r,Kr(this,"keychain",new Map),Kr(this,"name",UR),Kr(this,"version",LR),Kr(this,"initialized",!1),Kr(this,"storagePrefix",nn),Kr(this,"init",async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}}),Kr(this,"has",n=>(this.isInitialized(),this.keychain.has(n))),Kr(this,"set",async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()}),Kr(this,"get",n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:i}=V("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(i)}return s}),Kr(this,"del",async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()}),this.core=e,this.logger=$t(r,this.name)}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Wd(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Vd(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var L3=Object.defineProperty,M3=(t,e,r)=>e in t?L3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Et=(t,e,r)=>M3(t,typeof e!="symbol"?e+"":e,r);class B3{constructor(e,r,n){this.core=e,this.logger=r,Et(this,"name",DR),Et(this,"keychain"),Et(this,"randomSessionIdentifier",rh()),Et(this,"initialized",!1),Et(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Et(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Et(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=Fp(s);return kw(i.publicKey)}),Et(this,"generateKeyPair",()=>{this.isInitialized();const s=p2();return this.setPrivateKey(s.publicKey,s.privateKey)}),Et(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=Fp(i),a=this.randomSessionIdentifier;return await iS(a,s,kR,o)}),Et(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=g2(a,i);return this.setSymKey(c,o)}),Et(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||jc(s);return await this.keychain.set(o,s),o}),Et(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Et(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Et(this,"encode",async(s,i,o)=>{this.isInitialized();const a=i0(o),c=Pn(i);if(qg(a))return w2(c,o==null?void 0:o.encoding);if(jg(a)){const h=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(h,f)}const u=this.getSymKey(s),{type:l,senderPublicKey:d}=a;return m2({type:l,symKey:u,message:c,senderPublicKey:d,encoding:o==null?void 0:o.encoding})}),Et(this,"decode",async(s,i,o)=>{this.isInitialized();const a=v2(i,o);if(qg(a)){const c=b2(i,o==null?void 0:o.encoding);return $s(c)}if(jg(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;s=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(s),u=y2({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return $s(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Et(this,"getPayloadType",(s,i=Ur)=>{const o=na({encoded:s,encoding:i});return Bs(o.type)}),Et(this,"getPayloadSenderPublicKey",(s,i=Ur)=>{const o=na({encoded:s,encoding:i});return o.senderPublicKey?Zt(o.senderPublicKey,Mt):void 0}),this.core=e,this.logger=$t(r,this.name),this.keychain=n||new U3(this.core,this.logger)}get context(){return Qt(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(im)}catch{e=rh(),await this.keychain.set(im,e)}return $3(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var F3=Object.defineProperty,j3=Object.defineProperties,q3=Object.getOwnPropertyDescriptors,pm=Object.getOwnPropertySymbols,z3=Object.prototype.hasOwnProperty,H3=Object.prototype.propertyIsEnumerable,ah=(t,e,r)=>e in t?F3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,W3=(t,e)=>{for(var r in e||(e={}))z3.call(e,r)&&ah(t,r,e[r]);if(pm)for(var r of pm(e))H3.call(e,r)&&ah(t,r,e[r]);return t},V3=(t,e)=>j3(t,q3(e)),nr=(t,e,r)=>ah(t,typeof e!="symbol"?e+"":e,r);class K3 extends n1{constructor(e,r){super(e,r),this.logger=e,this.core=r,nr(this,"messages",new Map),nr(this,"messagesWithoutClientAck",new Map),nr(this,"name",MR),nr(this,"version",BR),nr(this,"initialized",!1),nr(this,"storagePrefix",nn),nr(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}}),nr(this,"set",async(n,s,i)=>{this.isInitialized();const o=Qr(s);let a=this.messages.get(n);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(n,a),i===qc.inbound){const c=this.messagesWithoutClientAck.get(n)||{};this.messagesWithoutClientAck.set(n,V3(W3({},c),{[o]:s}))}return await this.persist(),o}),nr(this,"get",n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s}),nr(this,"getWithoutAck",n=>{this.isInitialized();const s={};for(const i of n){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),nr(this,"has",(n,s)=>{this.isInitialized();const i=this.get(n),o=Qr(s);return typeof i[o]<"u"}),nr(this,"ack",async(n,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(n);if(typeof i>"u")return;const o=Qr(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(n):this.messagesWithoutClientAck.set(n,i),await this.persist()}),nr(this,"del",async n=>{this.isInitialized(),this.messages.delete(n),this.messagesWithoutClientAck.delete(n),await this.persist()}),this.logger=$t(e,this.name),this.core=r}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Wd(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Wd(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Vd(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Vd(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var G3=Object.defineProperty,Y3=Object.defineProperties,Z3=Object.getOwnPropertyDescriptors,gm=Object.getOwnPropertySymbols,J3=Object.prototype.hasOwnProperty,X3=Object.prototype.propertyIsEnumerable,ch=(t,e,r)=>e in t?G3(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_c=(t,e)=>{for(var r in e||(e={}))J3.call(e,r)&&ch(t,r,e[r]);if(gm)for(var r of gm(e))X3.call(e,r)&&ch(t,r,e[r]);return t},Jl=(t,e)=>Y3(t,Z3(e)),Or=(t,e,r)=>ch(t,typeof e!="symbol"?e+"":e,r);class Q3 extends s1{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Or(this,"events",new Ar.EventEmitter),Or(this,"name",FR),Or(this,"queue",new Map),Or(this,"publishTimeout",W.toMiliseconds(W.ONE_MINUTE)),Or(this,"initialPublishTimeout",W.toMiliseconds(W.ONE_SECOND*15)),Or(this,"needsTransportRestart",!1),Or(this,"publish",async(n,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||om,c=ou(i),u=(i==null?void 0:i.prompt)||!1,l=(i==null?void 0:i.tag)||0,d=(i==null?void 0:i.id)||Cs().toString(),h={topic:n,message:s,opts:{ttl:a,relay:c,prompt:u,tag:l,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},f=`Failed to publish payload, please try again. id:${d} tag:${l}`;try{const p=new Promise(async g=>{const m=({id:b})=>{h.opts.id===b&&(this.removeRequestFromQueue(b),this.relayer.events.removeListener(gt.publish,m),g(h))};this.relayer.events.on(gt.publish,m);const w=Kn(new Promise((b,v)=>{this.rpcPublish({topic:n,message:s,ttl:a,prompt:u,tag:l,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(b).catch(A=>{this.logger.warn(A,A==null?void 0:A.message),v(A)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${l}`);try{await w,this.events.removeListener(gt.publish,m)}catch(b){this.queue.set(d,Jl(_c({},h),{attempt:1})),this.logger.warn(b,b==null?void 0:b.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:n,message:s,opts:i}}),await Kn(p,this.publishTimeout,f)}catch(p){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(p),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw p}finally{this.queue.delete(d)}}),Or(this,"on",(n,s)=>{this.events.on(n,s)}),Or(this,"once",(n,s)=>{this.events.once(n,s)}),Or(this,"off",(n,s)=>{this.events.off(n,s)}),Or(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.relayer=e,this.logger=$t(r,this.name),this.registerEventListeners()}get context(){return Qt(this.logger)}async rpcPublish(e){var r,n,s,i;const{topic:o,message:a,ttl:c=om,prompt:u,tag:l,id:d,attestation:h,tvf:f}=e,p={method:xo(ou().protocol).publish,params:_c({topic:o,message:a,ttl:c,prompt:u,tag:l,attestation:h},f),id:d};At((r=p.params)==null?void 0:r.prompt)&&((n=p.params)==null||delete n.prompt),At((s=p.params)==null?void 0:s.tag)&&((i=p.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const g=await this.relayer.request(p);return this.relayer.events.emit(gt.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const n=e.attempt+1;this.queue.set(r,Jl(_c({},e),{attempt:n}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${n}`),await this.rpcPublish(Jl(_c({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Zi.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(gt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var eD=Object.defineProperty,tD=(t,e,r)=>e in t?eD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ai=(t,e,r)=>tD(t,typeof e!="symbol"?e+"":e,r);class rD{constructor(){ai(this,"map",new Map),ai(this,"set",(e,r)=>{const n=this.get(e);this.exists(e,r)||this.map.set(e,[...n,r])}),ai(this,"get",e=>this.map.get(e)||[]),ai(this,"exists",(e,r)=>this.get(e).includes(r)),ai(this,"delete",(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const n=this.get(e);if(!this.exists(e,r))return;const s=n.filter(i=>i!==r);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),ai(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var nD=Object.defineProperty,sD=Object.defineProperties,iD=Object.getOwnPropertyDescriptors,mm=Object.getOwnPropertySymbols,oD=Object.prototype.hasOwnProperty,aD=Object.prototype.propertyIsEnumerable,uh=(t,e,r)=>e in t?nD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_o=(t,e)=>{for(var r in e||(e={}))oD.call(e,r)&&uh(t,r,e[r]);if(mm)for(var r of mm(e))aD.call(e,r)&&uh(t,r,e[r]);return t},Xl=(t,e)=>sD(t,iD(e)),Fe=(t,e,r)=>uh(t,typeof e!="symbol"?e+"":e,r);class cD extends a1{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,Fe(this,"subscriptions",new Map),Fe(this,"topicMap",new rD),Fe(this,"events",new Ar.EventEmitter),Fe(this,"name",KR),Fe(this,"version",GR),Fe(this,"pending",new Map),Fe(this,"cached",[]),Fe(this,"initialized",!1),Fe(this,"storagePrefix",nn),Fe(this,"subscribeTimeout",W.toMiliseconds(W.ONE_MINUTE)),Fe(this,"initialSubscribeTimeout",W.toMiliseconds(W.ONE_SECOND*15)),Fe(this,"clientId"),Fe(this,"batchSubscribeTopicsLimit",500),Fe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Fe(this,"subscribe",async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const i=ou(s),o={topic:n,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(n,o);const a=await this.rpcSubscribe(n,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),Fe(this,"unsubscribe",async(n,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)}),Fe(this,"isSubscribed",n=>new Promise(s=>{s(this.topicMap.topics.includes(n))})),Fe(this,"isKnownTopic",n=>new Promise(s=>{s(this.topicMap.topics.includes(n)||this.pending.has(n)||this.cached.some(i=>i.topic===n))})),Fe(this,"on",(n,s)=>{this.events.on(n,s)}),Fe(this,"once",(n,s)=>{this.events.once(n,s)}),Fe(this,"off",(n,s)=>{this.events.off(n,s)}),Fe(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),Fe(this,"start",async()=>{await this.onConnect()}),Fe(this,"stop",async()=>{await this.onDisconnect()}),Fe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Fe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const n=[];this.pending.forEach(s=>{n.push(s)}),await this.batchSubscribe(n)}),Fe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Zi.pulse,async()=>{await this.checkPending()}),this.events.on(sr.created,async n=>{const s=sr.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()}),this.events.on(sr.deleted,async n=>{const s=sr.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:n}),await this.persist()})}),this.relayer=e,this.logger=$t(r,this.name),this.clientId=""}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,r){let n=!1;try{n=this.getSubscription(e).topic===r}catch{}return n}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const n=this.topicMap.get(e);await Promise.all(n.map(async s=>await this.unsubscribeById(e,s,r)))}async unsubscribeById(e,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}});try{const s=ou(n);await this.restartToComplete({topic:e,id:r,relay:s}),await this.rpcUnsubscribe(e,r,s);const i=Me("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,r,n){var s;(!n||(n==null?void 0:n.transportType)===Ve.relay)&&await this.restartToComplete({topic:e,id:e,relay:r});const i={method:xo(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((n==null?void 0:n.transportType)===Ve.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(l=>this.logger.warn(l))},W.toMiliseconds(W.ONE_SECOND)),a;const c=new Promise(async l=>{const d=h=>{h.topic===e&&(this.events.removeListener(sr.created,d),l(h.id))};this.events.on(sr.created,d);try{const h=await Kn(new Promise((f,p)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g==null?void 0:g.message),p(g)}).then(f)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(sr.created,d),l(h)}catch{}}),u=await Kn(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return u?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(gt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,n={method:xo(r.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Kn(new Promise(s=>{this.relayer.request(n).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(gt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,n={method:xo(r.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await Kn(new Promise((i,o)=>{this.relayer.request(n).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(gt.connection_stalled)}return s}rpcUnsubscribe(e,r,n){const s={method:xo(n.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,r){this.setSubscription(e,Xl(_o({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,_o({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,n),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,_o({},r)),this.topicMap.set(r.topic,e),this.events.emit(sr.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const n=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(n.topic,e),this.events.emit(sr.deleted,Xl(_o({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(sr.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let n=0;n<r;n++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(sr.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async r=>Xl(_o({},r),{id:await this.getSubscriptionId(r.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await tx(W.toMiliseconds(W.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Qr(e+await this.getClientId())}}var uD=Object.defineProperty,ym=Object.getOwnPropertySymbols,lD=Object.prototype.hasOwnProperty,dD=Object.prototype.propertyIsEnumerable,lh=(t,e,r)=>e in t?uD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wm=(t,e)=>{for(var r in e||(e={}))lD.call(e,r)&&lh(t,r,e[r]);if(ym)for(var r of ym(e))dD.call(e,r)&&lh(t,r,e[r]);return t},Te=(t,e,r)=>lh(t,typeof e!="symbol"?e+"":e,r);class hD extends i1{constructor(e){super(e),Te(this,"protocol","wc"),Te(this,"version",2),Te(this,"core"),Te(this,"logger"),Te(this,"events",new Ar.EventEmitter),Te(this,"provider"),Te(this,"messages"),Te(this,"subscriber"),Te(this,"publisher"),Te(this,"name",qR),Te(this,"transportExplicitlyClosed",!1),Te(this,"initialized",!1),Te(this,"connectionAttemptInProgress",!1),Te(this,"relayUrl"),Te(this,"projectId"),Te(this,"packageName"),Te(this,"bundleId"),Te(this,"hasExperiencedNetworkDisruption",!1),Te(this,"pingTimeout"),Te(this,"heartBeatTimeout",W.toMiliseconds(W.THIRTY_SECONDS+W.FIVE_SECONDS)),Te(this,"reconnectTimeout"),Te(this,"connectPromise"),Te(this,"reconnectInProgress",!1),Te(this,"requestsInFlight",[]),Te(this,"connectTimeout",W.toMiliseconds(W.ONE_SECOND*15)),Te(this,"request",async r=>{var n,s;this.logger.debug("Publishing Request Payload");const i=r.id||Cs().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:r.method,topic:(n=r.params)==null?void 0:n.topic},"relayer.request - publishing...");const o=`${i}:${((s=r.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Te(this,"resetPingTimeout",()=>{su()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,n,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(n=(r=this.provider)==null?void 0:r.connection)==null?void 0:n.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),Te(this,"onPayloadHandler",r=>{this.onProviderPayload(r),this.resetPingTimeout()}),Te(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(gt.connect)}),Te(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Te(this,"onProviderErrorHandler",r=>{this.logger.fatal(`Fatal socket error: ${r.message}`),this.events.emit(gt.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Te(this,"registerProviderListeners",()=>{this.provider.on(fr.payload,this.onPayloadHandler),this.provider.on(fr.connect,this.onConnectHandler),this.provider.on(fr.disconnect,this.onDisconnectHandler),this.provider.on(fr.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?$t(e.logger,this.name):Wa(Ji({level:e.logger||jR})),this.messages=new K3(this.logger,e.core),this.subscriber=new cD(this,this.logger),this.publisher=new Q3(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||m0,this.projectId=e.projectId,BP()?this.packageName=dg():FP()&&(this.bundleId=dg()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return Qt(this.logger)}get connected(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===1||!1}get connecting(){var e,r,n;return((n=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:n.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,r,n){this.isInitialized(),await this.publisher.publish(e,r,n),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:Ve.relay},qc.outbound)}async subscribe(e,r){var n,s,i;this.isInitialized(),(!(r!=null&&r.transportType)||(r==null?void 0:r.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((n=r==null?void 0:r.internal)==null?void 0:n.throwOnFailedPublish)>"u"?!0:(s=r==null?void 0:r.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const u=l=>{l.topic===e&&(this.subscriber.off(sr.created,u),c())};return await Promise.all([new Promise(l=>{c=l,this.subscriber.on(sr.created,u)}),new Promise(async(l,d)=>{a=await this.subscriber.subscribe(e,wm({internal:{throwOnFailedPublish:o}},r)).catch(h=>{o&&d(h)})||a,l()})]),a}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Kn(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,n)=>{await this.connect(e).then(r).catch(n).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Zg())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const n of r)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:n}=e;if(!r.sessionExists){const s=ot(W.FIVE_MINUTES),i={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,i)}this.events.emit(gt.message,e),await this.recordMessageEvent(e,qc.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(n,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(fr.disconnect,i),await Kn(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(fr.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{a(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(fr.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(fr.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,n()})}catch(n){await this.subscriber.stop();const s=n;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(n=>setTimeout(n,W.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,n,s,i;if(su())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((i=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Sr(new xR(WP({sdkVersion:sh,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,r){const{topic:n,message:s}=e;await this.messages.set(n,s,r)}async shouldIgnoreMessageEvent(e){const{topic:r,message:n}=e;if(!n||n.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isKnownTopic(r))return this.logger.warn(`Ignoring message for unknown topic ${r}`),!0;const s=this.messages.has(r,n);return s&&this.logger.warn(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),df(e)){if(!e.method.endsWith(zR))return;const r=e.params,{topic:n,message:s,publishedAt:i,attestation:o}=r.data,a={topic:n,message:s,publishedAt:i,transportType:Ve.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(wm({type:"event",event:r.id},a)),this.events.emit(r.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Wu(e)&&this.events.emit(gt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,qc.inbound),this.events.emit(gt.message,e))}async acknowledgePayload(e){const r=zu(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(fr.payload,this.onPayloadHandler),this.provider.off(fr.connect,this.onConnectHandler),this.provider.off(fr.disconnect,this.onDisconnectHandler),this.provider.off(fr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Zg();iR(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(n=>this.logger.error(n,n==null?void 0:n.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(gt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},W.toMiliseconds(HR)))))}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function fD(){}function bm(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function vm(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Em(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const pD="[object RegExp]",gD="[object String]",mD="[object Number]",yD="[object Boolean]",_m="[object Arguments]",wD="[object Symbol]",bD="[object Date]",vD="[object Map]",ED="[object Set]",_D="[object Array]",CD="[object Function]",AD="[object ArrayBuffer]",Ql="[object Object]",ID="[object Error]",SD="[object DataView]",ND="[object Uint8Array]",TD="[object Uint8ClampedArray]",PD="[object Uint16Array]",xD="[object Uint32Array]",OD="[object BigUint64Array]",RD="[object Int8Array]",$D="[object Int16Array]",DD="[object Int32Array]",kD="[object BigInt64Array]",UD="[object Float32Array]",LD="[object Float64Array]";function MD(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function BD(t,e,r){return Ro(t,e,void 0,void 0,void 0,void 0,r)}function Ro(t,e,r,n,s,i,o){const a=o(t,e,r,n,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Bo(t,e,i,o)}return Bo(t,e,i,o)}function Bo(t,e,r,n){if(Object.is(t,e))return!0;let s=Em(t),i=Em(e);if(s===_m&&(s=Ql),i===_m&&(i=Ql),s!==i)return!1;switch(s){case gD:return t.toString()===e.toString();case mD:{const c=t.valueOf(),u=e.valueOf();return MD(c,u)}case yD:case bD:case wD:return Object.is(t.valueOf(),e.valueOf());case pD:return t.source===e.source&&t.flags===e.flags;case CD:return t===e}r=r??new Map;const o=r.get(t),a=r.get(e);if(o!=null&&a!=null)return o===e;r.set(t,e),r.set(e,t);try{switch(s){case vD:{if(t.size!==e.size)return!1;for(const[c,u]of t.entries())if(!e.has(c)||!Ro(u,e.get(c),c,t,e,r,n))return!1;return!0}case ED:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),u=Array.from(e.values());for(let l=0;l<c.length;l++){const d=c[l],h=u.findIndex(f=>Ro(d,f,void 0,t,e,r,n));if(h===-1)return!1;u.splice(h,1)}return!0}case _D:case ND:case TD:case PD:case xD:case OD:case RD:case $D:case DD:case kD:case UD:case LD:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!Ro(t[c],e[c],c,t,e,r,n))return!1;return!0}case AD:return t.byteLength!==e.byteLength?!1:Bo(new Uint8Array(t),new Uint8Array(e),r,n);case SD:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Bo(new Uint8Array(t),new Uint8Array(e),r,n);case ID:return t.name===e.name&&t.message===e.message;case Ql:{if(!(Bo(t.constructor,e.constructor,r,n)||bm(t)&&bm(e)))return!1;const c=[...Object.keys(t),...vm(t)],u=[...Object.keys(e),...vm(e)];if(c.length!==u.length)return!1;for(let l=0;l<c.length;l++){const d=c[l],h=t[d];if(!Object.hasOwn(e,d))return!1;const f=e[d];if(!Ro(h,f,d,t,e,r,n))return!1}return!0}default:return!1}}finally{r.delete(t),r.delete(e)}}function FD(t,e){return BD(t,e,fD)}var jD=Object.defineProperty,Cm=Object.getOwnPropertySymbols,qD=Object.prototype.hasOwnProperty,zD=Object.prototype.propertyIsEnumerable,dh=(t,e,r)=>e in t?jD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Am=(t,e)=>{for(var r in e||(e={}))qD.call(e,r)&&dh(t,r,e[r]);if(Cm)for(var r of Cm(e))zD.call(e,r)&&dh(t,r,e[r]);return t},qt=(t,e,r)=>dh(t,typeof e!="symbol"?e+"":e,r);class Xs extends o1{constructor(e,r,n,s=nn,i=void 0){super(e,r,n,s),this.core=e,this.logger=r,this.name=n,qt(this,"map",new Map),qt(this,"version",WR),qt(this,"cached",[]),qt(this,"initialized",!1),qt(this,"getKey"),qt(this,"storagePrefix",nn),qt(this,"recentlyDeleted",[]),qt(this,"recentlyDeletedLimit",200),qt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!At(o)?this.map.set(this.getKey(o),o):U2(o)?this.map.set(o.id,o):L2(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),qt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),qt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),qt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>FD(a[c],o[c]))):this.values)),qt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Am(Am({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),qt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=$t(r,this.name),this.storagePrefix=s,this.getKey=i}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:s}=V("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var HD=Object.defineProperty,WD=(t,e,r)=>e in t?HD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_e=(t,e,r)=>WD(t,typeof e!="symbol"?e+"":e,r);class VD{constructor(e,r){this.core=e,this.logger=r,_e(this,"name",YR),_e(this,"version",ZR),_e(this,"events",new qh),_e(this,"pairings"),_e(this,"initialized",!1),_e(this,"storagePrefix",nn),_e(this,"ignoredPayloadTypes",[Sn]),_e(this,"registeredMethods",[]),_e(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),_e(this,"register",({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]}),_e(this,"create",async n=>{this.isInitialized();const s=rh(),i=await this.core.crypto.setSymKey(s),o=ot(W.FIVE_MINUTES),a={protocol:g0},c={topic:i,expiry:o,relay:a,active:!1,methods:n==null?void 0:n.methods},u=Hg({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:n==null?void 0:n.methods});return this.events.emit(vs.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:n==null?void 0:n.transportType}),{topic:i,uri:u}}),_e(this,"pair",async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[Yr.pairing_started]}});this.isValidPair(n,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:u}=zg(n.uri);s.props.properties.topic=i,s.addTrace(Yr.pairing_uri_validation_success),s.addTrace(Yr.pairing_uri_not_expired);let l;if(this.pairings.keys.includes(i)){if(l=this.pairings.get(i),s.addTrace(Yr.existing_pairing),l.active)throw s.setError(vn.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Yr.pairing_not_expired)}const d=c||ot(W.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:u};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(Yr.store_new_pairing),n.activatePairing&&await this.activate({topic:i}),this.events.emit(vs.create,h),s.addTrace(Yr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Yr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(vn.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(vn.subscribe_pairing_topic_failure),f}return s.addTrace(Yr.subscribe_pairing_topic_success),h}),_e(this,"activate",async({topic:n})=>{this.isInitialized();const s=ot(W.FIVE_MINUTES);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})}),_e(this,"ping",async n=>{this.isInitialized(),await this.isValidPing(n),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=n;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=ms();this.events.once($e("pairing_ping",i),({error:u})=>{u?c(u):a()}),await o()}}),_e(this,"updateExpiry",async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})}),_e(this,"updateMetadata",async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})}),_e(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),_e(this,"disconnect",async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Me("USER_DISCONNECTED")),await this.deletePairing(s))}),_e(this,"formatUriFromPairing",n=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=n,c=this.core.crypto.keychain.get(s);return Hg({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),_e(this,"sendRequest",async(n,s,i)=>{const o=Gn(s,i),a=await this.core.crypto.encode(n,o),c=vo[s].req;return this.core.history.set(n,o),this.core.relayer.publish(n,a,c),o.id}),_e(this,"sendResult",async(n,s,i)=>{const o=zu(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,u=vo[c].res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),_e(this,"sendError",async(n,s,i)=>{const o=Hu(n,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,n)).request.method,u=vo[c]?vo[c].res:vo.unregistered_method.res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),_e(this,"deletePairing",async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Me("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])}),_e(this,"cleanup",async()=>{const n=this.pairings.getAll().filter(s=>qn(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))}),_e(this,"onRelayEventRequest",async n=>{const{topic:s,payload:i}=n;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),_e(this,"onRelayEventResponse",async n=>{const{topic:s,payload:i}=n,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),_e(this,"onPairingPingRequest",async(n,s)=>{const{id:i}=s;try{this.isValidPing({topic:n}),await this.sendResult(i,n,!0),this.events.emit(vs.ping,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),_e(this,"onPairingPingResponse",(n,s)=>{const{id:i}=s;setTimeout(()=>{Jr(s)?this.events.emit($e("pairing_ping",i),{}):br(s)&&this.events.emit($e("pairing_ping",i),{error:s.error})},500)}),_e(this,"onPairingDeleteRequest",async(n,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(vs.delete,{id:i,topic:n})}catch(o){await this.sendError(i,n,o),this.logger.error(o)}}),_e(this,"onUnknownRpcMethodRequest",async(n,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=Me("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,n,a),this.logger.error(a)}catch(a){await this.sendError(i,n,a),this.logger.error(a)}}),_e(this,"onUnknownRpcMethodResponse",n=>{this.registeredMethods.includes(n)||this.logger.error(Me("WC_METHOD_UNSUPPORTED",n))}),_e(this,"isValidPair",(n,s)=>{var i;if(!Kt(n)){const{message:a}=V("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(vn.malformed_pairing_uri),new Error(a)}if(!k2(n.uri)){const{message:a}=V("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(vn.malformed_pairing_uri),new Error(a)}const o=zg(n==null?void 0:n.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=V("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(vn.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=V("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(vn.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&W.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(vn.pairing_expired);const{message:a}=V("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),_e(this,"isValidPing",async n=>{if(!Kt(n)){const{message:i}=V("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),_e(this,"isValidDisconnect",async n=>{if(!Kt(n)){const{message:i}=V("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(i)}const{topic:s}=n;await this.isValidPairingTopic(s)}),_e(this,"isValidPairingTopic",async n=>{if(!nt(n,!1)){const{message:s}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(qn(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=V("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}}),this.core=e,this.logger=$t(r,this.name),this.pairings=new Xs(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Qt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(gt.message,async e=>{const{topic:r,message:n,transportType:s}=e;if(this.pairings.keys.includes(r)&&s!==Ve.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))try{const i=await this.core.crypto.decode(r,n);df(i)?(this.core.history.set(r,i),await this.onRelayEventRequest({topic:r,payload:i})):Wu(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:r,payload:i}),this.core.history.delete(r,i.id)),await this.core.relayer.messages.ack(r,n)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(wr.expired,async e=>{const{topic:r}=Sb(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(vs.expire,{topic:r}))})}}var KD=Object.defineProperty,GD=(t,e,r)=>e in t?KD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_t=(t,e,r)=>GD(t,typeof e!="symbol"?e+"":e,r);class YD extends r1{constructor(e,r){super(e,r),this.core=e,this.logger=r,_t(this,"records",new Map),_t(this,"events",new Ar.EventEmitter),_t(this,"name",JR),_t(this,"version",XR),_t(this,"cached",[]),_t(this,"initialized",!1),_t(this,"storagePrefix",nn),_t(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),_t(this,"set",(n,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:i,expiry:ot(W.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Pr.created,o)}),_t(this,"resolve",async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=br(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(Pr.updated,s))}),_t(this,"get",async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s))),_t(this,"delete",(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===n){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Pr.deleted,i)}}),this.persist()}),_t(this,"exists",async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1)),_t(this,"on",(n,s)=>{this.events.on(n,s)}),_t(this,"once",(n,s)=>{this.events.once(n,s)}),_t(this,"off",(n,s)=>{this.events.off(n,s)}),_t(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=$t(r,this.name)}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:Gn(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(n)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Pr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Pr.created,e=>{const r=Pr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Pr.updated,e=>{const r=Pr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(Pr.deleted,e=>{const r=Pr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(Zi.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{W.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(Pr.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ZD=Object.defineProperty,JD=(t,e,r)=>e in t?ZD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,xt=(t,e,r)=>JD(t,typeof e!="symbol"?e+"":e,r);class XD extends c1{constructor(e,r){super(e,r),this.core=e,this.logger=r,xt(this,"expirations",new Map),xt(this,"events",new Ar.EventEmitter),xt(this,"name",QR),xt(this,"version",e$),xt(this,"cached",[]),xt(this,"initialized",!1),xt(this,"storagePrefix",nn),xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),xt(this,"has",n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}}),xt(this,"set",(n,s)=>{this.isInitialized();const i=this.formatTarget(n),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(wr.created,{target:i,expiration:o})}),xt(this,"get",n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)}),xt(this,"del",n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(wr.deleted,{target:s,expiration:i})}}),xt(this,"on",(n,s)=>{this.events.on(n,s)}),xt(this,"once",(n,s)=>{this.events.once(n,s)}),xt(this,"off",(n,s)=>{this.events.off(n,s)}),xt(this,"removeListener",(n,s)=>{this.events.removeListener(n,s)}),this.logger=$t(r,this.name)}get context(){return Qt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return VP(e);if(typeof e=="number")return KP(e);const{message:r}=V("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(wr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=V("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:n}=V("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(n),new Error(n)}return r}checkExpiry(e,r){const{expiry:n}=r;W.toMiliseconds(n)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(wr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(Zi.pulse,()=>this.checkExpirations()),this.events.on(wr.created,e=>{const r=wr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(wr.expired,e=>{const r=wr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(wr.deleted,e=>{const r=wr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}}var QD=Object.defineProperty,ek=(t,e,r)=>e in t?QD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,rt=(t,e,r)=>ek(t,typeof e!="symbol"?e+"":e,r);class tk extends u1{constructor(e,r,n){super(e,r,n),this.core=e,this.logger=r,this.store=n,rt(this,"name",t$),rt(this,"abortController"),rt(this,"isDevEnv"),rt(this,"verifyUrlV3",n$),rt(this,"storagePrefix",nn),rt(this,"version",p0),rt(this,"publicKey"),rt(this,"fetchPromise"),rt(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&W.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),rt(this,"register",async s=>{if(!Ya()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const u=Ds.getDocument(),l=this.startAbortTimer(W.ONE_SECOND*5),d=await new Promise((h,f)=>{const p=()=>{window.removeEventListener("message",m),u.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=u.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=w=>{if(w.data&&typeof w.data=="string")try{const b=JSON.parse(w.data);if(b.type==="verify_attestation"){if(Md(b.attestation).payload.id!==o)return;clearInterval(l),u.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),h(b.attestation===null?"":b.attestation)}}catch(b){this.logger.warn(b)}};u.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(u){this.logger.warn(u)}return""}),rt(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Md(i).payload.id!==a)return;const u=await this.isValidJwtAttestation(i);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),rt(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(W.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),rt(this,"getVerifyUrl",s=>{let i=s||Mo;return s$.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Mo}`),i=Mo),i}),rt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(W.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),rt(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),rt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),rt(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),rt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),rt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),rt(this,"validateAttestation",(s,i)=>{const o=_2(s,i.publicKey),a={hasExpired:W.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=$t(r,this.name),this.abortController=new AbortController,this.isDevEnv=ef(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Qt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),W.toMiliseconds(e))}}var rk=Object.defineProperty,nk=(t,e,r)=>e in t?rk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Im=(t,e,r)=>nk(t,typeof e!="symbol"?e+"":e,r);class sk extends l1{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,Im(this,"context",i$),Im(this,"registerDeviceToken",async n=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=n,c=`${o$}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=$t(r,this.context)}}var ik=Object.defineProperty,Sm=Object.getOwnPropertySymbols,ok=Object.prototype.hasOwnProperty,ak=Object.prototype.propertyIsEnumerable,hh=(t,e,r)=>e in t?ik(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Co=(t,e)=>{for(var r in e||(e={}))ok.call(e,r)&&hh(t,r,e[r]);if(Sm)for(var r of Sm(e))ak.call(e,r)&&hh(t,r,e[r]);return t},lt=(t,e,r)=>hh(t,typeof e!="symbol"?e+"":e,r);class ck extends d1{constructor(e,r,n=!0){super(e,r,n),this.core=e,this.logger=r,lt(this,"context",c$),lt(this,"storagePrefix",nn),lt(this,"storageVersion",a$),lt(this,"events",new Map),lt(this,"shouldPersist",!1),lt(this,"init",async()=>{if(!ef())try{const s={eventId:fg(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:Ab(this.core.relayer.protocol,this.core.relayer.version,sh)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),lt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,u=fg(),l=this.core.projectId||"",d=Date.now(),h=Co({eventId:u,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:l,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,h),this.shouldPersist=!0),h}),lt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Co(Co({},a),this.setMethods(a.eventId))}),lt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),lt(this,"setEventListeners",()=>{this.core.heartbeat.on(Zi.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{W.fromMiliseconds(Date.now())-W.fromMiliseconds(s.timestamp)>u$&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),lt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),lt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),lt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),lt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),lt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,Co(Co({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),lt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),lt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${l$}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${sh}${i}`,{method:"POST",body:JSON.stringify(s)})}),lt(this,"getAppDomain",()=>Cb().url),this.logger=$t(r,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var uk=Object.defineProperty,Nm=Object.getOwnPropertySymbols,lk=Object.prototype.hasOwnProperty,dk=Object.prototype.propertyIsEnumerable,fh=(t,e,r)=>e in t?uk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tm=(t,e)=>{for(var r in e||(e={}))lk.call(e,r)&&fh(t,r,e[r]);if(Nm)for(var r of Nm(e))dk.call(e,r)&&fh(t,r,e[r]);return t},He=(t,e,r)=>fh(t,typeof e!="symbol"?e+"":e,r);let hk=class T0 extends XC{constructor(e){var r;super(e),He(this,"protocol",f0),He(this,"version",p0),He(this,"name",nh),He(this,"relayUrl"),He(this,"projectId"),He(this,"customStoragePrefix"),He(this,"events",new Ar.EventEmitter),He(this,"logger"),He(this,"heartbeat"),He(this,"relayer"),He(this,"crypto"),He(this,"storage"),He(this,"history"),He(this,"expirer"),He(this,"pairing"),He(this,"verify"),He(this,"echoClient"),He(this,"linkModeSupportedApps"),He(this,"eventClient"),He(this,"initialized",!1),He(this,"logChunkController"),He(this,"on",(a,c)=>this.events.on(a,c)),He(this,"once",(a,c)=>this.events.once(a,c)),He(this,"off",(a,c)=>this.events.off(a,c)),He(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),He(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:u})=>{if(!a||!c)return;const l={topic:a,message:c,publishedAt:Date.now(),transportType:Ve.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:u})});const n=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(n)try{return this.customStoragePrefix=n.customStoragePrefix,this.logger=n.logger,this.heartbeat=n.heartbeat,this.crypto=n.crypto,this.history=n.history,this.expirer=n.expirer,this.storage=n.storage,this.relayer=n.relayer,this.pairing=n.pairing,this.verify=n.verify,this.echoClient=n.echoClient,this.linkModeSupportedApps=n.linkModeSupportedApps,this.eventClient=n.eventClient,this.initialized=n.initialized,this.logChunkController=n.logChunkController,n}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||m0,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Ji({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:RR.logger,name:nh}),{logger:i,chunkLoggerController:o}=Hh({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=$t(i,this.name),this.heartbeat=new J_,this.crypto=new B3(this,this.logger,e==null?void 0:e.keychain),this.history=new YD(this,this.logger),this.expirer=new XD(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new $C(Tm(Tm({},$R),e==null?void 0:e.storageOptions)),this.relayer=new hD({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new VD(this,this.logger),this.verify=new tk(this,this.logger,this.storage),this.echoClient=new sk(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new ck(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const r=new T0(e);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(VR,n),r}get context(){return Qt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(am,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(am)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${e}`,n=`${r}_count`;return globalThis[n]=(globalThis[n]||0)+1,globalThis[n]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[n]} times.`),globalThis[r]}catch(r){console.warn("Failed to get global WalletConnect core",r);return}}setGlobalCore(e){var r;try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${((r=e.opts)==null?void 0:r.customStoragePrefix)||""}`;globalThis[n]=e}catch(n){console.warn("Failed to set global WalletConnect core",n)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&OR.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const fk=hk,P0="wc",x0=2,O0="client",hf=`${P0}@${x0}:${O0}:`,ed={name:O0,logger:"error"},Pm="WALLETCONNECT_DEEPLINK_CHOICE",pk="proposal",xm="Proposal expired",gk="session",ci=W.SEVEN_DAYS,mk="engine",dt={wc_sessionPropose:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1104},res:{ttl:W.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1106},res:{ttl:W.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:W.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1112},res:{ttl:W.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:W.ONE_DAY,prompt:!1,tag:1114},res:{ttl:W.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:W.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:W.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:W.FIVE_MINUTES,prompt:!1,tag:1119}}},td={min:W.FIVE_MINUTES,max:W.SEVEN_DAYS},Gr={idle:"IDLE",active:"ACTIVE"},Om={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},yk="request",wk=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],bk="wc",vk="auth",Ek="authKeys",_k="pairingTopics",Ck="requests",Ku=`${bk}@${1.5}:${vk}:`,zc=`${Ku}:PUB_KEY`;var Ak=Object.defineProperty,Ik=Object.defineProperties,Sk=Object.getOwnPropertyDescriptors,Rm=Object.getOwnPropertySymbols,Nk=Object.prototype.hasOwnProperty,Tk=Object.prototype.propertyIsEnumerable,ph=(t,e,r)=>e in t?Ak(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,je=(t,e)=>{for(var r in e||(e={}))Nk.call(e,r)&&ph(t,r,e[r]);if(Rm)for(var r of Rm(e))Tk.call(e,r)&&ph(t,r,e[r]);return t},kt=(t,e)=>Ik(t,Sk(e)),B=(t,e,r)=>ph(t,typeof e!="symbol"?e+"":e,r);class Pk extends g1{constructor(e){super(e),B(this,"name",mk),B(this,"events",new qh),B(this,"initialized",!1),B(this,"requestQueue",{state:Gr.idle,queue:[]}),B(this,"sessionRequestQueue",{state:Gr.idle,queue:[]}),B(this,"requestQueueDelay",W.ONE_SECOND),B(this,"expectedPairingMethodMap",new Map),B(this,"recentlyDeletedMap",new Map),B(this,"recentlyDeletedLimit",200),B(this,"relayMessageCache",[]),B(this,"pendingSessions",new Map),B(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(dt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},W.toMiliseconds(this.requestQueueDelay)))}),B(this,"connect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=kt(je({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:u}=n;let l=s,d,h=!1;try{if(l){const y=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=y.active}}catch(y){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),y}if(!l||!h){const{topic:y,uri:_}=await this.client.core.pairing.create();l=y,d=_}if(!l){const{message:y}=V("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(y)}const f=await this.client.core.crypto.generateKeyPair(),p=dt.wc_sessionPropose.req.ttl||W.FIVE_MINUTES,g=ot(p),m=kt(je(je({requiredNamespaces:i,optionalNamespaces:o,relays:u??[{protocol:g0}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:l},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Zr()}),w=$e("session_connect",m.id),{reject:b,resolve:v,done:A}=ms(p,xm),E=({id:y})=>{y===m.id&&(this.client.events.off("proposal_expire",E),this.pendingSessions.delete(m.id),this.events.emit(w,{error:{message:xm,code:0}}))};return this.client.events.on("proposal_expire",E),this.events.once(w,({error:y,session:_})=>{this.client.events.off("proposal_expire",E),y?b(y):_&&v(_)}),await this.sendRequest({topic:l,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:d,approval:A}}),B(this,"pair",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(n){throw this.client.logger.error("pair() failed"),n}}),B(this,"approve",async r=>{var n,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(n=r==null?void 0:r.id)==null?void 0:n.toString(),trace:[xr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(S){throw o.setError(ds.no_internet_connection),S}try{await this.isValidProposalId(r==null?void 0:r.id)}catch(S){throw this.client.logger.error(`approve() -> proposal.get(${r==null?void 0:r.id}) failed`),o.setError(ds.proposal_not_found),S}try{await this.isValidApprove(r)}catch(S){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(ds.session_approve_namespace_validation_failure),S}const{id:a,relayProtocol:c,namespaces:u,sessionProperties:l,scopedProperties:d,sessionConfig:h}=r,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:w}=f;let b=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});b||(b=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:xr.session_approve_started,properties:{topic:p,trace:[xr.session_approve_started,xr.session_namespaces_validation_success]}}));const v=await this.client.core.crypto.generateKeyPair(),A=g.publicKey,E=await this.client.core.crypto.generateSharedKey(v,A),y=je(je(je({relay:{protocol:c??"irn"},namespaces:u,controller:{publicKey:v,metadata:this.client.metadata},expiry:ot(ci)},l&&{sessionProperties:l}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),_=Ve.relay;b.addTrace(xr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(E,{transportType:_})}catch(S){throw b.setError(ds.subscribe_session_topic_failure),S}b.addTrace(xr.subscribe_session_topic_success);const T=kt(je({},y),{topic:E,requiredNamespaces:m,optionalNamespaces:w,pairingTopic:p,acknowledged:!1,self:y.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:v,transportType:Ve.relay});await this.client.session.set(E,T),b.addTrace(xr.store_session);try{b.addTrace(xr.publishing_session_settle),await this.sendRequest({topic:E,method:"wc_sessionSettle",params:y,throwOnFailedPublish:!0}).catch(S=>{throw b==null||b.setError(ds.session_settle_publish_failure),S}),b.addTrace(xr.session_settle_publish_success),b.addTrace(xr.publishing_session_approve),await this.sendResult({id:a,topic:p,result:{relay:{protocol:c??"irn"},responderPublicKey:v},throwOnFailedPublish:!0}).catch(S=>{throw b==null||b.setError(ds.session_approve_publish_failure),S}),b.addTrace(xr.session_approve_publish_success)}catch(S){throw this.client.logger.error(S),this.client.session.delete(E,Me("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(E),S}return this.client.core.eventClient.deleteEvent({eventId:b.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.client.proposal.delete(a,Me("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(E,ot(ci)),{topic:E,acknowledged:()=>Promise.resolve(this.client.session.get(E))}}),B(this,"reject",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:n,reason:s}=r;let i;try{i=this.client.proposal.get(n).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),o}i&&(await this.sendError({id:n,topic:i,error:s,rpcOpts:dt.wc_sessionPropose.reject}),await this.client.proposal.delete(n,Me("USER_DISCONNECTED")))}),B(this,"update",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:n,namespaces:s}=r,{done:i,resolve:o,reject:a}=ms(),c=Zr(),u=Cs().toString(),l=this.client.session.get(n).namespaces;return this.events.once($e("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:u}).catch(d=>{this.client.logger.error(d),this.client.session.update(n,{namespaces:l}),a(d)}),{acknowledged:i}}),B(this,"extend",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:n}=r,s=Zr(),{done:i,resolve:o,reject:a}=ms();return this.events.once($e("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(n,ot(ci)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),B(this,"request",async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:n,request:s,topic:i,expiry:o=dt.wc_sessionRequest.req.ttl}=r,a=this.client.session.get(i);(a==null?void 0:a.transportType)===Ve.relay&&await this.confirmOnlineStateOrThrow();const c=Zr(),u=Cs().toString(),{done:l,resolve:d,reject:h}=ms(o,"Request expired. Please try again.");this.events.once($e("session_request",c),({error:w,result:b})=>{w?h(w):d(b)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:i,method:f,params:{request:kt(je({},s),{expiryTimestamp:ot(o)}),chainId:n},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(w=>h(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),await l();const g={request:kt(je({},s),{expiryTimestamp:ot(o)}),chainId:n},m=this.shouldSetTVF(f,g);return await Promise.all([new Promise(async w=>{await this.sendRequest(je({clientRpcId:c,relayRpcId:u,topic:i,method:f,params:g,expiry:o,throwOnFailedPublish:!0},m&&{tvf:this.getTVFParams(c,g)})).catch(b=>h(b)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:n,id:c}),w()}),new Promise(async w=>{var b;if(!((b=a.sessionConfig)!=null&&b.disableDeepLink)){const v=await JP(this.client.core.storage,Pm);await GP({id:c,topic:i,wcDeepLink:v})}w()}),l()]).then(w=>w[2])}),B(this,"respond",async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:s}=r,{id:i}=s,o=this.client.session.get(n);o.transportType===Ve.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Jr(s)?await this.sendResult({id:i,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:a}):br(s)&&await this.sendError({id:i,topic:n,error:s.error,appLink:a}),this.cleanupAfterResponse(r)}),B(this,"ping",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=r;if(this.client.session.keys.includes(n)){const s=Zr(),i=Cs().toString(),{done:o,resolve:a,reject:c}=ms();this.events.once($e("session_ping",s),({error:u})=>{u?c(u):a()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(n)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:n}))}),B(this,"emit",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:n,event:s,chainId:i}=r,o=Cs().toString(),a=Zr();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),B(this,"disconnect",async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:n}=r;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:Me("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=V("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}}),B(this,"find",r=>(this.isInitialized(),this.client.session.getAll().filter(n=>$2(n,r)))),B(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),B(this,"authenticate",async(r,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(r);const i=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Ve.link_mode:Ve.relay;o===Ve.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:u,domain:l,nonce:d,type:h,exp:f,nbf:p,methods:g=[],expiry:m}=r,w=[...r.resources||[]],{topic:b,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:b,uri:v}});const A=await this.client.core.crypto.generateKeyPair(),E=jc(A);if(await Promise.all([this.client.auth.authKeys.set(zc,{responseTopic:E,publicKey:A}),this.client.auth.pairingTopics.set(E,{topic:E,pairingTopic:b})]),await this.client.core.relayer.subscribe(E,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${b}`),g.length>0){const{namespace:D}=Ni(a[0]);let U=zx(D,"request",g);Fc(w)&&(U=Wx(U,w.pop())),w.push(U)}const y=m&&m>dt.wc_sessionAuthenticate.req.ttl?m:dt.wc_sessionAuthenticate.req.ttl,_={authPayload:{type:h??"caip122",chains:a,statement:c,aud:u,domain:l,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:w},requester:{publicKey:A,metadata:this.client.metadata},expiryTimestamp:ot(y)},T={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},S={requiredNamespaces:{},optionalNamespaces:T,relays:[{protocol:"irn"}],pairingTopic:b,proposer:{publicKey:A,metadata:this.client.metadata},expiryTimestamp:ot(dt.wc_sessionPropose.req.ttl),id:Zr()},{done:x,resolve:O,reject:L}=ms(y,"Request expired"),M=Zr(),R=$e("session_connect",S.id),I=$e("session_request",M),N=async({error:D,session:U})=>{this.events.off(I,$),D?L(D):U&&O({session:U})},$=async D=>{var U,H,G;if(await this.deletePendingAuthRequest(M,{message:"fulfilled",code:0}),D.error){const Ie=Me("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return D.error.code===Ie.code?void 0:(this.events.off(R,N),L(D.error.message))}await this.deleteProposal(S.id),this.events.off(R,N);const{cacaos:se,responder:K}=D.result,ie=[],ge=[];for(const Ie of se){await Eg({cacao:Ie,projectId:this.client.core.projectId})||(this.client.logger.error(Ie,"Signature verification failed"),L(Me("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:Pt}=Ie,bt=Fc(Pt.resources),Dt=[Kd(Pt.iss)],dr=iu(Pt.iss);if(bt){const hr=_g(bt),ei=Cg(bt);ie.push(...hr),Dt.push(...ei)}for(const hr of Dt)ge.push(`${hr}:${dr}`)}const ze=await this.client.core.crypto.generateSharedKey(A,K.publicKey);let De;ie.length>0&&(De={topic:ze,acknowledged:!0,self:{publicKey:A,metadata:this.client.metadata},peer:K,controller:K.publicKey,expiry:ot(ci),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:b,namespaces:Wg([...new Set(ie)],[...new Set(ge)]),transportType:o},await this.client.core.relayer.subscribe(ze,{transportType:o}),await this.client.session.set(ze,De),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:K.metadata}),De=this.client.session.get(ze)),(U=this.client.metadata.redirect)!=null&&U.linkMode&&(H=K.metadata.redirect)!=null&&H.linkMode&&(G=K.metadata.redirect)!=null&&G.universal&&n&&(this.client.core.addLinkModeSupportedApp(K.metadata.redirect.universal),this.client.session.update(ze,{transportType:Ve.link_mode})),O({auths:se,session:De})};this.events.once(R,N),this.events.once(I,$);let k;try{if(i){const D=Gn("wc_sessionAuthenticate",_,M);this.client.core.history.set(b,D);const U=await this.client.core.crypto.encode("",D,{type:tc,encoding:Hn});k=Ec(n,b,U)}else await Promise.all([this.sendRequest({topic:b,method:"wc_sessionAuthenticate",params:_,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:M}),this.sendRequest({topic:b,method:"wc_sessionPropose",params:S,expiry:dt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(D){throw this.events.off(R,N),this.events.off(I,$),D}return await this.setProposal(S.id,S),await this.setAuthRequest(M,{request:kt(je({},_),{verifyContext:{}}),pairingTopic:b,transportType:o}),{uri:k??v,response:x}}),B(this,"approveSessionAuthenticate",async r=>{const{id:n,auths:s}=r,i=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[hs.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(Eo.no_internet_connection),m}const o=this.getPendingAuthRequest(n);if(!o)throw i.setError(Eo.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const a=o.transportType||Ve.relay;a===Ve.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),l=jc(c),d={type:Sn,receiverPublicKey:c,senderPublicKey:u},h=[],f=[];for(const m of s){if(!await Eg({cacao:m,projectId:this.client.core.projectId})){i.setError(Eo.invalid_cacao);const E=Me("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:l,error:E,encodeOpts:d}),new Error(E.message)}i.addTrace(hs.cacaos_verified);const{p:w}=m,b=Fc(w.resources),v=[Kd(w.iss)],A=iu(w.iss);if(b){const E=_g(b),y=Cg(b);h.push(...E),v.push(...y)}for(const E of v)f.push(`${E}:${A}`)}const p=await this.client.core.crypto.generateSharedKey(u,c);i.addTrace(hs.create_authenticated_session_topic);let g;if((h==null?void 0:h.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:ot(ci),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Wg([...new Set(h)],[...new Set(f)]),transportType:a},i.addTrace(hs.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(Eo.subscribe_authenticated_session_topic_failure),m}i.addTrace(hs.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(hs.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(hs.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:n,result:{cacaos:s,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(Eo.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),B(this,"rejectSessionAuthenticate",async r=>{this.isInitialized();const{id:n,reason:s}=r,i=this.getPendingAuthRequest(n);if(!i)throw new Error(`Could not find pending auth request with id ${n}`);i.transportType===Ve.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=jc(o),u={type:Sn,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:n,topic:c,error:s,encodeOpts:u,rpcOpts:dt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,Me("USER_DISCONNECTED"))}),B(this,"formatAuthMessage",r=>{this.isInitialized();const{request:n,iss:s}=r;return kb(n,s)}),B(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)}),B(this,"cleanupDuplicatePairings",async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===r.peer.metadata.url&&i.topic&&i.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}}),B(this,"deleteSession",async r=>{var n;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=r,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Me("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Pm).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===s&&this.deletePendingSessionRequest(u.id,Me("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=Gr.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),B(this,"deleteProposal",async(r,n)=>{if(n)try{const s=this.client.proposal.get(r),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(ds.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,Me("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")}),B(this,"deletePendingSessionRequest",async(r,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==r),s&&(this.sessionRequestQueue.state=Gr.idle,this.client.events.emit("session_request_expire",{id:r}))}),B(this,"deletePendingAuthRequest",async(r,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(r,n),s?Promise.resolve():this.client.core.expirer.del(r)])}),B(this,"setExpiry",async(r,n)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,n),await this.client.session.update(r,{expiry:n}))}),B(this,"setProposal",async(r,n)=>{this.client.core.expirer.set(r,ot(dt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,n)}),B(this,"setAuthRequest",async(r,n)=>{const{request:s,pairingTopic:i,transportType:o=Ve.relay}=n;this.client.core.expirer.set(r,s.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:r,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),B(this,"setPendingSessionRequest",async r=>{const{id:n,topic:s,params:i,verifyContext:o}=r,a=i.request.expiryTimestamp||ot(dt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,a),await this.client.pendingRequest.set(n,{id:n,topic:s,params:i,verifyContext:o})}),B(this,"sendRequest",async r=>{const{topic:n,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:u,appLink:l,tvf:d}=r,h=Gn(s,i,c);let f;const p=!!l;try{const w=p?Hn:Ur;f=await this.client.core.crypto.encode(n,h,{encoding:w})}catch(w){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),w}let g;if(wk.includes(s)){const w=Qr(JSON.stringify(h)),b=Qr(f);g=await this.client.core.verify.register({id:b,decryptedId:w})}const m=dt[s].req;if(m.attestation=g,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(n,h),p){const w=Ec(l,n,f);await global.Linking.openURL(w,this.client.name)}else{const w=dt[s].req;o&&(w.ttl=o),a&&(w.id=a),w.tvf=kt(je({},d),{correlationId:h.id}),u?(w.internal=kt(je({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,f,w)):this.client.core.relayer.publish(n,f,w).catch(b=>this.client.logger.error(b))}return h.id}),B(this,"sendResult",async r=>{const{id:n,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=r,u=zu(n,i);let l;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?Hn:Ur;l=await this.client.core.crypto.encode(s,u,kt(je({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let h,f;try{h=await this.client.core.history.get(s,n);const p=h.request;try{this.shouldSetTVF(p.method,p.params)&&(f=this.getTVFParams(n,p.params,i))}catch(g){this.client.logger.warn("sendResult() -> getTVFParams() failed",g)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),p}if(d){const p=Ec(c,s,l);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,g=dt[p].res;g.tvf=kt(je({},f),{correlationId:n}),o?(g.internal=kt(je({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,l,g)):this.client.core.relayer.publish(s,l,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(u)}),B(this,"sendError",async r=>{const{id:n,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=r,u=Hu(n,i);let l;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?Hn:Ur;l=await this.client.core.crypto.encode(s,u,kt(je({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let h;try{h=await this.client.core.history.get(s,n)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),f}if(d){const f=Ec(c,s,l);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,p=a||dt[f].res;this.client.core.relayer.publish(s,l,p)}await this.client.core.history.resolve(u)}),B(this,"cleanup",async()=>{const r=[],n=[];this.client.session.getAll().forEach(s=>{let i=!1;qn(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&r.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{qn(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...r.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])}),B(this,"onProviderMessageEvent",async r=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(r):await this.onRelayMessage(r)}),B(this,"onRelayEventRequest",async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()}),B(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Gr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Gr.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Gr.idle}),B(this,"processRequest",async r=>{const{topic:n,payload:s,attestation:i,transportType:o,encryptedId:a}=r,c=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),B(this,"onRelayEventResponse",async r=>{const{topic:n,payload:s,transportType:i}=r,o=(await this.client.core.history.get(n,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),B(this,"onRelayEventUnknownPayload",r=>{const{topic:n}=r,{message:s}=V("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),B(this,"shouldIgnorePairingRequest",r=>{const{topic:n,requestMethod:s}=r,i=this.expectedPairingMethodMap.get(n);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),B(this,"onSessionProposeRequest",async r=>{const{topic:n,payload:s,attestation:i,encryptedId:o}=r,{params:a,id:c}=s;try{const u=this.client.core.eventClient.getEvent({topic:n});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u==null||u.setError(vn.proposal_listener_not_found)),this.isValidConnect(je({},s.params));const l=a.expiryTimestamp||ot(dt.wc_sessionPropose.req.ttl),d=je({id:c,pairingTopic:n,expiryTimestamp:l},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:Qr(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});u==null||u.addTrace(Yr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(u){await this.sendError({id:c,topic:n,error:u,rpcOpts:dt.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),B(this,"onSessionProposeResponse",async(r,n,s)=>{const{id:i}=n;if(Jr(n)){const{result:o}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const l=await this.client.core.crypto.generateSharedKey(c,u);this.pendingSessions.set(i,{sessionTopic:l,pairingTopic:r,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(l,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:r})}else if(br(n)){await this.client.proposal.delete(i,Me("USER_DISCONNECTED"));const o=$e("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:n.error})}}),B(this,"onSessionSettleRequest",async(r,n)=>{const{id:s,params:i}=n;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:u,sessionProperties:l,scopedProperties:d,sessionConfig:h}=n.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===r);if(!f)return this.client.logger.error(`Pending session not found for topic ${r}`);const p=this.client.proposal.get(f.proposalId),g=kt(je(je(je({topic:r,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},l&&{sessionProperties:l}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Ve.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit($e("session_connect",f.proposalId),{session:g}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:n.id,topic:r,result:!0,throwOnFailedPublish:!0})}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),B(this,"onSessionSettleResponse",async(r,n)=>{const{id:s}=n;Jr(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit($e("session_approve",s),{})):br(n)&&(await this.client.session.delete(r,Me("USER_DISCONNECTED")),this.events.emit($e("session_approve",s),{error:n.error}))}),B(this,"onSessionUpdateRequest",async(r,n)=>{const{params:s,id:i}=n;try{const o=`${r}_session_update`,a=bo.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:r,error:Me("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(je({topic:r},s));try{bo.set(o,i),await this.client.session.update(r,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:r,result:!0,throwOnFailedPublish:!0})}catch(c){throw bo.delete(o),c}this.client.events.emit("session_update",{id:i,topic:r,params:s})}catch(o){await this.sendError({id:i,topic:r,error:o}),this.client.logger.error(o)}}),B(this,"isRequestOutOfSync",(r,n)=>n.toString().slice(0,-3)<r.toString().slice(0,-3)),B(this,"onSessionUpdateResponse",(r,n)=>{const{id:s}=n,i=$e("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Jr(n)?this.events.emit($e("session_update",s),{}):br(n)&&this.events.emit($e("session_update",s),{error:n.error})}),B(this,"onSessionExtendRequest",async(r,n)=>{const{id:s}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,ot(ci)),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),B(this,"onSessionExtendResponse",(r,n)=>{const{id:s}=n,i=$e("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Jr(n)?this.events.emit($e("session_extend",s),{}):br(n)&&this.events.emit($e("session_extend",s),{error:n.error})}),B(this,"onSessionPingRequest",async(r,n)=>{const{id:s}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:r})}catch(i){await this.sendError({id:s,topic:r,error:i}),this.client.logger.error(i)}}),B(this,"onSessionPingResponse",(r,n)=>{const{id:s}=n,i=$e("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Jr(n)?this.events.emit($e("session_ping",s),{}):br(n)&&this.events.emit($e("session_ping",s),{error:n.error})},500)}),B(this,"onSessionDeleteRequest",async(r,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(gt.publish,async()=>{i(await this.deleteSession({topic:r,id:s}))})}),this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:Me("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),B(this,"onSessionRequest",async r=>{var n,s,i;const{topic:o,payload:a,attestation:c,encryptedId:u,transportType:l}=r,{id:d,params:h}=a;try{await this.isValidRequest(je({topic:o},h));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:Qr(JSON.stringify(Gn("wc_sessionRequest",h,d))),encryptedId:u,metadata:f.peer.metadata,transportType:l}),g={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),l===Ve.link_mode&&(n=f.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),B(this,"onSessionRequestResponse",(r,n)=>{const{id:s}=n,i=$e("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Jr(n)?this.events.emit($e("session_request",s),{result:n.result}):br(n)&&this.events.emit($e("session_request",s),{error:n.error})}),B(this,"onSessionEventRequest",async(r,n)=>{const{id:s,params:i}=n;try{const o=`${r}_session_event_${i.event.name}`,a=bo.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(je({topic:r},i)),this.client.events.emit("session_event",{id:s,topic:r,params:i}),bo.set(o,s)}catch(o){await this.sendError({id:s,topic:r,error:o}),this.client.logger.error(o)}}),B(this,"onSessionAuthenticateResponse",(r,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:n}),Jr(n)?this.events.emit($e("session_request",s),{result:n.result}):br(n)&&this.events.emit($e("session_request",s),{error:n.error})}),B(this,"onSessionAuthenticateRequest",async r=>{var n;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=r;try{const{requester:u,authPayload:l,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Qr(JSON.stringify(i)),encryptedId:a,metadata:u.metadata,transportType:c}),f={requester:u,pairingTopic:s,id:i.id,authPayload:l,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===Ve.link_mode&&(n=u.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(u){this.client.logger.error(u);const l=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:Sn,receiverPublicKey:l,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:u,encodeOpts:f,rpcOpts:dt.wc_sessionAuthenticate.autoReject,appLink:h})}}),B(this,"addSessionRequestToSessionRequestQueue",r=>{this.sessionRequestQueue.queue.push(r)}),B(this,"cleanupAfterResponse",r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Gr.idle,this.processSessionRequestQueue()},W.toMiliseconds(this.requestQueueDelay))}),B(this,"cleanupPendingSentRequestsForTopic",({topic:r,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===r&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=$e("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit($e("session_request",i.request.id),{error:n})})}),B(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Gr.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Gr.active,this.emitSessionRequest(r)}catch(n){this.client.logger.error(n)}}),B(this,"emitSessionRequest",r=>{this.client.events.emit("session_request",r)}),B(this,"onPairingCreated",r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===r.topic);n&&this.onSessionProposeRequest({topic:r.topic,payload:Gn("wc_sessionPropose",kt(je({},n),{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties,scopedProperties:n.scopedProperties}),n.id)})}),B(this,"isValidConnect",async r=>{if(!Kt(r)){const{message:u}=V("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(u)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=r;if(At(n)||await this.isValidPairingTopic(n),!W2(c)){const{message:u}=V("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}if(!At(s)&&sa(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!At(i)&&sa(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),At(o)||this.validateSessionProps(o,"sessionProperties"),!At(a)){this.validateSessionProps(a,"scopedProperties");const u=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(l=>u.includes(l)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(u)}`)}}),B(this,"validateNamespaces",(r,n)=>{const s=H2(r,"connect()",n);if(s)throw new Error(s.message)}),B(this,"isValidApprove",async r=>{if(!Kt(r))throw new Error(V("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=r;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const c=this.client.proposal.get(n),u=Kl(s,"approve()");if(u)throw new Error(u.message);const l=Gg(c.requiredNamespaces,s,"approve()");if(l)throw new Error(l.message);if(!nt(i,!0)){const{message:d}=V("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(At(o)||this.validateSessionProps(o,"sessionProperties"),!At(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),B(this,"isValidReject",async r=>{if(!Kt(r)){const{message:i}=V("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(i)}const{id:n,reason:s}=r;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!K2(s)){const{message:i}=V("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),B(this,"isValidSessionSettleRequest",r=>{if(!Kt(r)){const{message:u}=V("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(u)}const{relay:n,controller:s,namespaces:i,expiry:o}=r;if(!a0(n)){const{message:u}=V("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=M2(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Kl(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(qn(o)){const{message:u}=V("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),B(this,"isValidUpdate",async r=>{if(!Kt(r)){const{message:c}=V("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(c)}const{topic:n,namespaces:s}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const i=this.client.session.get(n),o=Kl(s,"update()");if(o)throw new Error(o.message);const a=Gg(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),B(this,"isValidExtend",async r=>{if(!Kt(r)){const{message:s}=V("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(s)}const{topic:n}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)}),B(this,"isValidRequest",async r=>{if(!Kt(r)){const{message:c}=V("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:n,request:s,chainId:i,expiry:o}=r;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Kg(a,i)){const{message:c}=V("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!G2(s)){const{message:c}=V("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!J2(a,i,s.method)){const{message:c}=V("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!tR(o,td)){const{message:c}=V("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${td.min} and ${td.max}`);throw new Error(c)}}),B(this,"isValidRespond",async r=>{var n;if(!Kt(r)){const{message:o}=V("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(o)}const{topic:s,response:i}=r;try{await this.isValidSessionTopic(s)}catch(o){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),o}if(!Y2(i)){const{message:o}=V("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),B(this,"isValidPing",async r=>{if(!Kt(r)){const{message:s}=V("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),B(this,"isValidEmit",async r=>{if(!Kt(r)){const{message:a}=V("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(a)}const{topic:n,event:s,chainId:i}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Kg(o,i)){const{message:a}=V("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!Z2(s)){const{message:a}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!X2(o,i,s.name)){const{message:a}=V("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),B(this,"isValidDisconnect",async r=>{if(!Kt(r)){const{message:s}=V("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(s)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}),B(this,"isValidAuthenticate",r=>{const{chains:n,uri:s,domain:i,nonce:o}=r;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!nt(s,!1))throw new Error("uri is required parameter");if(!nt(i,!1))throw new Error("domain is required parameter");if(!nt(o,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(c=>Ni(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Ni(n[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),B(this,"getVerifyContext",async r=>{const{attestationId:n,hash:s,encryptedId:i,metadata:o,transportType:a}=r,c={verified:{verifyUrl:o.verifyUrl||Mo,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Ve.link_mode){const l=this.getAppLinkIfEnabled(o,a);return c.verified.validation=l&&new URL(l).origin===new URL(o.url).origin?"VALID":"INVALID",c}const u=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});u&&(c.verified.origin=u.origin,c.verified.isScam=u.isScam,c.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),B(this,"validateSessionProps",(r,n)=>{Object.values(r).forEach((s,i)=>{if(s==null){const{message:o}=V("MISSING_OR_INVALID",`${n} must contain an existing value for each key. Received: ${s} for key ${Object.keys(r)[i]}`);throw new Error(o)}})}),B(this,"getPendingAuthRequest",r=>{const n=this.client.auth.requests.get(r);return typeof n=="object"?n:void 0}),B(this,"addToRecentlyDeleted",(r,n)=>{if(this.recentlyDeletedMap.set(r,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),B(this,"checkRecentlyDeleted",r=>{const n=this.recentlyDeletedMap.get(r);if(n){const{message:s}=V("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${r}`);throw new Error(s)}}),B(this,"isLinkModeEnabled",(r,n)=>{var s,i,o,a,c,u,l,d,h;return!r||n!==Ve.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:u.universal)!==""&&((l=r==null?void 0:r.redirect)==null?void 0:l.universal)!==void 0&&((d=r==null?void 0:r.redirect)==null?void 0:d.universal)!==""&&((h=r==null?void 0:r.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),B(this,"getAppLinkIfEnabled",(r,n)=>{var s;return this.isLinkModeEnabled(r,n)?(s=r==null?void 0:r.redirect)==null?void 0:s.universal:void 0}),B(this,"handleLinkModeMessage",({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const n=hg(r,"topic")||"",s=decodeURIComponent(hg(r,"wc_ev")||""),i=this.client.session.keys.includes(n);i&&this.client.session.update(n,{transportType:Ve.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:i})}),B(this,"registerLinkModeListeners",async()=>{var r;if(ef()||cs()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),B(this,"shouldSetTVF",(r,n)=>{if(!n||r!=="wc_sessionRequest")return!1;const{request:s}=n;return Object.keys(Om).includes(s.method)}),B(this,"getTVFParams",(r,n,s)=>{var i,o;try{const a=n.request.method,c=this.extractTxHashesFromResult(a,s);return kt(je({correlationId:r,rpcMethods:[a],chainId:n.chainId},this.isValidContractData(n.request.params)&&{contractAddresses:[(o=(i=n.request.params)==null?void 0:i[0])==null?void 0:o.to]}),{txHashes:c})}catch(a){this.client.logger.warn("Error getting TVF params",a)}return{}}),B(this,"isValidContractData",r=>{var n;if(!r)return!1;try{const s=(r==null?void 0:r.data)||((n=r==null?void 0:r[0])==null?void 0:n.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),B(this,"extractTxHashesFromResult",(r,n)=>{try{const s=Om[r];if(typeof n=="string")return[n];const i=n[s.key];if(Jn(i))return r==="solana_signAllTransactions"?i.map(o=>Px(o)):i;if(typeof i=="string")return[i]}catch(s){this.client.logger.warn("Error extracting tx hashes from result",s)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,r=this.client.core.relayer.messages.getWithoutAck(e);for(const[n,s]of Object.entries(r))for(const i of s)try{await this.onProviderMessageEvent({topic:n,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${n}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=V("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(gt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:r,message:n,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(zc)?this.client.auth.authKeys.get(zc):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(r,n,{receiverPublicKey:o,encoding:i===Ve.link_mode?Hn:Ur});df(a)?(this.client.core.history.set(r,a),await this.onRelayEventRequest({topic:r,payload:a,attestation:s,transportType:i,encryptedId:Qr(n)})):Wu(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a,transportType:i}),this.client.core.history.delete(r,a.id)):await this.onRelayEventUnknownPayload({topic:r,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(r,n)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(wr.expired,async e=>{const{topic:r,id:n}=Sb(e.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,V("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,V("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(vs.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(vs.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!nt(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(qn(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=V("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!nt(e,!1)){const{message:r}=V("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(qn(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=V("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=V("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(nt(e,!1)){const{message:r}=V("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=V("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!V2(e)){const{message:r}=V("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=V("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(qn(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=V("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class xk extends Xs{constructor(e,r){super(e,r,pk,hf),this.core=e,this.logger=r}}let Ok=class extends Xs{constructor(e,r){super(e,r,gk,hf),this.core=e,this.logger=r}};class Rk extends Xs{constructor(e,r){super(e,r,yk,hf,n=>n.id),this.core=e,this.logger=r}}class $k extends Xs{constructor(e,r){super(e,r,Ek,Ku,()=>zc),this.core=e,this.logger=r}}class Dk extends Xs{constructor(e,r){super(e,r,_k,Ku),this.core=e,this.logger=r}}class kk extends Xs{constructor(e,r){super(e,r,Ck,Ku,n=>n.id),this.core=e,this.logger=r}}var Uk=Object.defineProperty,Lk=(t,e,r)=>e in t?Uk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,rd=(t,e,r)=>Lk(t,typeof e!="symbol"?e+"":e,r);class Mk{constructor(e,r){this.core=e,this.logger=r,rd(this,"authKeys"),rd(this,"pairingTopics"),rd(this,"requests"),this.authKeys=new $k(this.core,this.logger),this.pairingTopics=new Dk(this.core,this.logger),this.requests=new kk(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var Bk=Object.defineProperty,Fk=(t,e,r)=>e in t?Bk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ce=(t,e,r)=>Fk(t,typeof e!="symbol"?e+"":e,r);let jk=class R0 extends p1{constructor(e){super(e),Ce(this,"protocol",P0),Ce(this,"version",x0),Ce(this,"name",ed.name),Ce(this,"metadata"),Ce(this,"core"),Ce(this,"logger"),Ce(this,"events",new Ar.EventEmitter),Ce(this,"engine"),Ce(this,"session"),Ce(this,"proposal"),Ce(this,"pendingRequest"),Ce(this,"auth"),Ce(this,"signConfig"),Ce(this,"on",(n,s)=>this.events.on(n,s)),Ce(this,"once",(n,s)=>this.events.once(n,s)),Ce(this,"off",(n,s)=>this.events.off(n,s)),Ce(this,"removeListener",(n,s)=>this.events.removeListener(n,s)),Ce(this,"removeAllListeners",n=>this.events.removeAllListeners(n)),Ce(this,"connect",async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"pair",async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"approve",async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"reject",async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"update",async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"extend",async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"request",async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"respond",async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"ping",async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"emit",async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"disconnect",async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"find",n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}}),Ce(this,"authenticate",async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(i){throw this.logger.error(i.message),i}}),Ce(this,"formatAuthMessage",n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"approveSessionAuthenticate",async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),Ce(this,"rejectSessionAuthenticate",async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||ed.name,this.metadata=qP(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Wa(Ji({level:(e==null?void 0:e.logger)||ed.logger}));this.core=(e==null?void 0:e.core)||new fk(e),this.logger=$t(r,this.name),this.session=new Ok(this.core,this.logger),this.proposal=new xk(this.core,this.logger),this.pendingRequest=new Rk(this.core,this.logger),this.engine=new Pk(this),this.auth=new Mk(this.core,this.logger)}static async init(e){const r=new R0(e);return await r.initialize(),r}get context(){return Qt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},W.toMiliseconds(W.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Cc={exports:{}},$m;function qk(){return $m||($m=1,function(t,e){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Xr<"u"&&Xr,n=function(){function i(){this.fetch=!1,this.DOMException=r.DOMException}return i.prototype=r,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Xr<"u"&&Xr||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(I){return I&&DataView.prototype.isPrototypeOf(I)}if(c.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(I){return I&&l.indexOf(Object.prototype.toString.call(I))>-1};function h(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(I)||I==="")throw new TypeError('Invalid character in header field name: "'+I+'"');return I.toLowerCase()}function f(I){return typeof I!="string"&&(I=String(I)),I}function p(I){var N={next:function(){var $=I.shift();return{done:$===void 0,value:$}}};return c.iterable&&(N[Symbol.iterator]=function(){return N}),N}function g(I){this.map={},I instanceof g?I.forEach(function(N,$){this.append($,N)},this):Array.isArray(I)?I.forEach(function(N){if(N.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+N.length);this.append(N[0],N[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function(N){this.append(N,I[N])},this)}g.prototype.append=function(I,N){I=h(I),N=f(N);var $=this.map[I];this.map[I]=$?$+", "+N:N},g.prototype.delete=function(I){delete this.map[h(I)]},g.prototype.get=function(I){return I=h(I),this.has(I)?this.map[I]:null},g.prototype.has=function(I){return this.map.hasOwnProperty(h(I))},g.prototype.set=function(I,N){this.map[h(I)]=f(N)},g.prototype.forEach=function(I,N){for(var $ in this.map)this.map.hasOwnProperty($)&&I.call(N,this.map[$],$,this)},g.prototype.keys=function(){var I=[];return this.forEach(function(N,$){I.push($)}),p(I)},g.prototype.values=function(){var I=[];return this.forEach(function(N){I.push(N)}),p(I)},g.prototype.entries=function(){var I=[];return this.forEach(function(N,$){I.push([$,N])}),p(I)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(I){if(!I._noBody){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}}function w(I){return new Promise(function(N,$){I.onload=function(){N(I.result)},I.onerror=function(){$(I.error)}})}function b(I){var N=new FileReader,$=w(N);return N.readAsArrayBuffer(I),$}function v(I){var N=new FileReader,$=w(N),k=/charset=([A-Za-z0-9_-]+)/.exec(I.type),D=k?k[1]:"utf-8";return N.readAsText(I,D),$}function A(I){for(var N=new Uint8Array(I),$=new Array(N.length),k=0;k<N.length;k++)$[k]=String.fromCharCode(N[k]);return $.join("")}function E(I){if(I.slice)return I.slice(0);var N=new Uint8Array(I.byteLength);return N.set(new Uint8Array(I)),N.buffer}function y(){return this.bodyUsed=!1,this._initBody=function(I){this.bodyUsed=this.bodyUsed,this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:c.blob&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:c.formData&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():c.arrayBuffer&&c.blob&&u(I)?(this._bodyArrayBuffer=E(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(I)||d(I))?this._bodyArrayBuffer=E(I):this._bodyText=I=Object.prototype.toString.call(I):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var I=m(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var I=m(this);return I||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(b);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var I=m(this);if(I)return I;if(this._bodyBlob)return v(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(A(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}var _=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function T(I){var N=I.toUpperCase();return _.indexOf(N)>-1?N:I}function S(I,N){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');N=N||{};var $=N.body;if(I instanceof S){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,N.headers||(this.headers=new g(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,!$&&I._bodyInit!=null&&($=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=N.credentials||this.credentials||"same-origin",(N.headers||!this.headers)&&(this.headers=new g(N.headers)),this.method=T(N.method||this.method||"GET"),this.mode=N.mode||this.mode||null,this.signal=N.signal||this.signal||function(){if("AbortController"in a){var U=new AbortController;return U.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&$)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody($),(this.method==="GET"||this.method==="HEAD")&&(N.cache==="no-store"||N.cache==="no-cache")){var k=/([?&])_=[^&]*/;if(k.test(this.url))this.url=this.url.replace(k,"$1_="+new Date().getTime());else{var D=/\?/;this.url+=(D.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function x(I){var N=new FormData;return I.trim().split("&").forEach(function($){if($){var k=$.split("="),D=k.shift().replace(/\+/g," "),U=k.join("=").replace(/\+/g," ");N.append(decodeURIComponent(D),decodeURIComponent(U))}}),N}function O(I){var N=new g,$=I.replace(/\r?\n[\t ]+/g," ");return $.split("\r").map(function(k){return k.indexOf(`
`)===0?k.substr(1,k.length):k}).forEach(function(k){var D=k.split(":"),U=D.shift().trim();if(U){var H=D.join(":").trim();try{N.append(U,H)}catch(G){console.warn("Response "+G.message)}}}),N}y.call(S.prototype);function L(I,N){if(!(this instanceof L))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(N||(N={}),this.type="default",this.status=N.status===void 0?200:N.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=N.statusText===void 0?"":""+N.statusText,this.headers=new g(N.headers),this.url=N.url||"",this._initBody(I)}y.call(L.prototype),L.prototype.clone=function(){return new L(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},L.error=function(){var I=new L(null,{status:200,statusText:""});return I.ok=!1,I.status=0,I.type="error",I};var M=[301,302,303,307,308];L.redirect=function(I,N){if(M.indexOf(N)===-1)throw new RangeError("Invalid status code");return new L(null,{status:N,headers:{location:I}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(N,$){this.message=N,this.name=$;var k=Error(N);this.stack=k.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function R(I,N){return new Promise(function($,k){var D=new S(I,N);if(D.signal&&D.signal.aborted)return k(new o.DOMException("Aborted","AbortError"));var U=new XMLHttpRequest;function H(){U.abort()}U.onload=function(){var K={statusText:U.statusText,headers:O(U.getAllResponseHeaders()||"")};D.url.indexOf("file://")===0&&(U.status<200||U.status>599)?K.status=200:K.status=U.status,K.url="responseURL"in U?U.responseURL:K.headers.get("X-Request-URL");var ie="response"in U?U.response:U.responseText;setTimeout(function(){$(new L(ie,K))},0)},U.onerror=function(){setTimeout(function(){k(new TypeError("Network request failed"))},0)},U.ontimeout=function(){setTimeout(function(){k(new TypeError("Network request timed out"))},0)},U.onabort=function(){setTimeout(function(){k(new o.DOMException("Aborted","AbortError"))},0)};function G(K){try{return K===""&&a.location.href?a.location.href:K}catch{return K}}if(U.open(D.method,G(D.url),!0),D.credentials==="include"?U.withCredentials=!0:D.credentials==="omit"&&(U.withCredentials=!1),"responseType"in U&&(c.blob?U.responseType="blob":c.arrayBuffer&&(U.responseType="arraybuffer")),N&&typeof N.headers=="object"&&!(N.headers instanceof g||a.Headers&&N.headers instanceof a.Headers)){var se=[];Object.getOwnPropertyNames(N.headers).forEach(function(K){se.push(h(K)),U.setRequestHeader(K,f(N.headers[K]))}),D.headers.forEach(function(K,ie){se.indexOf(ie)===-1&&U.setRequestHeader(ie,K)})}else D.headers.forEach(function(K,ie){U.setRequestHeader(ie,K)});D.signal&&(D.signal.addEventListener("abort",H),U.onreadystatechange=function(){U.readyState===4&&D.signal.removeEventListener("abort",H)}),U.send(typeof D._bodyInit>"u"?null:D._bodyInit)})}return R.polyfill=!0,a.fetch||(a.fetch=R,a.Headers=g,a.Request=S,a.Response=L),o.Headers=g,o.Request=S,o.Response=L,o.fetch=R,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var s=r.fetch?r:n;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e}(Cc,Cc.exports)),Cc.exports}var zk=qk();const Dm=xu(zk);var Hk=Object.defineProperty,Wk=Object.defineProperties,Vk=Object.getOwnPropertyDescriptors,km=Object.getOwnPropertySymbols,Kk=Object.prototype.hasOwnProperty,Gk=Object.prototype.propertyIsEnumerable,Um=(t,e,r)=>e in t?Hk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Lm=(t,e)=>{for(var r in e||(e={}))Kk.call(e,r)&&Um(t,r,e[r]);if(km)for(var r of km(e))Gk.call(e,r)&&Um(t,r,e[r]);return t},Mm=(t,e)=>Wk(t,Vk(e));const Yk={Accept:"application/json","Content-Type":"application/json"},Zk="POST",Bm={headers:Yk,method:Zk},Fm=10;let qr=class{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new Ar.EventEmitter,this.isAvailable=!1,this.registering=!1,!tm(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const r=Pn(e),n=await(await Dm(this.url,Mm(Lm({},Bm),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(e.id,r)}}async register(e=this.url){if(!tm(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));n()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=Pn({id:1,jsonrpc:"2.0",method:"test",params:[]});await Dm(e,Mm(Lm({},Bm),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?$s(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const n=this.parseError(r),s=n.message||n.toString(),i=Hu(e,s);this.events.emit("payload",i)}parseError(e,r=this.url){return l0(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Fm&&this.events.setMaxListeners(Fm)}};const jm="error",Jk="wss://relay.walletconnect.org",Xk="wc",Qk="universal_provider",Ac=`${Xk}@2:${Qk}:`,$0="https://rpc.walletconnect.org/v1/",_i="generic",e5=`${$0}bundler`,Nr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function t5(){}function ff(t){return t==null||typeof t!="object"&&typeof t!="function"}function pf(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function r5(t){if(ff(t))return t;if(Array.isArray(t)||pf(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),r=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new r(t);if(t instanceof RegExp){const n=new r(t);return n.lastIndex=t.lastIndex,n}if(t instanceof DataView)return new r(t.buffer.slice(0));if(t instanceof Error){const n=new r(t.message);return n.stack=t.stack,n.name=t.name,n.cause=t.cause,n}if(typeof File<"u"&&t instanceof File)return new r([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const n=Object.create(e);return Object.assign(n,t)}return t}function qm(t){return typeof t=="object"&&t!==null}function D0(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function k0(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const n5="[object RegExp]",U0="[object String]",L0="[object Number]",M0="[object Boolean]",B0="[object Arguments]",s5="[object Symbol]",i5="[object Date]",o5="[object Map]",a5="[object Set]",c5="[object Array]",u5="[object ArrayBuffer]",l5="[object Object]",d5="[object DataView]",h5="[object Uint8Array]",f5="[object Uint8ClampedArray]",p5="[object Uint16Array]",g5="[object Uint32Array]",m5="[object Int8Array]",y5="[object Int16Array]",w5="[object Int32Array]",b5="[object Float32Array]",v5="[object Float64Array]";function E5(t,e){return Si(t,void 0,t,new Map,e)}function Si(t,e,r,n=new Map,s=void 0){const i=s==null?void 0:s(t,e,r,n);if(i!=null)return i;if(ff(t))return t;if(n.has(t))return n.get(t);if(Array.isArray(t)){const o=new Array(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Si(t[a],a,r,n,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;n.set(t,o);for(const[a,c]of t)o.set(a,Si(c,a,r,n,s));return o}if(t instanceof Set){const o=new Set;n.set(t,o);for(const a of t)o.add(Si(a,void 0,r,n,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(pf(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);n.set(t,o);for(let a=0;a<t.length;a++)o[a]=Si(t[a],a,r,n,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return n.set(t,o),Es(o,t,r,n,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return n.set(t,o),Es(o,t,r,n,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return n.set(t,o),Es(o,t,r,n,s),o}if(t instanceof Error){const o=new t.constructor;return n.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Es(o,t,r,n,s),o}if(typeof t=="object"&&_5(t)){const o=Object.create(Object.getPrototypeOf(t));return n.set(t,o),Es(o,t,r,n,s),o}return t}function Es(t,e,r=t,n,s){const i=[...Object.keys(e),...D0(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Si(e[a],a,r,n,s))}}function _5(t){switch(k0(t)){case B0:case c5:case u5:case d5:case M0:case i5:case b5:case v5:case m5:case y5:case w5:case o5:case L0:case l5:case n5:case a5:case U0:case s5:case h5:case f5:case p5:case g5:return!0;default:return!1}}function C5(t,e){return E5(t,(r,n,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case L0:case U0:case M0:{const o=new t.constructor(t==null?void 0:t.valueOf());return Es(o,t),o}case B0:{const o={};return Es(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function zm(t){return C5(t)}function Hm(t){return t!==null&&typeof t=="object"&&k0(t)==="[object Arguments]"}function A5(t){return pf(t)}function I5(t){var r;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!((r=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&r.writable)?!1:t.toString()===`[object ${n}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function S5(t,...e){const r=e.slice(0,-1),n=e[e.length-1];let s=t;for(let i=0;i<r.length;i++){const o=r[i];s=gh(s,o,n,new Map)}return s}function gh(t,e,r,n){if(ff(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(n.has(e))return r5(n.get(e));if(n.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...D0(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(Hm(a)&&(a={...a}),Hm(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=zm(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const l=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const f=d[h];l[f]=c[f]}c=l}else c=[];const u=r(c,a,o,t,e,n);u!=null?t[o]=u:Array.isArray(a)||qm(c)&&qm(a)?t[o]=gh(c,a,r,n):c==null&&I5(a)?t[o]=gh({},a,r,n):c==null&&A5(a)?t[o]=zm(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function N5(t,...e){return S5(t,...e,t5)}var T5=Object.defineProperty,P5=Object.defineProperties,x5=Object.getOwnPropertyDescriptors,Wm=Object.getOwnPropertySymbols,O5=Object.prototype.hasOwnProperty,R5=Object.prototype.propertyIsEnumerable,Vm=(t,e,r)=>e in t?T5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ic=(t,e)=>{for(var r in e||(e={}))O5.call(e,r)&&Vm(t,r,e[r]);if(Wm)for(var r of Wm(e))R5.call(e,r)&&Vm(t,r,e[r]);return t},$5=(t,e)=>P5(t,x5(e));function ur(t,e,r){var n;const s=Ni(t);return((n=e.rpcMap)==null?void 0:n[s.reference])||`${$0}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function Qs(t){return t.includes(":")?t.split(":")[1]:t}function F0(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function D5(t,e){const r=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!r.length)return[];const n=[];return r.forEach(s=>{const i=e.namespaces[s].accounts;n.push(...i)}),n}function nd(t={},e={}){const r=Km(t),n=Km(e);return N5(r,n)}function Km(t){var e,r,n,s;const i={};if(!sa(t))return i;for(const[o,a]of Object.entries(t)){const c=cf(o)?[o]:a.chains,u=a.methods||[],l=a.events||[],d=a.rpcMap||{},h=Oo(o);i[h]=$5(Ic(Ic({},i[h]),a),{chains:Bc(c,(e=i[h])==null?void 0:e.chains),methods:Bc(u,(r=i[h])==null?void 0:r.methods),events:Bc(l,(n=i[h])==null?void 0:n.events),rpcMap:Ic(Ic({},d),(s=i[h])==null?void 0:s.rpcMap)})}return i}function Gm(t){return t.includes(":")?t.split(":")[2]:t}function Ym(t){const e={};for(const[r,n]of Object.entries(t)){const s=n.methods||[],i=n.events||[],o=n.accounts||[],a=cf(r)?[r]:n.chains?n.chains:F0(n.accounts);e[r]={chains:a,methods:s,events:i,accounts:o}}return e}function sd(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const j0={},xe=t=>j0[t],id=(t,e)=>{j0[t]=e};var k5=Object.defineProperty,U5=(t,e,r)=>e in t?k5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ui=(t,e,r)=>U5(t,typeof e!="symbol"?e+"":e,r);class L5{constructor(e){ui(this,"name","polkadot"),ui(this,"client"),ui(this,"httpProviders"),ui(this,"events"),ui(this,"namespace"),ui(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=Qs(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}}var M5=Object.defineProperty,B5=Object.defineProperties,F5=Object.getOwnPropertyDescriptors,Zm=Object.getOwnPropertySymbols,j5=Object.prototype.hasOwnProperty,q5=Object.prototype.propertyIsEnumerable,mh=(t,e,r)=>e in t?M5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Jm=(t,e)=>{for(var r in e||(e={}))j5.call(e,r)&&mh(t,r,e[r]);if(Zm)for(var r of Zm(e))q5.call(e,r)&&mh(t,r,e[r]);return t},Xm=(t,e)=>B5(t,F5(e)),li=(t,e,r)=>mh(t,typeof e!="symbol"?e+"":e,r);class z5{constructor(e){li(this,"name","eip155"),li(this,"client"),li(this,"chainId"),li(this,"namespace"),li(this,"httpProviders"),li(this,"events"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const n=r||ur(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=parseInt(Qs(r));e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,n;let s=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var r,n,s;const i=(n=(r=e.request)==null?void 0:r.params)==null?void 0:n[0];if(!i)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const o=this.client.session.get(e.topic),a=((s=o==null?void 0:o.sessionProperties)==null?void 0:s.capabilities)||{};if(a!=null&&a[i])return a==null?void 0:a[i];const c=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Xm(Jm({},o.sessionProperties||{}),{capabilities:Xm(Jm({},a||{}),{[i]:c})})})}catch(u){console.warn("Failed to update session with capabilities",u)}return c}async getCallStatus(e){var r,n;const s=this.client.session.get(e.topic),i=(r=s.sessionProperties)==null?void 0:r.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,r){var n;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Gn("eth_getUserOperationReceipt",[(n=r.request.params)==null?void 0:n[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,r){return`${e5}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${r}`}}var H5=Object.defineProperty,W5=(t,e,r)=>e in t?H5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,di=(t,e,r)=>W5(t,typeof e!="symbol"?e+"":e,r);class V5{constructor(e){di(this,"name","solana"),di(this,"client"),di(this,"httpProviders"),di(this,"events"),di(this,"namespace"),di(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=Qs(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}}var K5=Object.defineProperty,G5=(t,e,r)=>e in t?K5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,hi=(t,e,r)=>G5(t,typeof e!="symbol"?e+"":e,r);class Y5{constructor(e){hi(this,"name","cosmos"),hi(this,"client"),hi(this,"httpProviders"),hi(this,"events"),hi(this,"namespace"),hi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=Qs(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}}var Z5=Object.defineProperty,J5=(t,e,r)=>e in t?Z5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fi=(t,e,r)=>J5(t,typeof e!="symbol"?e+"":e,r);class X5{constructor(e){fi(this,"name","algorand"),fi(this,"client"),fi(this,"httpProviders"),fi(this,"events"),fi(this,"namespace"),fi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const n=r||ur(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;e[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Sr(new qr(n,xe("disableProviderPing")))}}var Q5=Object.defineProperty,eU=(t,e,r)=>e in t?Q5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,pi=(t,e,r)=>eU(t,typeof e!="symbol"?e+"":e,r);class tU{constructor(e){pi(this,"name","cip34"),pi(this,"client"),pi(this,"httpProviders"),pi(this,"events"),pi(this,"namespace"),pi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),s=Qs(r);e[s]=this.createHttpProvider(s,n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||this.getCardanoRPCUrl(e);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}}var rU=Object.defineProperty,nU=(t,e,r)=>e in t?rU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,gi=(t,e,r)=>nU(t,typeof e!="symbol"?e+"":e,r);class sU{constructor(e){gi(this,"name","elrond"),gi(this,"client"),gi(this,"httpProviders"),gi(this,"events"),gi(this,"namespace"),gi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=Qs(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}}var iU=Object.defineProperty,oU=(t,e,r)=>e in t?iU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,mi=(t,e,r)=>oU(t,typeof e!="symbol"?e+"":e,r);class aU{constructor(e){mi(this,"name","multiversx"),mi(this,"client"),mi(this,"httpProviders"),mi(this,"events"),mi(this,"namespace"),mi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;const s=Qs(r);e[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}}var cU=Object.defineProperty,uU=(t,e,r)=>e in t?cU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,yi=(t,e,r)=>uU(t,typeof e!="symbol"?e+"":e,r);class lU{constructor(e){yi(this,"name","near"),yi(this,"client"),yi(this,"httpProviders"),yi(this,"events"),yi(this,"namespace"),yi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||ur(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var n;e[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace);return typeof n>"u"?void 0:new Sr(new qr(n,xe("disableProviderPing")))}}var dU=Object.defineProperty,hU=(t,e,r)=>e in t?dU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,wi=(t,e,r)=>hU(t,typeof e!="symbol"?e+"":e,r);class fU{constructor(e){wi(this,"name","tezos"),wi(this,"client"),wi(this,"httpProviders"),wi(this,"events"),wi(this,"namespace"),wi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const n=r||ur(`${this.name}:${e}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,n)}this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace);return typeof n>"u"?void 0:new Sr(new qr(n))}}var pU=Object.defineProperty,gU=(t,e,r)=>e in t?pU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bi=(t,e,r)=>gU(t,typeof e!="symbol"?e+"":e,r);class mU{constructor(e){bi(this,"name",_i),bi(this,"client"),bi(this,"httpProviders"),bi(this,"events"),bi(this,"namespace"),bi(this,"chainId"),this.namespace=e.namespace,this.events=xe("events"),this.client=xe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(Nr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var e,r;const n={};return(r=(e=this.namespace)==null?void 0:e.accounts)==null||r.forEach(s=>{const i=Ni(s);n[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(e){const r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const n=this.createHttpProvider(e,r);n&&(this.httpProviders[e]=n)}createHttpProvider(e,r){const n=r||ur(e,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${e}`);return new Sr(new qr(n,xe("disableProviderPing")))}}var yU=Object.defineProperty,wU=Object.defineProperties,bU=Object.getOwnPropertyDescriptors,Qm=Object.getOwnPropertySymbols,vU=Object.prototype.hasOwnProperty,EU=Object.prototype.propertyIsEnumerable,yh=(t,e,r)=>e in t?yU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Sc=(t,e)=>{for(var r in e||(e={}))vU.call(e,r)&&yh(t,r,e[r]);if(Qm)for(var r of Qm(e))EU.call(e,r)&&yh(t,r,e[r]);return t},od=(t,e)=>wU(t,bU(e)),pr=(t,e,r)=>yh(t,typeof e!="symbol"?e+"":e,r);let _U=class q0{constructor(e){pr(this,"client"),pr(this,"namespaces"),pr(this,"optionalNamespaces"),pr(this,"sessionProperties"),pr(this,"scopedProperties"),pr(this,"events",new qh),pr(this,"rpcProviders",{}),pr(this,"session"),pr(this,"providerOpts"),pr(this,"logger"),pr(this,"uri"),pr(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Wa(Ji({level:(e==null?void 0:e.logger)||jm})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new q0(e);return await r.initialize(),r}async request(e,r,n){const[s,i]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Sc({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:n})}sendAsync(e,r,n,s){const i=new Date().getTime();this.request(e,n,s).then(o=>r(null,zu(i,o))).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Me("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(e,r);n&&(this.uri=n,this.events.emit("display_uri",n));const i=await s();if(this.session=i.session,this.session){const o=Ym(this.session.namespaces);this.namespaces=nd(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){const{uri:r,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});r&&(this.uri=r,this.events.emit("display_uri",r));const s=await n();this.session=s;const i=Ym(s.namespaces);return this.namespaces=nd(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[n,s]=this.validateChain(e),i=this.getProvider(n);i.name===_i?i.setDefaultChain(`${n}:${s}`,r):i.setDefaultChain(s,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Jn(r)){for(const n of r)e.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,r;if(this.client=this.providerOpts.client||await jk.init({core:this.providerOpts.core,logger:this.providerOpts.logger||jm,relayUrl:this.providerOpts.relayUrl||Jk,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(n){throw this.logger.error("Failed to get session",n),new Error(`The provided session: ${(r=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:r.topic} doesn't exist in the Sign client`)}else{const n=this.client.session.getAll();this.session=n[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Oo(r)))];id("client",this.client),id("events",this.events),id("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const n=D5(r,this.session),s=F0(n),i=nd(this.namespaces,this.optionalNamespaces),o=od(Sc({},i[r]),{accounts:n,chains:s});switch(r){case"eip155":this.rpcProviders[r]=new z5({namespace:o});break;case"algorand":this.rpcProviders[r]=new X5({namespace:o});break;case"solana":this.rpcProviders[r]=new V5({namespace:o});break;case"cosmos":this.rpcProviders[r]=new Y5({namespace:o});break;case"polkadot":this.rpcProviders[r]=new L5({namespace:o});break;case"cip34":this.rpcProviders[r]=new tU({namespace:o});break;case"elrond":this.rpcProviders[r]=new sU({namespace:o});break;case"multiversx":this.rpcProviders[r]=new aU({namespace:o});break;case"near":this.rpcProviders[r]=new lU({namespace:o});break;case"tezos":this.rpcProviders[r]=new fU({namespace:o});break;default:this.rpcProviders[_i]?this.rpcProviders[_i].updateNamespace(o):this.rpcProviders[_i]=new mU({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var r;const{topic:n}=e;n===((r=this.session)==null?void 0:r.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var r;const{params:n,topic:s}=e;if(s!==((r=this.session)==null?void 0:r.topic))return;const{event:i}=n;if(i.name==="accountsChanged"){const o=i.data;o&&Jn(o)&&this.events.emit("accountsChanged",o.map(Gm))}else if(i.name==="chainChanged"){const o=n.chainId,a=n.event.data,c=Oo(o),u=sd(o)!==sd(a)?`${c}:${sd(a)}`:o;this.onChainChanged(u)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var n,s;if(e!==((n=this.session)==null?void 0:n.topic))return;const{namespaces:i}=r,o=(s=this.client)==null?void 0:s.session.get(e);this.session=od(Sc({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{var r;e.topic===((r=this.session)==null?void 0:r.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",od(Sc({},Me("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Nr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[_i]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:n,sessionProperties:s,scopedProperties:i}=e;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[r,n]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(o=>Oo(o)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const s=Oo(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,r=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(n,s),this.events.emit("chainChanged",s);const i=this.getProvider(n).getDefaultChain();r||this.getProvider(n).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:n,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:r,newChainId:n}){var s,i;try{if(r===n)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${n}:`)).map(Gm);if(!Jn(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,r){if(!this.namespaces)return;const n=this.namespaces[e]?e:`${e}:${r}`,s={chains:[],methods:[],events:[],defaultChain:r};this.namespaces[n]?this.namespaces[n]&&(this.namespaces[n].defaultChain=r):this.namespaces[n]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,r){var n;const s=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.setItem(`${Ac}/${e}${s}`,r)}async getFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";return await this.client.core.storage.getItem(`${Ac}/${e}${n}`)}async deleteFromStore(e){var r;const n=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.removeItem(`${Ac}/${e}${n}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const r=await this.client.core.storage.getKeys();for(const n of r)n.startsWith(Ac)&&await this.client.core.storage.removeItem(n)}catch(r){this.logger.warn("Failed to cleanup storage",r)}}};var Bi={};const CU="https://secure.walletconnect.org/sdk",AU=(typeof process<"u"&&typeof Bi<"u"?Bi.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||CU,IU=(typeof process<"u"&&typeof Bi<"u"?Bi.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",SU=(typeof process<"u"&&typeof Bi<"u"?Bi.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",re={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},It={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},ys=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),it=Ye({...ys}),NU={state:it,subscribeKey(t,e){return Rt(it,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=ae.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){it.message=ys.message,it.variant=ys.variant,it.svg=ys.svg,it.open=ys.open,it.autoClose=ys.autoClose},_showMessage({message:t,svg:e,variant:r="success",autoClose:n=ys.autoClose}){it.open?(it.open=!1,setTimeout(()=>{it.message=t,it.variant=r,it.svg=e,it.open=!0,it.autoClose=n},150)):(it.message=t,it.variant=r,it.svg=e,it.open=!0,it.autoClose=n)}},kr=NU,Fo={getSIWX(){return F.state.siwx},async initializeIfEnabled(){var i;const t=F.state.siwx,e=P.getActiveCaipAddress();if(!(t&&e))return;const[r,n,s]=e.split(":");if(P.checkIfSupportedNetwork(r))try{if((await t.getSessions(`${r}:${n}`,s)).length)return;await tt.open({view:"SIWXSignMessage"})}catch(o){console.error("SIWXUtil:initializeIfEnabled",o),Ge.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((i=le._getClient())==null?void 0:i.disconnect().catch(console.error)),Ae.reset("Connect"),kr.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=F.state.siwx,e=ae.getPlainAddress(P.getActiveCaipAddress()),r=P.getActiveCaipNetwork(),n=le._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!r)throw new Error("No ActiveCaipNetwork or client found");if(!n)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:r.caipNetworkId,accountAddress:e}),i=s.toString();ee.getConnectorId(r.chainNamespace)===q.CONNECTOR_ID.AUTH&&Ae.pushTransactionStack({view:null,goBack:!1,replace:!0});const a=await n.signMessage(i);await t.addSession({data:s,message:i,signature:a}),tt.close(),Ge.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!tt.state.open||Ae.state.view==="ApproveTransaction")&&await tt.open({view:"SIWXSignMessage"}),i.isSmartAccount?kr.showError("This application might not support Smart Accounts"):kr.showError("Signature declined"),Ge.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var t;try{const e=this.getSIWX();((t=e==null?void 0:e.getRequired)==null?void 0:t.call(e))?await le.disconnect():tt.close(),Ae.reset("Connect"),Ge.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){const t=F.state.siwx,e=ae.getPlainAddress(P.getActiveCaipAddress()),r=P.getActiveCaipNetwork();return t&&e&&r?t.getSessions(r.caipNetworkId,e):[]},async isSIWXCloseDisabled(){var e;const t=this.getSIWX();if(t){const r=Ae.state.view==="ApproveTransaction",n=Ae.state.view==="SIWXSignMessage";if(r||n)return((e=t.getRequired)==null?void 0:e.call(t))&&(await this.getSessions()).length===0}return!1},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:r}){var a,c,u;const n=Fo.getSIWX(),s=new Set(e.map(l=>l.split(":")[0]));if(!n||s.size!==1||!s.has("eip155"))return!1;const i=await n.createMessage({chainId:((a=P.getActiveCaipNetwork())==null?void 0:a.caipNetworkId)||"",accountAddress:""}),o=await t.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:r,chains:[i.chainId,...e.filter(l=>l!==i.chainId)]});if(kr.showLoading("Authenticating...",{autoClose:!1}),ne.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:(c=o.session.peer.metadata.icons)==null?void 0:c[0],type:"WALLET_CONNECT"},Array.from(s)[0]),(u=o==null?void 0:o.auths)!=null&&u.length){const l=o.auths.map(d=>{const h=t.client.formatAuthMessage({request:d.p,iss:d.p.iss});return{data:{...d.p,accountAddress:d.p.iss.split(":").slice(-1).join(""),chainId:d.p.iss.split(":").slice(2,4).join(":"),uri:d.p.aud,version:d.p.version||i.version,expirationTime:d.p.exp,issuedAt:d.p.iat,notBefore:d.p.nbf},message:h,signature:d.s.s,cacao:d}});try{await n.setSessions(l),Ge.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Fo.getSIWXEventProperties()})}catch(d){throw console.error("SIWX:universalProviderAuth - failed to set sessions",d),Ge.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Fo.getSIWXEventProperties()}),await t.disconnect().catch(console.error),d}finally{kr.hide()}}return!0},getSIWXEventProperties(){var e,r;const t=P.state.activeChain;return{network:((e=P.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:((r=ne.state.preferredAccountTypes)==null?void 0:r[t])===It.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},We=Ye({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),TU={state:We,subscribe(t){return Bt(We,()=>t(We))},setLastNetworkInView(t){We.lastNetworkInView=t},async fetchTransactions(t,e){var r,n;if(!t)throw new Error("Transactions can't be fetched without an accountAddress");We.loading=!0;try{const s=await he.fetchTransactions({account:t,cursor:We.next,onramp:e,cache:e==="coinbase"?"no-cache":void 0,chainId:(r=P.state.activeCaipNetwork)==null?void 0:r.caipNetworkId}),i=$o.filterSpamTransactions(s.data),o=$o.filterByConnectedChain(i),a=[...We.transactions,...o];We.loading=!1,e==="coinbase"?We.coinbaseTransactions=$o.groupTransactionsByYearAndMonth(We.coinbaseTransactions,s.data):(We.transactions=a,We.transactionsByYear=$o.groupTransactionsByYearAndMonth(We.transactionsByYear,o)),We.empty=a.length===0,We.next=s.next?s.next:void 0}catch{const i=P.state.activeChain;Ge.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:F.state.projectId,cursor:We.next,isSmartAccount:((n=ne.state.preferredAccountTypes)==null?void 0:n[i])===It.ACCOUNT_TYPES.SMART_ACCOUNT}}),kr.showError("Failed to fetch transactions"),We.loading=!1,We.empty=!0,We.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const r=t;return e.forEach(n=>{const s=new Date(n.metadata.minedAt).getFullYear(),i=new Date(n.metadata.minedAt).getMonth(),o=r[s]??{},c=(o[i]??[]).filter(u=>u.id!==n.id);r[s]={...o,[i]:[...c,n].sort((u,l)=>new Date(l.metadata.minedAt).getTime()-new Date(u.metadata.minedAt).getTime())}}),r},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(n=>{var s;return((s=n.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(t){var n;const e=(n=P.state.activeCaipNetwork)==null?void 0:n.caipNetworkId;return t.filter(s=>s.metadata.chain===e)},clearCursor(){We.next=void 0},resetTransactions(){We.transactions=[],We.transactionsByYear={},We.lastNetworkInView=void 0,We.loading=!1,We.empty=!1,We.next=void 0}},$o=Cr(TU,"API_ERROR"),qe=Ye({connections:new Map,wcError:!1,buffering:!1,status:"disconnected"});let fs;const PU={state:qe,subscribeKey(t,e){return Rt(qe,t,e)},_getClient(){return qe._client},setClient(t){qe._client=Rs(t)},async connectWalletConnect(){var t,e,r,n;if(ae.isTelegram()||ae.isSafari()&&ae.isIos()){if(fs){await fs,fs=void 0;return}if(!ae.isPairingExpired(qe==null?void 0:qe.wcPairingExpiry)){const s=qe.wcUri;qe.wcUri=s;return}fs=(e=(t=le._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:e.call(t).catch(()=>{}),le.state.status="connecting",await fs,fs=void 0,qe.wcPairingExpiry=void 0,le.state.status="connected"}else await((n=(r=le._getClient())==null?void 0:r.connectWalletConnect)==null?void 0:n.call(r))},async connectExternal(t,e,r=!0){var n,s;await((s=(n=le._getClient())==null?void 0:n.connectExternal)==null?void 0:s.call(n,t)),r&&P.setActiveNamespace(e)},async reconnectExternal(t){var r,n;await((n=(r=le._getClient())==null?void 0:r.reconnectExternal)==null?void 0:n.call(r,t));const e=t.chain||P.state.activeChain;e&&ee.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){var n;tt.setLoading(!0,P.state.activeChain);const r=ee.getAuthConnector();r&&(ne.setPreferredAccountType(t,e),await r.provider.setPreferredAccount(t),Z.setPreferredAccountTypes(ne.state.preferredAccountTypes??{[e]:t}),await le.reconnectExternal(r),tt.setLoading(!1,P.state.activeChain),Ge.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:((n=P.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)||""}}))},async signMessage(t){var e;return(e=le._getClient())==null?void 0:e.signMessage(t)},parseUnits(t,e){var r;return(r=le._getClient())==null?void 0:r.parseUnits(t,e)},formatUnits(t,e){var r;return(r=le._getClient())==null?void 0:r.formatUnits(t,e)},async sendTransaction(t){var e;return(e=le._getClient())==null?void 0:e.sendTransaction(t)},async getCapabilities(t){var e;return(e=le._getClient())==null?void 0:e.getCapabilities(t)},async grantPermissions(t){var e;return(e=le._getClient())==null?void 0:e.grantPermissions(t)},async walletGetAssets(t){var e;return((e=le._getClient())==null?void 0:e.walletGetAssets(t))??{}},async estimateGas(t){var e;return(e=le._getClient())==null?void 0:e.estimateGas(t)},async writeContract(t){var e;return(e=le._getClient())==null?void 0:e.writeContract(t)},async getEnsAddress(t){var e;return(e=le._getClient())==null?void 0:e.getEnsAddress(t)},async getEnsAvatar(t){var e;return(e=le._getClient())==null?void 0:e.getEnsAvatar(t)},checkInstalled(t){var e,r;return((r=(e=le._getClient())==null?void 0:e.checkInstalled)==null?void 0:r.call(e,t))||!1},resetWcConnection(){qe.wcUri=void 0,qe.wcPairingExpiry=void 0,qe.wcLinking=void 0,qe.recentWallet=void 0,qe.status="disconnected",$o.resetTransactions(),Z.deleteWalletConnectDeepLink()},resetUri(){qe.wcUri=void 0,qe.wcPairingExpiry=void 0,fs=void 0},finalizeWcConnection(){var r,n;const{wcLinking:t,recentWallet:e}=le.state;t&&Z.setWalletConnectDeepLink(t),e&&Z.setAppKitRecent(e),Ge.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:t?"mobile":"qrcode",name:((n=(r=Ae.state.data)==null?void 0:r.wallet)==null?void 0:n.name)||"Unknown"}})},setWcBasic(t){qe.wcBasic=t},setUri(t){qe.wcUri=t,qe.wcPairingExpiry=ae.getPairingExpiry()},setWcLinking(t){qe.wcLinking=t},setWcError(t){qe.wcError=t,qe.buffering=!1},setRecentWallet(t){qe.recentWallet=t},setBuffering(t){qe.buffering=t},setStatus(t){qe.status=t},async disconnect(t){try{tt.setLoading(!0,t),await Fo.clearSessions(),await P.disconnect(t),tt.setLoading(!1,t),ee.setFilterByNamespace(void 0)}catch(e){throw new Yo("Failed to disconnect","INTERNAL_SDK_ERROR",e)}},setConnections(t,e){qe.connections.set(e,t)},switchAccount({connection:t,address:e,namespace:r}){if(ee.state.activeConnectorIds[r]===t.connectorId){const i=P.state.activeCaipNetwork;if(i){const o=`${r}:${i.id}:${e}`;ne.setCaipAddress(o,r)}else console.warn(`No current network found for namespace "${r}"`)}else{const i=ee.getConnector(t.connectorId);i?le.connectExternal(i,r):console.warn(`No connector found for namespace "${r}"`)}}},le=Cr(PU),vi=Ye({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),rn={state:vi,subscribe(t){return Bt(vi,()=>t(vi))},subscribeOpen(t){return Rt(vi,"open",t)},set(t){Object.assign(vi,{...vi,...t})}};function Ze(t,e,r){const n=t[e.name];if(typeof n=="function")return n;const s=t[r];return typeof s=="function"?s:i=>e(t,i)}function ns(t,{includeName:e=!1}={}){if(t.type!=="function"&&t.type!=="event"&&t.type!=="error")throw new jU(t.type);return`${t.name}(${Gu(t.inputs,{includeName:e})})`}function Gu(t,{includeName:e=!1}={}){return t?t.map(r=>xU(r,{includeName:e})).join(e?", ":","):""}function xU(t,{includeName:e}){return t.type.startsWith("tuple")?`(${Gu(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}function ss(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function ut(t){return ss(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const z0="2.30.1";let Ao={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:r})=>e?`${t??"https://viem.sh"}${e}${r?`#${r}`:""}`:void 0,version:`viem@${z0}`},j=class wh extends Error{constructor(e,r={}){var a;const n=(()=>{var c;return r.cause instanceof wh?r.cause.details:(c=r.cause)!=null&&c.message?r.cause.message:r.details})(),s=r.cause instanceof wh&&r.cause.docsPath||r.docsPath,i=(a=Ao.getDocsUrl)==null?void 0:a.call(Ao,{...r,docsPath:s}),o=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...n?[`Details: ${n}`]:[],...Ao.version?[`Version: ${Ao.version}`]:[]].join(`
`);super(o,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=n,this.docsPath=s,this.metaMessages=r.metaMessages,this.name=r.name??this.name,this.shortMessage=e,this.version=z0}walk(e){return H0(this,e)}};function H0(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?H0(t.cause,e):e?null:t}class OU extends j{constructor({docsPath:e}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:e,name:"AbiConstructorNotFoundError"})}}class ey extends j{constructor({docsPath:e}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class W0 extends j{constructor({data:e,params:r,size:n}){super([`Data size of ${n} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${Gu(r,{includeName:!0})})`,`Data:   ${e} (${n} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=r,this.size=n}}class Yu extends j{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class RU extends j{constructor({expectedLength:e,givenLength:r,type:n}){super([`ABI encoding array length mismatch for type ${n}.`,`Expected length: ${e}`,`Given length: ${r}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class $U extends j{constructor({expectedSize:e,value:r}){super(`Size of bytes "${r}" (bytes${ut(r)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class DU extends j{constructor({expectedLength:e,givenLength:r}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${r}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class Nj extends j{constructor(e,{docsPath:r}){super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:r,name:"AbiErrorInputsNotFoundError"})}}class Tj extends j{constructor(e,{docsPath:r}={}){super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:r,name:"AbiErrorNotFoundError"})}}class V0 extends j{constructor(e,{docsPath:r}){super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:r,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class kU extends j{constructor({docsPath:e}){super("Cannot extract event signature from empty topics.",{docsPath:e,name:"AbiEventSignatureEmptyTopicsError"})}}class K0 extends j{constructor(e,{docsPath:r}){super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:r,name:"AbiEventSignatureNotFoundError"})}}class cu extends j{constructor(e,{docsPath:r}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:r,name:"AbiFunctionNotFoundError"})}}class UU extends j{constructor(e,{docsPath:r}){super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:r,name:"AbiFunctionOutputsNotFoundError"})}}class Pj extends j{constructor(e,{docsPath:r}){super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:r,name:"AbiFunctionSignatureNotFoundError"})}}class LU extends j{constructor(e,r){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${ns(e.abiItem)}\`, and`,`\`${r.type}\` in \`${ns(r.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class bh extends j{constructor({abiItem:e,data:r,params:n,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${Gu(n,{includeName:!0})})`,`Data:   ${r} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e,this.data=r,this.params=n,this.size=s}}class G0 extends j{constructor({abiItem:e,param:r}){super([`Expected a topic for indexed event parameter${r.name?` "${r.name}"`:""} on event "${ns(e,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e}}class MU extends j{constructor(e,{docsPath:r}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:r,name:"InvalidAbiEncodingType"})}}class BU extends j{constructor(e,{docsPath:r}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:r,name:"InvalidAbiDecodingType"})}}class FU extends j{constructor(e){super([`Value "${e}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class jU extends j{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class Y0 extends j{constructor({offset:e,position:r,size:n}){super(`Slice ${r==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${n}).`,{name:"SliceOffsetOutOfBoundsError"})}}let Z0=class extends j{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (${e}) exceeds padding size (${r}).`,{name:"SizeExceedsPaddingSizeError"})}};class ty extends j{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} is expected to be ${r} ${n} long, but is ${e} ${n} long.`,{name:"InvalidBytesLengthError"})}}function io(t,{dir:e,size:r=32}={}){return typeof t=="string"?Xn(t,{dir:e,size:r}):qU(t,{dir:e,size:r})}function Xn(t,{dir:e,size:r=32}={}){if(r===null)return t;const n=t.replace("0x","");if(n.length>r*2)throw new Z0({size:Math.ceil(n.length/2),targetSize:r,type:"hex"});return`0x${n[e==="right"?"padEnd":"padStart"](r*2,"0")}`}function qU(t,{dir:e,size:r=32}={}){if(r===null)return t;if(t.length>r)throw new Z0({size:t.length,targetSize:r,type:"bytes"});const n=new Uint8Array(r);for(let s=0;s<r;s++){const i=e==="right";n[i?s:r-s-1]=t[i?s:t.length-s-1]}return n}let J0=class extends j{constructor({max:e,min:r,signed:n,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${n?"signed":"unsigned"} `:""}integer range ${e?`(${r} to ${e})`:`(above ${r})`}`,{name:"IntegerOutOfRangeError"})}};class zU extends j{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class HU extends j{constructor({givenSize:e,maxSize:r}){super(`Size cannot exceed ${r} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function nc(t,{dir:e="left"}={}){let r=typeof t=="string"?t.replace("0x",""):t,n=0;for(let s=0;s<r.length-1&&r[e==="left"?s:r.length-s-1].toString()==="0";s++)n++;return r=e==="left"?r.slice(n):r.slice(0,r.length-n),typeof t=="string"?(r.length===1&&e==="right"&&(r=`${r}0`),`0x${r.length%2===1?`0${r}`:r}`):r}function zr(t,{size:e}){if(ut(t)>e)throw new HU({givenSize:ut(t),maxSize:e})}function Fi(t,e={}){const{signed:r}=e;e.size&&zr(t,{size:e.size});const n=BigInt(t);if(!r)return n;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return n<=i?n:n-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function Fs(t,e={}){return Number(Fi(t,e))}function X0(t,e={}){let r=sn(t);return e.size&&(zr(r,{size:e.size}),r=nc(r,{dir:"right"})),new TextDecoder().decode(r)}const WU=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ji(t,e={}){return typeof t=="number"||typeof t=="bigint"?Ee(t,e):typeof t=="string"?Zu(t,e):typeof t=="boolean"?Q0(t,e):Xt(t,e)}function Q0(t,e={}){const r=`0x${Number(t)}`;return typeof e.size=="number"?(zr(r,{size:e.size}),io(r,{size:e.size})):r}function Xt(t,e={}){let r="";for(let s=0;s<t.length;s++)r+=WU[t[s]];const n=`0x${r}`;return typeof e.size=="number"?(zr(n,{size:e.size}),io(n,{dir:"right",size:e.size})):n}function Ee(t,e={}){const{signed:r,size:n}=e,s=BigInt(t);let i;n?r?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&r?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new J0({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:r,size:n,value:`${t}${c}`})}const a=`0x${(r&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?io(a,{size:n}):a}const VU=new TextEncoder;function Zu(t,e={}){const r=VU.encode(t);return Xt(r,e)}const KU=new TextEncoder;function Ju(t,e={}){return typeof t=="number"||typeof t=="bigint"?YU(t,e):typeof t=="boolean"?GU(t,e):ss(t)?sn(t,e):ev(t,e)}function GU(t,e={}){const r=new Uint8Array(1);return r[0]=Number(t),typeof e.size=="number"?(zr(r,{size:e.size}),io(r,{size:e.size})):r}const bn={zero:48,nine:57,A:65,F:70,a:97,f:102};function ry(t){if(t>=bn.zero&&t<=bn.nine)return t-bn.zero;if(t>=bn.A&&t<=bn.F)return t-(bn.A-10);if(t>=bn.a&&t<=bn.f)return t-(bn.a-10)}function sn(t,e={}){let r=t;e.size&&(zr(r,{size:e.size}),r=io(r,{dir:"right",size:e.size}));let n=r.slice(2);n.length%2&&(n=`0${n}`);const s=n.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=ry(n.charCodeAt(a++)),u=ry(n.charCodeAt(a++));if(c===void 0||u===void 0)throw new j(`Invalid byte sequence ("${n[a-2]}${n[a-1]}" in "${n}").`);i[o]=c*16+u}return i}function YU(t,e){const r=Ee(t,e);return sn(r)}function ev(t,e={}){const r=KU.encode(t);return typeof e.size=="number"?(zr(r,{size:e.size}),io(r,{dir:"right",size:e.size})):r}function sc(t,e){const r=e||"hex",n=IT(ss(t,{strict:!1})?Ju(t):t);return r==="bytes"?n:ji(n)}const ZU=t=>sc(Ju(t));function JU(t){return ZU(t)}function XU(t){let e=!0,r="",n=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&n++,a===")"&&n--,!!e){if(n===0){if(a===" "&&["event","function",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&r!==","&&r!==",("&&(r="",e=!1);continue}s+=a,r+=a}}if(!i)throw new j("Unable to normalize signature.");return s}const QU=t=>{const e=typeof t=="string"?t:CS(t);return XU(e)};function tv(t){return JU(QU(t))}const gf=tv;class js extends j{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}class Xu extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const r=super.get(e);return super.has(e)&&r!==void 0&&(this.delete(e),super.set(e,r)),r}set(e,r){if(super.set(e,r),this.maxSize&&this.size>this.maxSize){const n=this.keys().next().value;n&&this.delete(n)}return this}}const ad=new Xu(8192);function Qu(t,e){if(ad.has(`${t}.${e}`))return ad.get(`${t}.${e}`);const r=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),n=sc(ev(r),"bytes"),s=(e?r.substring(`${e}0x`.length):r).split("");for(let o=0;o<40;o+=2)n[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(n[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return ad.set(`${t}.${e}`,i),i}function As(t,e){if(!on(t,{strict:!1}))throw new js({address:t});return Qu(t,e)}const e8=/^0x[a-fA-F0-9]{40}$/,cd=new Xu(8192);function on(t,e){const{strict:r=!0}=e??{},n=`${t}.${r}`;if(cd.has(n))return cd.get(n);const s=e8.test(t)?t.toLowerCase()===t?!0:r?Qu(t)===t:!0:!1;return cd.set(n,s),s}function qi(t){return typeof t[0]=="string"?el(t):t8(t)}function t8(t){let e=0;for(const s of t)e+=s.length;const r=new Uint8Array(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return r}function el(t){return`0x${t.reduce((e,r)=>e+r.replace("0x",""),"")}`}function uu(t,e,r,{strict:n}={}){return ss(t,{strict:!1})?r8(t,e,r,{strict:n}):sv(t,e,r,{strict:n})}function rv(t,e){if(typeof e=="number"&&e>0&&e>ut(t)-1)throw new Y0({offset:e,position:"start",size:ut(t)})}function nv(t,e,r){if(typeof e=="number"&&typeof r=="number"&&ut(t)!==r-e)throw new Y0({offset:r,position:"end",size:ut(t)})}function sv(t,e,r,{strict:n}={}){rv(t,e);const s=t.slice(e,r);return n&&nv(s,e,r),s}function r8(t,e,r,{strict:n}={}){rv(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(r??t.length)*2)}`;return n&&nv(s,e,r),s}const n8=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function iv(t,e){if(t.length!==e.length)throw new DU({expectedLength:t.length,givenLength:e.length});const r=s8({params:t,values:e}),n=yf(r);return n.length===0?"0x":n}function s8({params:t,values:e}){const r=[];for(let n=0;n<t.length;n++)r.push(mf({param:t[n],value:e[n]}));return r}function mf({param:t,value:e}){const r=wf(t.type);if(r){const[n,s]=r;return o8(e,{length:n,param:{...t,type:s}})}if(t.type==="tuple")return d8(e,{param:t});if(t.type==="address")return i8(e);if(t.type==="bool")return c8(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const n=t.type.startsWith("int"),[,,s="256"]=n8.exec(t.type)??[];return u8(e,{signed:n,size:Number(s)})}if(t.type.startsWith("bytes"))return a8(e,{param:t});if(t.type==="string")return l8(e);throw new MU(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function yf(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=ut(a)}const r=[],n=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(r.push(Ee(e+s,{size:32})),n.push(a),s+=ut(a)):r.push(a)}return qi([...r,...n])}function i8(t){if(!on(t))throw new js({address:t});return{dynamic:!1,encoded:Xn(t.toLowerCase())}}function o8(t,{length:e,param:r}){const n=e===null;if(!Array.isArray(t))throw new FU(t);if(!n&&t.length!==e)throw new RU({expectedLength:e,givenLength:t.length,type:`${r.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=mf({param:r,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(n||s){const o=yf(i);if(n){const a=Ee(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?qi([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:qi(i.map(({encoded:o})=>o))}}function a8(t,{param:e}){const[,r]=e.type.split("bytes"),n=ut(t);if(!r){let s=t;return n%32!==0&&(s=Xn(s,{dir:"right",size:Math.ceil((t.length-2)/2/32)*32})),{dynamic:!0,encoded:qi([Xn(Ee(n,{size:32})),s])}}if(n!==Number.parseInt(r))throw new $U({expectedSize:Number.parseInt(r),value:t});return{dynamic:!1,encoded:Xn(t,{dir:"right"})}}function c8(t){if(typeof t!="boolean")throw new j(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:Xn(Q0(t))}}function u8(t,{signed:e,size:r=256}){if(typeof r=="number"){const n=2n**(BigInt(r)-(e?1n:0n))-1n,s=e?-n-1n:0n;if(t>n||t<s)throw new J0({max:n.toString(),min:s.toString(),signed:e,size:r/8,value:t.toString()})}return{dynamic:!1,encoded:Ee(t,{size:32,signed:e})}}function l8(t){const e=Zu(t),r=Math.ceil(ut(e)/32),n=[];for(let s=0;s<r;s++)n.push(Xn(uu(e,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:qi([Xn(Ee(ut(e),{size:32})),...n])}}function d8(t,{param:e}){let r=!1;const n=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],o=Array.isArray(t)?s:i.name,a=mf({param:i,value:t[o]});n.push(a),a.dynamic&&(r=!0)}return{dynamic:r,encoded:r?yf(n):qi(n.map(({encoded:s})=>s))}}function wf(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}const bf=t=>uu(tv(t),0,4);function vf(t){const{abi:e,args:r=[],name:n}=t,s=ss(n,{strict:!1}),i=e.filter(a=>s?a.type==="function"?bf(a)===n:a.type==="event"?gf(a)===n:!1:"name"in a&&a.name===n);if(i.length===0)return;if(i.length===1)return i[0];let o;for(const a of i){if(!("inputs"in a))continue;if(!r||r.length===0){if(!a.inputs||a.inputs.length===0)return a;continue}if(!a.inputs||a.inputs.length===0||a.inputs.length!==r.length)continue;if(r.every((u,l)=>{const d="inputs"in a&&a.inputs[l];return d?vh(u,d):!1})){if(o&&"inputs"in o&&o.inputs){const u=ov(a.inputs,o.inputs,r);if(u)throw new LU({abiItem:a,type:u[0]},{abiItem:o,type:u[1]})}o=a}}return o||i[0]}function vh(t,e){const r=typeof t,n=e.type;switch(n){case"address":return on(t,{strict:!1});case"bool":return r==="boolean";case"function":return r==="string";case"string":return r==="string";default:return n==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>vh(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(n)?r==="number"||r==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(n)?r==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(n)?Array.isArray(t)&&t.every(s=>vh(s,{...e,type:n.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function ov(t,e,r){for(const n in t){const s=t[n],i=e[n];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return ov(s.components,i.components,r[n]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?on(r[n],{strict:!1}):o.includes("address")&&o.includes("bytes")?on(r[n],{strict:!1}):!1)return o}}function h8(t,{method:e}){var n,s;const r={};return t.transport.type==="fallback"&&((s=(n=t.transport).onResponse)==null||s.call(n,({method:i,response:o,status:a,transport:c})=>{a==="success"&&e===i&&(r[o]=c.request)})),i=>r[i]||t.request}function ln(t){return typeof t=="string"?{address:t,type:"json-rpc"}:t}const ny="/docs/contract/encodeFunctionData";function f8(t){const{abi:e,args:r,functionName:n}=t;let s=e[0];if(n){const i=vf({abi:e,args:r,name:n});if(!i)throw new cu(n,{docsPath:ny});s=i}if(s.type!=="function")throw new cu(void 0,{docsPath:ny});return{abi:[s],functionName:bf(ns(s))}}function tl(t){const{args:e}=t,{abi:r,functionName:n}=(()=>{var a;return t.abi.length===1&&((a=t.functionName)!=null&&a.startsWith("0x"))?t:f8(t)})(),s=r[0],i=n,o="inputs"in s&&s.inputs?iv(s.inputs,e??[]):void 0;return el([i,o??"0x"])}const p8={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},g8={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},m8={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};class sy extends j{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class av extends j{constructor({length:e,position:r}){super(`Position \`${r}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class y8 extends j{constructor({count:e,limit:r}){super(`Recursive read limit of \`${r}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}const w8={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new y8({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new av({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new sy({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new sy({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const r=e??this.position;return this.assertPosition(r+t-1),this.bytes.subarray(r,r+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const r=this.inspectBytes(t);return this.position+=e??t,r},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function Ef(t,{recursiveReadLimit:e=8192}={}){const r=Object.create(w8);return r.bytes=t,r.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),r.positionReadCount=new Map,r.recursiveReadLimit=e,r}function b8(t,e={}){typeof e.size<"u"&&zr(t,{size:e.size});const r=Xt(t,e);return Fi(r,e)}function v8(t,e={}){let r=t;if(typeof e.size<"u"&&(zr(r,{size:e.size}),r=nc(r)),r.length>1||r[0]>1)throw new zU(r);return!!r[0]}function Nn(t,e={}){typeof e.size<"u"&&zr(t,{size:e.size});const r=Xt(t,e);return Fs(r,e)}function E8(t,e={}){let r=t;return typeof e.size<"u"&&(zr(r,{size:e.size}),r=nc(r,{dir:"right"})),new TextDecoder().decode(r)}function rl(t,e){const r=typeof e=="string"?sn(e):e,n=Ef(r);if(ut(r)===0&&t.length>0)throw new Yu;if(ut(e)&&ut(e)<32)throw new W0({data:typeof e=="string"?e:Xt(e),params:t,size:ut(e)});let s=0;const i=[];for(let o=0;o<t.length;++o){const a=t[o];n.setPosition(s);const[c,u]=Ti(n,a,{staticPosition:0});s+=u,i.push(c)}return i}function Ti(t,e,{staticPosition:r}){const n=wf(e.type);if(n){const[s,i]=n;return C8(t,{...e,type:i},{length:s,staticPosition:r})}if(e.type==="tuple")return N8(t,e,{staticPosition:r});if(e.type==="address")return _8(t);if(e.type==="bool")return A8(t);if(e.type.startsWith("bytes"))return I8(t,e,{staticPosition:r});if(e.type.startsWith("uint")||e.type.startsWith("int"))return S8(t,e);if(e.type==="string")return T8(t,{staticPosition:r});throw new BU(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const iy=32,Eh=32;function _8(t){const e=t.readBytes(32);return[Qu(Xt(sv(e,-20))),32]}function C8(t,e,{length:r,staticPosition:n}){if(!r){const o=Nn(t.readBytes(Eh)),a=n+o,c=a+iy;t.setPosition(a);const u=Nn(t.readBytes(iy)),l=ia(e);let d=0;const h=[];for(let f=0;f<u;++f){t.setPosition(c+(l?f*32:d));const[p,g]=Ti(t,e,{staticPosition:c});d+=g,h.push(p)}return t.setPosition(n+32),[h,32]}if(ia(e)){const o=Nn(t.readBytes(Eh)),a=n+o,c=[];for(let u=0;u<r;++u){t.setPosition(a+u*32);const[l]=Ti(t,e,{staticPosition:a});c.push(l)}return t.setPosition(n+32),[c,32]}let s=0;const i=[];for(let o=0;o<r;++o){const[a,c]=Ti(t,e,{staticPosition:n+s});s+=c,i.push(a)}return[i,s]}function A8(t){return[v8(t.readBytes(32),{size:32}),32]}function I8(t,e,{staticPosition:r}){const[n,s]=e.type.split("bytes");if(!s){const o=Nn(t.readBytes(32));t.setPosition(r+o);const a=Nn(t.readBytes(32));if(a===0)return t.setPosition(r+32),["0x",32];const c=t.readBytes(a);return t.setPosition(r+32),[Xt(c),32]}return[Xt(t.readBytes(Number.parseInt(s),32)),32]}function S8(t,e){const r=e.type.startsWith("int"),n=Number.parseInt(e.type.split("int")[1]||"256"),s=t.readBytes(32);return[n>48?b8(s,{signed:r}):Nn(s,{signed:r}),32]}function N8(t,e,{staticPosition:r}){const n=e.components.length===0||e.components.some(({name:o})=>!o),s=n?[]:{};let i=0;if(ia(e)){const o=Nn(t.readBytes(Eh)),a=r+o;for(let c=0;c<e.components.length;++c){const u=e.components[c];t.setPosition(a+i);const[l,d]=Ti(t,u,{staticPosition:a});i+=d,s[n?c:u==null?void 0:u.name]=l}return t.setPosition(r+32),[s,32]}for(let o=0;o<e.components.length;++o){const a=e.components[o],[c,u]=Ti(t,a,{staticPosition:r});s[n?o:a==null?void 0:a.name]=c,i+=u}return[s,i]}function T8(t,{staticPosition:e}){const r=Nn(t.readBytes(32)),n=e+r;t.setPosition(n);const s=Nn(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=E8(nc(i));return t.setPosition(e+32),[o,32]}function ia(t){var n;const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return(n=t.components)==null?void 0:n.some(ia);const r=wf(t.type);return!!(r&&ia({...t,type:r[1]}))}function P8(t){const{abi:e,data:r}=t,n=uu(r,0,4);if(n==="0x")throw new Yu;const i=[...e||[],g8,m8].find(o=>o.type==="error"&&n===bf(ns(o)));if(!i)throw new V0(n,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:i,args:"inputs"in i&&i.inputs&&i.inputs.length>0?rl(i.inputs,uu(r,4)):void 0,errorName:i.name}}const Er=(t,e,r)=>JSON.stringify(t,(n,s)=>typeof s=="bigint"?s.toString():s,r);function cv({abiItem:t,args:e,includeFunctionName:r=!0,includeName:n=!1}){if("name"in t&&"inputs"in t&&t.inputs)return`${r?t.name:""}(${t.inputs.map((s,i)=>`${n&&s.name?`${s.name}: `:""}${typeof e[i]=="object"?Er(e[i]):e[i]}`).join(", ")})`}const x8={gwei:9,wei:18},O8={ether:-9,wei:9},R8={ether:-18,gwei:-9};function oo(t,e){let r=t.toString();const n=r.startsWith("-");n&&(r=r.slice(1)),r=r.padStart(e,"0");let[s,i]=[r.slice(0,r.length-e),r.slice(r.length-e)];return i=i.replace(/(0+)$/,""),`${n?"-":""}${s||"0"}${i?`.${i}`:""}`}function _f(t,e="wei"){return oo(t,x8[e])}function Jt(t,e="wei"){return oo(t,O8[e])}class $8 extends j{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class D8 extends j{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function oy(t){return t.reduce((e,{slot:r,value:n})=>`${e}        ${r}: ${n}
`,"")}function k8(t){return t.reduce((e,{address:r,...n})=>{let s=`${e}    ${r}:
`;return n.nonce&&(s+=`      nonce: ${n.nonce}
`),n.balance&&(s+=`      balance: ${n.balance}
`),n.code&&(s+=`      code: ${n.code}
`),n.state&&(s+=`      state:
`,s+=oy(n.state)),n.stateDiff&&(s+=`      stateDiff:
`,s+=oy(n.stateDiff)),s},`  State Override:
`).slice(0,-1)}function ic(t){const e=Object.entries(t).map(([n,s])=>s===void 0||s===!1?null:[n,s]).filter(Boolean),r=e.reduce((n,[s])=>Math.max(n,s.length),0);return e.map(([n,s])=>`  ${`${n}:`.padEnd(r+1)}  ${s}`).join(`
`)}class U8 extends j{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`),{name:"FeeConflictError"})}}class L8 extends j{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",ic(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class M8 extends j{constructor(e,{account:r,docsPath:n,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:h}){var p;const f=ic({chain:s&&`${s==null?void 0:s.name} (id: ${s==null?void 0:s.id})`,from:r==null?void 0:r.address,to:d,value:typeof h<"u"&&`${_f(h)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${Jt(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${Jt(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${Jt(u)} gwei`,nonce:l});super(e.shortMessage,{cause:e,docsPath:n,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",f].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class uv extends j{constructor({blockHash:e,blockNumber:r,blockTag:n,hash:s,index:i}){let o="Transaction";n&&i!==void 0&&(o=`Transaction at block time "${n}" at index "${i}"`),e&&i!==void 0&&(o=`Transaction at block hash "${e}" at index "${i}"`),r&&i!==void 0&&(o=`Transaction at block number "${r}" at index "${i}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`,{name:"TransactionNotFoundError"})}}class lv extends j{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class B8 extends j{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}const F8=t=>t,Cf=t=>t;class j8 extends j{constructor(e,{account:r,docsPath:n,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:h,stateOverride:f}){var m;const p=r?ln(r):void 0;let g=ic({from:p==null?void 0:p.address,to:d,value:typeof h<"u"&&`${_f(h)} ${((m=s==null?void 0:s.nativeCurrency)==null?void 0:m.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${Jt(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${Jt(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${Jt(u)} gwei`,nonce:l});f&&(g+=`
${k8(f)}`),super(e.shortMessage,{cause:e,docsPath:n,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",g].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class dv extends j{constructor(e,{abi:r,args:n,contractAddress:s,docsPath:i,functionName:o,sender:a}){const c=vf({abi:r,args:n,name:o}),u=c?cv({abiItem:c,args:n,includeFunctionName:!1,includeName:!1}):void 0,l=c?ns(c,{includeName:!0}):void 0,d=ic({address:s&&F8(s),function:l,args:u&&u!=="()"&&`${[...Array((o==null?void 0:o.length)??0).keys()].map(()=>" ").join("")}${u}`,sender:a});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],d&&"Contract Call:",d].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=r,this.args=n,this.cause=e,this.contractAddress=s,this.functionName=o,this.sender=a}}class q8 extends j{constructor({abi:e,data:r,functionName:n,message:s}){let i,o,a,c;if(r&&r!=="0x")try{o=P8({abi:e,data:r});const{abiItem:l,errorName:d,args:h}=o;if(d==="Error")c=h[0];else if(d==="Panic"){const[f]=h;c=p8[f]}else{const f=l?ns(l,{includeName:!0}):void 0,p=l&&h?cv({abiItem:l,args:h,includeFunctionName:!1,includeName:!1}):void 0;a=[f?`Error: ${f}`:"",p&&p!=="()"?`       ${[...Array((d==null?void 0:d.length)??0).keys()].map(()=>" ").join("")}${p}`:""]}}catch(l){i=l}else s&&(c=s);let u;i instanceof V0&&(u=i.signature,a=[`Unable to decode signature "${u}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${u}.`]),super(c&&c!=="execution reverted"||u?[`The contract function "${n}" reverted with the following ${u?"signature":"reason"}:`,c||u].join(`
`):`The contract function "${n}" reverted.`,{cause:i,metaMessages:a,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.raw=r,this.reason=c,this.signature=u}}class z8 extends j{constructor({functionName:e}){super(`The contract function "${e}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${e}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class H8 extends j{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class Af extends j{constructor({data:e,message:r}){super(r||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}class jo extends j{constructor({body:e,cause:r,details:n,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:r,details:n,metaMessages:[i&&`Status: ${i}`,`URL: ${Cf(o)}`,e&&`Request body: ${Er(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class If extends j{constructor({body:e,error:r,url:n}){super("RPC Request failed.",{cause:r,details:r.message,metaMessages:[`URL: ${Cf(n)}`,`Request body: ${Er(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=r.code,this.data=r.data}}class ay extends j{constructor({body:e,url:r}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${Cf(r)}`,`Request body: ${Er(e)}`],name:"TimeoutError"})}}const W8=-1;class er extends j{constructor(e,{code:r,docsPath:n,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:n,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof If?e.code:r??W8}}class lr extends er{constructor(e,r){super(e,r),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=r.data}}class oa extends er{constructor(e){super(e,{code:oa.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(oa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class aa extends er{constructor(e){super(e,{code:aa.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(aa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class ca extends er{constructor(e,{method:r}={}){super(e,{code:ca.code,name:"MethodNotFoundRpcError",shortMessage:`The method${r?` "${r}"`:""} does not exist / is not available.`})}}Object.defineProperty(ca,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class ua extends er{constructor(e){super(e,{code:ua.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(ua,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class qs extends er{constructor(e){super(e,{code:qs.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(qs,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class la extends er{constructor(e){super(e,{code:la.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(la,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class da extends er{constructor(e){super(e,{code:da.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(da,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Qn extends er{constructor(e){super(e,{code:Qn.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Qn,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class zi extends er{constructor(e){super(e,{code:zi.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(zi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class Is extends er{constructor(e,{method:r}={}){super(e,{code:Is.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${r?` "${r}"`:""} is not supported.`})}}Object.defineProperty(Is,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Hi extends er{constructor(e){super(e,{code:Hi.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Hi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class ha extends er{constructor(e){super(e,{code:ha.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(ha,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class at extends lr{constructor(e){super(e,{code:at.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(at,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class fa extends lr{constructor(e){super(e,{code:fa.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(fa,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class pa extends lr{constructor(e,{method:r}={}){super(e,{code:pa.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${r?` " ${r}"`:""}.`})}}Object.defineProperty(pa,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class ga extends lr{constructor(e){super(e,{code:ga.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(ga,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class ma extends lr{constructor(e){super(e,{code:ma.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(ma,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class an extends lr{constructor(e){super(e,{code:an.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(an,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class ya extends lr{constructor(e){super(e,{code:ya.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(ya,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class wa extends lr{constructor(e){super(e,{code:wa.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(wa,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class ba extends lr{constructor(e){super(e,{code:ba.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(ba,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class va extends lr{constructor(e){super(e,{code:va.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(va,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Ea extends lr{constructor(e){super(e,{code:Ea.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Ea,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class _a extends lr{constructor(e){super(e,{code:_a.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(_a,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class Ca extends lr{constructor(e){super(e,{code:Ca.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(Ca,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class V8 extends er{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const K8=3;function lu(t,{abi:e,address:r,args:n,docsPath:s,functionName:i,sender:o}){const a=t instanceof Af?t:t instanceof j?t.walk(p=>"data"in p)||t.walk():{},{code:c,data:u,details:l,message:d,shortMessage:h}=a,f=t instanceof Yu?new z8({functionName:i}):[K8,qs.code].includes(c)&&(u||l||d||h)?new q8({abi:e,data:typeof u=="object"?u.data:u,functionName:i,message:a instanceof If?l:h??d}):t;return new dv(f,{abi:e,args:n,contractAddress:r,docsPath:s,functionName:i,sender:o})}function G8(t){const e=sc(`0x${t.substring(4)}`).substring(26);return Qu(`0x${e}`)}async function Y8({hash:t,signature:e}){const r=ss(t)?t:ji(t),{secp256k1:n}=await Ut(async()=>{const{secp256k1:o}=await import("./BXfA-j66.js");return{secp256k1:o}},[],import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:l,v:d,yParity:h}=e,f=Number(h??d),p=cy(f);return new n.Signature(Fi(u),Fi(l)).addRecoveryBit(p)}const o=ss(e)?e:ji(e);if(ut(o)!==65)throw new Error("invalid signature length");const a=Fs(`0x${o.slice(130)}`),c=cy(a);return n.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(r.substring(2)).toHex(!1)}`}function cy(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function Z8({hash:t,signature:e}){return G8(await Y8({hash:t,signature:e}))}function J8(t,e="hex"){const r=hv(t),n=Ef(new Uint8Array(r.length));return r.encode(n),e==="hex"?Xt(n.bytes):n.bytes}function hv(t){return Array.isArray(t)?X8(t.map(e=>hv(e))):Q8(t)}function X8(t){const e=t.reduce((s,i)=>s+i.length,0),r=fv(e);return{length:e<=55?1+e:1+r+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+r),r===1?s.pushUint8(e):r===2?s.pushUint16(e):r===3?s.pushUint24(e):s.pushUint32(e));for(const{encode:i}of t)i(s)}}}function Q8(t){const e=typeof t=="string"?sn(t):t,r=fv(e.length);return{length:e.length===1&&e[0]<128?1:e.length<=55?1+e.length:1+r+e.length,encode(s){e.length===1&&e[0]<128?s.pushBytes(e):e.length<=55?(s.pushByte(128+e.length),s.pushBytes(e)):(s.pushByte(183+r),r===1?s.pushUint8(e.length):r===2?s.pushUint16(e.length):r===3?s.pushUint24(e.length):s.pushUint32(e.length),s.pushBytes(e))}}}function fv(t){if(t<2**8)return 1;if(t<2**16)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new j("Length is too large.")}function e6(t){const{chainId:e,nonce:r,to:n}=t,s=t.contractAddress??t.address,i=sc(el(["0x05",J8([e?Ee(e):"0x",s,r?Ee(r):"0x"])]));return n==="bytes"?sn(i):i}async function pv(t){const{authorization:e,signature:r}=t;return Z8({hash:e6(e),signature:r??e})}class t6 extends j{constructor(e,{account:r,docsPath:n,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:h}){var p;const f=ic({from:r==null?void 0:r.address,to:d,value:typeof h<"u"&&`${_f(h)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${Jt(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${Jt(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${Jt(u)} gwei`,nonce:l});super(e.shortMessage,{cause:e,docsPath:n,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",f].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Ss extends j{constructor({cause:e,message:r}={}){var s;const n=(s=r==null?void 0:r.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${n?`with reason: ${n}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(Ss,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Ss,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class du extends j{constructor({cause:e,maxFeePerGas:r}={}){super(`The fee cap (\`maxFeePerGas\`${r?` = ${Jt(r)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(du,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class _h extends j{constructor({cause:e,maxFeePerGas:r}={}){super(`The fee cap (\`maxFeePerGas\`${r?` = ${Jt(r)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(_h,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class Ch extends j{constructor({cause:e,nonce:r}={}){super(`Nonce provided for the transaction ${r?`(${r}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(Ch,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class Ah extends j{constructor({cause:e,nonce:r}={}){super([`Nonce provided for the transaction ${r?`(${r}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(Ah,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class Ih extends j{constructor({cause:e,nonce:r}={}){super(`Nonce provided for the transaction ${r?`(${r}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(Ih,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class Sh extends j{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(Sh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class Nh extends j{constructor({cause:e,gas:r}={}){super(`The amount of gas ${r?`(${r}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(Nh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class Th extends j{constructor({cause:e,gas:r}={}){super(`The amount of gas ${r?`(${r}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(Th,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class Ph extends j{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(Ph,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class hu extends j{constructor({cause:e,maxPriorityFeePerGas:r,maxFeePerGas:n}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${r?` = ${Jt(r)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${n?` = ${Jt(n)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(hu,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class nl extends j{constructor({cause:e}){super(`An error occurred while executing: ${e==null?void 0:e.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}function Sf(t,e){const r=(t.details||"").toLowerCase(),n=t instanceof j?t.walk(s=>(s==null?void 0:s.code)===Ss.code):t;return n instanceof j?new Ss({cause:t,message:n.details}):Ss.nodeMessage.test(r)?new Ss({cause:t,message:t.details}):du.nodeMessage.test(r)?new du({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):_h.nodeMessage.test(r)?new _h({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):Ch.nodeMessage.test(r)?new Ch({cause:t,nonce:e==null?void 0:e.nonce}):Ah.nodeMessage.test(r)?new Ah({cause:t,nonce:e==null?void 0:e.nonce}):Ih.nodeMessage.test(r)?new Ih({cause:t,nonce:e==null?void 0:e.nonce}):Sh.nodeMessage.test(r)?new Sh({cause:t}):Nh.nodeMessage.test(r)?new Nh({cause:t,gas:e==null?void 0:e.gas}):Th.nodeMessage.test(r)?new Th({cause:t,gas:e==null?void 0:e.gas}):Ph.nodeMessage.test(r)?new Ph({cause:t}):hu.nodeMessage.test(r)?new hu({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas,maxPriorityFeePerGas:e==null?void 0:e.maxPriorityFeePerGas}):new nl({cause:t})}function r6(t,{docsPath:e,...r}){const n=(()=>{const s=Sf(t,r);return s instanceof nl?t:s})();return new t6(n,{docsPath:e,...r})}function Nf(t,{format:e}){if(!e)return{};const r={};function n(i){const o=Object.keys(i);for(const a of o)a in t&&(r[a]=t[a]),i[a]&&typeof i[a]=="object"&&!Array.isArray(i[a])&&n(i[a])}const s=e(t||{});return n(s),r}const n6={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function Tf(t){const e={};return typeof t.authorizationList<"u"&&(e.authorizationList=s6(t.authorizationList)),typeof t.accessList<"u"&&(e.accessList=t.accessList),typeof t.blobVersionedHashes<"u"&&(e.blobVersionedHashes=t.blobVersionedHashes),typeof t.blobs<"u"&&(typeof t.blobs[0]!="string"?e.blobs=t.blobs.map(r=>Xt(r)):e.blobs=t.blobs),typeof t.data<"u"&&(e.data=t.data),typeof t.from<"u"&&(e.from=t.from),typeof t.gas<"u"&&(e.gas=Ee(t.gas)),typeof t.gasPrice<"u"&&(e.gasPrice=Ee(t.gasPrice)),typeof t.maxFeePerBlobGas<"u"&&(e.maxFeePerBlobGas=Ee(t.maxFeePerBlobGas)),typeof t.maxFeePerGas<"u"&&(e.maxFeePerGas=Ee(t.maxFeePerGas)),typeof t.maxPriorityFeePerGas<"u"&&(e.maxPriorityFeePerGas=Ee(t.maxPriorityFeePerGas)),typeof t.nonce<"u"&&(e.nonce=Ee(t.nonce)),typeof t.to<"u"&&(e.to=t.to),typeof t.type<"u"&&(e.type=n6[t.type]),typeof t.value<"u"&&(e.value=Ee(t.value)),e}function s6(t){return t.map(e=>({address:e.address,r:e.r?Ee(BigInt(e.r)):e.r,s:e.s?Ee(BigInt(e.s)):e.s,chainId:Ee(e.chainId),nonce:Ee(e.nonce),...typeof e.yParity<"u"?{yParity:Ee(e.yParity)}:{},...typeof e.v<"u"&&typeof e.yParity>"u"?{v:Ee(e.v)}:{}}))}function uy(t){if(!(!t||t.length===0))return t.reduce((e,{slot:r,value:n})=>{if(r.length!==66)throw new ty({size:r.length,targetSize:66,type:"hex"});if(n.length!==66)throw new ty({size:n.length,targetSize:66,type:"hex"});return e[r]=n,e},{})}function i6(t){const{balance:e,nonce:r,state:n,stateDiff:s,code:i}=t,o={};if(i!==void 0&&(o.code=i),e!==void 0&&(o.balance=Ee(e)),r!==void 0&&(o.nonce=Ee(r)),n!==void 0&&(o.state=uy(n)),s!==void 0){if(o.state)throw new D8;o.stateDiff=uy(s)}return o}function gv(t){if(!t)return;const e={};for(const{address:r,...n}of t){if(!on(r,{strict:!1}))throw new js({address:r});if(e[r])throw new $8({address:r});e[r]=i6(n)}return e}const o6=2n**256n-1n;function sl(t){const{account:e,gasPrice:r,maxFeePerGas:n,maxPriorityFeePerGas:s,to:i}=t,o=e?ln(e):void 0;if(o&&!on(o.address))throw new js({address:o.address});if(i&&!on(i))throw new js({address:i});if(typeof r<"u"&&(typeof n<"u"||typeof s<"u"))throw new U8;if(n&&n>o6)throw new du({maxFeePerGas:n});if(s&&n&&s>n)throw new hu({maxFeePerGas:n,maxPriorityFeePerGas:s})}class a6 extends j{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class Pf extends j{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class c6 extends j{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${Jt(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class mv extends j{constructor({blockHash:e,blockNumber:r}){let n="Block";e&&(n=`Block at hash "${e}"`),r&&(n=`Block at number "${r}"`),super(`${n} could not be found.`,{name:"BlockNotFoundError"})}}const yv={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function wv(t){const e={...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,chainId:t.chainId?Fs(t.chainId):void 0,gas:t.gas?BigInt(t.gas):void 0,gasPrice:t.gasPrice?BigInt(t.gasPrice):void 0,maxFeePerBlobGas:t.maxFeePerBlobGas?BigInt(t.maxFeePerBlobGas):void 0,maxFeePerGas:t.maxFeePerGas?BigInt(t.maxFeePerGas):void 0,maxPriorityFeePerGas:t.maxPriorityFeePerGas?BigInt(t.maxPriorityFeePerGas):void 0,nonce:t.nonce?Fs(t.nonce):void 0,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,type:t.type?yv[t.type]:void 0,typeHex:t.type?t.type:void 0,value:t.value?BigInt(t.value):void 0,v:t.v?BigInt(t.v):void 0};return t.authorizationList&&(e.authorizationList=u6(t.authorizationList)),e.yParity=(()=>{if(t.yParity)return Number(t.yParity);if(typeof e.v=="bigint"){if(e.v===0n||e.v===27n)return 0;if(e.v===1n||e.v===28n)return 1;if(e.v>=35n)return e.v%2n===0n?1:0}})(),e.type==="legacy"&&(delete e.accessList,delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas,delete e.yParity),e.type==="eip2930"&&(delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas),e.type==="eip1559"&&delete e.maxFeePerBlobGas,e}function u6(t){return t.map(e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)}))}function l6(t){const e=(t.transactions??[]).map(r=>typeof r=="string"?r:wv(r));return{...t,baseFeePerGas:t.baseFeePerGas?BigInt(t.baseFeePerGas):null,blobGasUsed:t.blobGasUsed?BigInt(t.blobGasUsed):void 0,difficulty:t.difficulty?BigInt(t.difficulty):void 0,excessBlobGas:t.excessBlobGas?BigInt(t.excessBlobGas):void 0,gasLimit:t.gasLimit?BigInt(t.gasLimit):void 0,gasUsed:t.gasUsed?BigInt(t.gasUsed):void 0,hash:t.hash?t.hash:null,logsBloom:t.logsBloom?t.logsBloom:null,nonce:t.nonce?t.nonce:null,number:t.number?BigInt(t.number):null,size:t.size?BigInt(t.size):void 0,timestamp:t.timestamp?BigInt(t.timestamp):void 0,transactions:e,totalDifficulty:t.totalDifficulty?BigInt(t.totalDifficulty):null}}async function Aa(t,{blockHash:e,blockNumber:r,blockTag:n,includeTransactions:s}={}){var l,d,h;const i=n??"latest",o=s??!1,a=r!==void 0?Ee(r):void 0;let c=null;if(e?c=await t.request({method:"eth_getBlockByHash",params:[e,o]},{dedupe:!0}):c=await t.request({method:"eth_getBlockByNumber",params:[a||i,o]},{dedupe:!!a}),!c)throw new mv({blockHash:e,blockNumber:r});return(((h=(d=(l=t.chain)==null?void 0:l.formatters)==null?void 0:d.block)==null?void 0:h.format)||l6)(c)}async function bv(t){const e=await t.request({method:"eth_gasPrice"});return BigInt(e)}async function d6(t,e){var i,o;const{block:r,chain:n=t.chain,request:s}=e||{};try{const a=((i=n==null?void 0:n.fees)==null?void 0:i.maxPriorityFeePerGas)??((o=n==null?void 0:n.fees)==null?void 0:o.defaultPriorityFee);if(typeof a=="function"){const u=r||await Ze(t,Aa,"getBlock")({}),l=await a({block:u,client:t,request:s});if(l===null)throw new Error;return l}if(typeof a<"u")return a;const c=await t.request({method:"eth_maxPriorityFeePerGas"});return Fi(c)}catch{const[a,c]=await Promise.all([r?Promise.resolve(r):Ze(t,Aa,"getBlock")({}),Ze(t,bv,"getGasPrice")({})]);if(typeof a.baseFeePerGas!="bigint")throw new Pf;const u=c-a.baseFeePerGas;return u<0n?0n:u}}async function ly(t,e){var h,f;const{block:r,chain:n=t.chain,request:s,type:i="eip1559"}=e||{},o=await(async()=>{var p,g;return typeof((p=n==null?void 0:n.fees)==null?void 0:p.baseFeeMultiplier)=="function"?n.fees.baseFeeMultiplier({block:r,client:t,request:s}):((g=n==null?void 0:n.fees)==null?void 0:g.baseFeeMultiplier)??1.2})();if(o<1)throw new a6;const c=10**(((h=o.toString().split(".")[1])==null?void 0:h.length)??0),u=p=>p*BigInt(Math.ceil(o*c))/BigInt(c),l=r||await Ze(t,Aa,"getBlock")({});if(typeof((f=n==null?void 0:n.fees)==null?void 0:f.estimateFeesPerGas)=="function"){const p=await n.fees.estimateFeesPerGas({block:r,client:t,multiply:u,request:s,type:i});if(p!==null)return p}if(i==="eip1559"){if(typeof l.baseFeePerGas!="bigint")throw new Pf;const p=typeof(s==null?void 0:s.maxPriorityFeePerGas)=="bigint"?s.maxPriorityFeePerGas:await d6(t,{block:l,chain:n,request:s}),g=u(l.baseFeePerGas);return{maxFeePerGas:(s==null?void 0:s.maxFeePerGas)??g+p,maxPriorityFeePerGas:p}}return{gasPrice:(s==null?void 0:s.gasPrice)??u(await Ze(t,bv,"getGasPrice")({}))}}async function h6(t,{address:e,blockTag:r="latest",blockNumber:n}){const s=await t.request({method:"eth_getTransactionCount",params:[e,typeof n=="bigint"?Ee(n):r]},{dedupe:!!n});return Fs(s)}function vv(t){const{kzg:e}=t,r=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),n=typeof t.blobs[0]=="string"?t.blobs.map(i=>sn(i)):t.blobs,s=[];for(const i of n)s.push(Uint8Array.from(e.blobToKzgCommitment(i)));return r==="bytes"?s:s.map(i=>Xt(i))}function Ev(t){const{kzg:e}=t,r=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),n=typeof t.blobs[0]=="string"?t.blobs.map(o=>sn(o)):t.blobs,s=typeof t.commitments[0]=="string"?t.commitments.map(o=>sn(o)):t.commitments,i=[];for(let o=0;o<n.length;o++){const a=n[o],c=s[o];i.push(Uint8Array.from(e.computeBlobKzgProof(a,c)))}return r==="bytes"?i:i.map(o=>Xt(o))}function f6(t,e){return PT(ss(t,{strict:!1})?Ju(t):t)}function p6(t){const{commitment:e,version:r=1}=t,n=t.to??(typeof e=="string"?"hex":"bytes"),s=f6(e);return s.set([r],0),n==="bytes"?s:Xt(s)}function g6(t){const{commitments:e,version:r}=t,n=t.to,s=[];for(const i of e)s.push(p6({commitment:i,to:n,version:r}));return s}const dy=6,_v=32,xf=4096,Cv=_v*xf,hy=Cv*dy-1-1*xf*dy;class m6 extends j{constructor({maxSize:e,size:r}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${r} bytes`],name:"BlobSizeTooLargeError"})}}class y6 extends j{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function w6(t){const e=typeof t.data=="string"?sn(t.data):t.data,r=ut(e);if(!r)throw new y6;if(r>hy)throw new m6({maxSize:hy,size:r});const n=[];let s=!0,i=0;for(;s;){const o=Ef(new Uint8Array(Cv));let a=0;for(;a<xf;){const c=e.slice(i,i+(_v-1));if(o.pushByte(0),o.pushBytes(c),c.length<31){o.pushByte(128),s=!1;break}a++,i+=31}n.push(o)}return n.map(o=>Xt(o.bytes))}function b6(t){const{data:e,kzg:r,to:n}=t,s=t.blobs??w6({data:e}),i=t.commitments??vv({blobs:s,kzg:r,to:n}),o=t.proofs??Ev({blobs:s,commitments:i,kzg:r,to:n}),a=[];for(let c=0;c<s.length;c++)a.push({blob:s[c],commitment:i[c],proof:o[c]});return a}function v6(t){if(t.type)return t.type;if(typeof t.authorizationList<"u")return"eip7702";if(typeof t.blobs<"u"||typeof t.blobVersionedHashes<"u"||typeof t.maxFeePerBlobGas<"u"||typeof t.sidecars<"u")return"eip4844";if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")return"eip1559";if(typeof t.gasPrice<"u")return typeof t.accessList<"u"?"eip2930":"legacy";throw new L8({transaction:t})}async function Av(t){const e=await t.request({method:"eth_chainId"},{dedupe:!0});return Fs(e)}const Iv=["blobVersionedHashes","chainId","fees","gas","nonce","type"],fy=new Map;async function Of(t,e){const{account:r=t.account,blobs:n,chain:s,gas:i,kzg:o,nonce:a,nonceManager:c,parameters:u=Iv,type:l}=e,d=r&&ln(r),h={...e,...d?{from:d==null?void 0:d.address}:{}};let f;async function p(){return f||(f=await Ze(t,Aa,"getBlock")({blockTag:"latest"}),f)}let g;async function m(){return g||(s?s.id:typeof e.chainId<"u"?e.chainId:(g=await Ze(t,Av,"getChainId")({}),g))}if(u.includes("nonce")&&typeof a>"u"&&d)if(c){const w=await m();h.nonce=await c.consume({address:d.address,chainId:w,client:t})}else h.nonce=await Ze(t,h6,"getTransactionCount")({address:d.address,blockTag:"pending"});if((u.includes("blobVersionedHashes")||u.includes("sidecars"))&&n&&o){const w=vv({blobs:n,kzg:o});if(u.includes("blobVersionedHashes")){const b=g6({commitments:w,to:"hex"});h.blobVersionedHashes=b}if(u.includes("sidecars")){const b=Ev({blobs:n,commitments:w,kzg:o}),v=b6({blobs:n,commitments:w,proofs:b,to:"hex"});h.sidecars=v}}if(u.includes("chainId")&&(h.chainId=await m()),(u.includes("fees")||u.includes("type"))&&typeof l>"u")try{h.type=v6(h)}catch{let w=fy.get(t.uid);if(typeof w>"u"){const b=await p();w=typeof(b==null?void 0:b.baseFeePerGas)=="bigint",fy.set(t.uid,w)}h.type=w?"eip1559":"legacy"}if(u.includes("fees"))if(h.type!=="legacy"&&h.type!=="eip2930"){if(typeof h.maxFeePerGas>"u"||typeof h.maxPriorityFeePerGas>"u"){const w=await p(),{maxFeePerGas:b,maxPriorityFeePerGas:v}=await ly(t,{block:w,chain:s,request:h});if(typeof e.maxPriorityFeePerGas>"u"&&e.maxFeePerGas&&e.maxFeePerGas<v)throw new c6({maxPriorityFeePerGas:v});h.maxPriorityFeePerGas=v,h.maxFeePerGas=b}}else{if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")throw new Pf;if(typeof e.gasPrice>"u"){const w=await p(),{gasPrice:b}=await ly(t,{block:w,chain:s,request:h,type:"legacy"});h.gasPrice=b}}return u.includes("gas")&&typeof i>"u"&&(h.gas=await Ze(t,Nv,"estimateGas")({...h,account:d&&{address:d.address,type:"json-rpc"}})),sl(h),delete h.parameters,h}async function Sv(t,{address:e,blockNumber:r,blockTag:n="latest"}){const s=typeof r=="bigint"?Ee(r):void 0,i=await t.request({method:"eth_getBalance",params:[e,s||n]});return BigInt(i)}async function Nv(t,e){var s,i,o;const{account:r=t.account}=e,n=r?ln(r):void 0;try{let R=function(N){const{block:$,request:k,rpcStateOverride:D}=N;return t.request({method:"eth_estimateGas",params:D?[k,$??"latest",D]:$?[k,$]:[k]})};const{accessList:a,authorizationList:c,blobs:u,blobVersionedHashes:l,blockNumber:d,blockTag:h,data:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:w,maxPriorityFeePerGas:b,nonce:v,value:A,stateOverride:E,...y}=await Of(t,{...e,parameters:(n==null?void 0:n.type)==="local"?void 0:["blobVersionedHashes"]}),T=(typeof d=="bigint"?Ee(d):void 0)||h,S=gv(E),x=await(async()=>{if(y.to)return y.to;if(c&&c.length>0)return await pv({authorization:c[0]}).catch(()=>{throw new j("`to` is required. Could not infer from `authorizationList`")})})();sl(e);const O=(o=(i=(s=t.chain)==null?void 0:s.formatters)==null?void 0:i.transactionRequest)==null?void 0:o.format,M=(O||Tf)({...Nf(y,{format:O}),from:n==null?void 0:n.address,accessList:a,authorizationList:c,blobs:u,blobVersionedHashes:l,data:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:w,maxPriorityFeePerGas:b,nonce:v,to:x,value:A});let I=BigInt(await R({block:T,request:M,rpcStateOverride:S}));if(c){const N=await Sv(t,{address:M.from}),$=await Promise.all(c.map(async k=>{const{address:D}=k,U=await R({block:T,request:{authorizationList:void 0,data:f,from:n==null?void 0:n.address,to:D,value:Ee(N)},rpcStateOverride:S}).catch(()=>100000n);return 2n*BigInt(U)}));I+=$.reduce((k,D)=>k+D,0n)}return I}catch(a){throw r6(a,{...e,account:n,chain:t.chain})}}function E6(t,e){if(!on(t,{strict:!1}))throw new js({address:t});if(!on(e,{strict:!1}))throw new js({address:e});return t.toLowerCase()===e.toLowerCase()}const py="/docs/contract/decodeEventLog";function _6(t){const{abi:e,data:r,strict:n,topics:s}=t,i=n??!0,[o,...a]=s;if(!o)throw new kU({docsPath:py});const c=e.length===1?e[0]:e.find(g=>g.type==="event"&&o===gf(ns(g)));if(!(c&&"name"in c)||c.type!=="event")throw new K0(o,{docsPath:py});const{name:u,inputs:l}=c,d=l==null?void 0:l.some(g=>!("name"in g&&g.name));let h=d?[]:{};const f=l.filter(g=>"indexed"in g&&g.indexed);for(let g=0;g<f.length;g++){const m=f[g],w=a[g];if(!w)throw new G0({abiItem:c,param:m});h[d?g:m.name||g]=C6({param:m,value:w})}const p=l.filter(g=>!("indexed"in g&&g.indexed));if(p.length>0){if(r&&r!=="0x")try{const g=rl(p,r);if(g)if(d)h=[...h,...g];else for(let m=0;m<p.length;m++)h[p[m].name]=g[m]}catch(g){if(i)throw g instanceof W0||g instanceof av?new bh({abiItem:c,data:r,params:p,size:ut(r)}):g}else if(i)throw new bh({abiItem:c,data:"0x",params:p,size:0})}return{eventName:u,args:Object.values(h).length>0?h:void 0}}function C6({param:t,value:e}){return t.type==="string"||t.type==="bytes"||t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/)?e:(rl([t],e)||[])[0]}function A6(t){const{abi:e,args:r,logs:n,strict:s=!0}=t,i=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return n.map(o=>{var a;try{const c=e.find(l=>l.type==="event"&&o.topics[0]===gf(l));if(!c)return null;const u=_6({...o,abi:[c],strict:s});return i&&!i.includes(u.eventName)||!I6({args:u.args,inputs:c.inputs,matchArgs:r})?null:{...u,...o}}catch(c){let u,l;if(c instanceof K0)return null;if(c instanceof bh||c instanceof G0){if(s)return null;u=c.abiItem.name,l=(a=c.abiItem.inputs)==null?void 0:a.some(d=>!("name"in d&&d.name))}return{...o,args:l?[]:{},eventName:u}}}).filter(Boolean)}function I6(t){const{args:e,inputs:r,matchArgs:n}=t;if(!n)return!0;if(!e)return!1;function s(i,o,a){try{return i.type==="address"?E6(o,a):i.type==="string"||i.type==="bytes"?sc(Ju(o))===a:o===a}catch{return!1}}return Array.isArray(e)&&Array.isArray(n)?n.every((i,o)=>{if(i==null)return!0;const a=r[o];return a?(Array.isArray(i)?i:[i]).some(u=>s(a,u,e[o])):!1}):typeof e=="object"&&!Array.isArray(e)&&typeof n=="object"&&!Array.isArray(n)?Object.entries(n).every(([i,o])=>{if(o==null)return!0;const a=r.find(u=>u.name===i);return a?(Array.isArray(o)?o:[o]).some(u=>s(a,u,e[i])):!1}):!1}function Tv(t,{args:e,eventName:r}={}){return{...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,logIndex:t.logIndex?Number(t.logIndex):null,transactionHash:t.transactionHash?t.transactionHash:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,...r?{args:e,eventName:r}:{}}}const ud="/docs/contract/decodeFunctionResult";function Rf(t){const{abi:e,args:r,functionName:n,data:s}=t;let i=e[0];if(n){const a=vf({abi:e,args:r,name:n});if(!a)throw new cu(n,{docsPath:ud});i=a}if(i.type!=="function")throw new cu(void 0,{docsPath:ud});if(!i.outputs)throw new UU(i.name,{docsPath:ud});const o=rl(i.outputs,s);if(o&&o.length>1)return o;if(o&&o.length===1)return o[0]}const S6="0.1.1";function N6(){return S6}let Pv=class xh extends Error{constructor(e,r={}){const n=(()=>{var c;if(r.cause instanceof xh){if(r.cause.details)return r.cause.details;if(r.cause.shortMessage)return r.cause.shortMessage}return r.cause&&"details"in r.cause&&typeof r.cause.details=="string"?r.cause.details:(c=r.cause)!=null&&c.message?r.cause.message:r.details})(),s=r.cause instanceof xh&&r.cause.docsPath||r.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...r.metaMessages?["",...r.metaMessages]:[],...n||s?["",n?`Details: ${n}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,r.cause?{cause:r.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${N6()}`}),this.cause=r.cause,this.details=n,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return xv(this,e)}};function xv(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?xv(t.cause,e):e?null:t}function T6(t,e={}){const{dir:r,size:n=32}=e;if(n===0)return t;const s=t.replace("0x","");if(s.length>n*2)throw new O6({size:Math.ceil(s.length/2),targetSize:n,type:"Hex"});return`0x${s[r==="right"?"padEnd":"padStart"](n*2,"0")}`}function _n(t,e={}){const{signed:r,size:n}=e,s=BigInt(t);let i;n?r?i=(1n<<BigInt(n)*8n-1n)-1n:i=2n**(BigInt(n)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&r?-i-1n:0;if(i&&s>i||s<o){const u=typeof t=="bigint"?"n":"";throw new x6({max:i?`${i}${u}`:void 0,min:`${o}${u}`,signed:r,size:n,value:`${t}${u}`})}const c=`0x${(r&&s<0?(1n<<BigInt(n*8))+BigInt(s):s).toString(16)}`;return n?P6(c,n):c}function P6(t,e){return T6(t,{dir:"left",size:e})}class x6 extends Pv{constructor({max:e,min:r,signed:n,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${n?" signed":" unsigned"} integer range ${e?`(\`${r}\` to \`${e}\`)`:`(above \`${r}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class O6 extends Pv{constructor({size:e,targetSize:r,type:n}){super(`${n.charAt(0).toUpperCase()}${n.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}function R6(t){return{address:t.address,amount:_n(t.amount),index:_n(t.index),validatorIndex:_n(t.validatorIndex)}}function $6(t){return{...typeof t.baseFeePerGas=="bigint"&&{baseFeePerGas:_n(t.baseFeePerGas)},...typeof t.blobBaseFee=="bigint"&&{blobBaseFee:_n(t.blobBaseFee)},...typeof t.feeRecipient=="string"&&{feeRecipient:t.feeRecipient},...typeof t.gasLimit=="bigint"&&{gasLimit:_n(t.gasLimit)},...typeof t.number=="bigint"&&{number:_n(t.number)},...typeof t.prevRandao=="bigint"&&{prevRandao:_n(t.prevRandao)},...typeof t.time=="bigint"&&{time:_n(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(R6)}}}const Oh=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],Rj=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],D6="0x82ad56cb",k6="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",U6="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe";class Rh extends j{constructor({blockNumber:e,chain:r,contract:n}){super(`Chain "${r.name}" does not support contract "${n.name}".`,{metaMessages:["This could be due to any of the following:",...e&&n.blockCreated&&n.blockCreated>e?[`- The contract "${n.name}" was not deployed until block ${n.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${n.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class L6 extends j{constructor({chain:e,currentChainId:r}){super(`The current chain of the wallet (id: ${r}) does not match the target chain for the transaction (id: ${e.id}  ${e.name}).`,{metaMessages:[`Current Chain ID:  ${r}`,`Expected Chain ID: ${e.id}  ${e.name}`],name:"ChainMismatchError"})}}class M6 extends j{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}}class Ov extends j{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}const ld="/docs/contract/encodeDeployData";function Rv(t){const{abi:e,args:r,bytecode:n}=t;if(!r||r.length===0)return n;const s=e.find(o=>"type"in o&&o.type==="constructor");if(!s)throw new OU({docsPath:ld});if(!("inputs"in s))throw new ey({docsPath:ld});if(!s.inputs||s.inputs.length===0)throw new ey({docsPath:ld});const i=iv(s.inputs,r);return el([n,i])}function $v({blockNumber:t,chain:e,contract:r}){var s;const n=(s=e==null?void 0:e.contracts)==null?void 0:s[r];if(!n)throw new Rh({chain:e,contract:{name:r}});if(t&&n.blockCreated&&n.blockCreated>t)throw new Rh({blockNumber:t,chain:e,contract:{name:r,blockCreated:n.blockCreated}});return n.address}function B6(t,{docsPath:e,...r}){const n=(()=>{const s=Sf(t,r);return s instanceof nl?t:s})();return new j8(n,{docsPath:e,...r})}function Dv(){let t=()=>{},e=()=>{};return{promise:new Promise((n,s)=>{t=n,e=s}),resolve:t,reject:e}}const dd=new Map;function kv({fn:t,id:e,shouldSplitBatch:r,wait:n=0,sort:s}){const i=async()=>{const l=c();o();const d=l.map(({args:h})=>h);d.length!==0&&t(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let f=0;f<l.length;f++){const{resolve:p}=l[f];p==null||p([h[f],h])}}).catch(h=>{for(let f=0;f<l.length;f++){const{reject:p}=l[f];p==null||p(h)}})},o=()=>dd.delete(e),a=()=>c().map(({args:l})=>l),c=()=>dd.get(e)||[],u=l=>dd.set(e,[...c(),l]);return{flush:o,async schedule(l){const{promise:d,resolve:h,reject:f}=Dv();return(r==null?void 0:r([...a(),l]))&&i(),c().length>0?(u({args:l,resolve:h,reject:f}),d):(u({args:l,resolve:h,reject:f}),setTimeout(i,n),d)}}}async function Uv(t,e){var L,M,R,I;const{account:r=t.account,batch:n=!!((L=t.batch)!=null&&L.multicall),blockNumber:s,blockTag:i="latest",accessList:o,blobs:a,blockOverrides:c,code:u,data:l,factory:d,factoryData:h,gas:f,gasPrice:p,maxFeePerBlobGas:g,maxFeePerGas:m,maxPriorityFeePerGas:w,nonce:b,to:v,value:A,stateOverride:E,...y}=e,_=r?ln(r):void 0;if(u&&(d||h))throw new j("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(u&&v)throw new j("Cannot provide both `code` & `to` as parameters.");const T=u&&l,S=d&&h&&v&&l,x=T||S,O=T?q6({code:u,data:l}):S?z6({data:l,factory:d,factoryData:h,to:v}):l;try{sl(e);const $=(typeof s=="bigint"?Ee(s):void 0)||i,k=c?$6(c):void 0,D=gv(E),U=(I=(R=(M=t.chain)==null?void 0:M.formatters)==null?void 0:R.transactionRequest)==null?void 0:I.format,G=(U||Tf)({...Nf(y,{format:U}),from:_==null?void 0:_.address,accessList:o,blobs:a,data:O,gas:f,gasPrice:p,maxFeePerBlobGas:g,maxFeePerGas:m,maxPriorityFeePerGas:w,nonce:b,to:x?void 0:v,value:A});if(n&&F6({request:G})&&!D&&!k)try{return await j6(t,{...G,blockNumber:s,blockTag:i})}catch(ie){if(!(ie instanceof Ov)&&!(ie instanceof Rh))throw ie}const se=(()=>{const ie=[G,$];return D&&k?[...ie,D,k]:D?[...ie,D]:k?[...ie,{},k]:ie})(),K=await t.request({method:"eth_call",params:se});return K==="0x"?{data:void 0}:{data:K}}catch(N){const $=H6(N),{offchainLookup:k,offchainLookupSignature:D}=await Ut(async()=>{const{offchainLookup:U,offchainLookupSignature:H}=await import("./DoDeJDbf.js");return{offchainLookup:U,offchainLookupSignature:H}},[],import.meta.url);if(t.ccipRead!==!1&&($==null?void 0:$.slice(0,10))===D&&v)return{data:await k(t,{data:$,to:v})};throw x&&($==null?void 0:$.slice(0,10))==="0x101bb98d"?new H8({factory:d}):B6(N,{...e,account:_,chain:t.chain})}}function F6({request:t}){const{data:e,to:r,...n}=t;return!(!e||e.startsWith(D6)||!r||Object.values(n).filter(s=>typeof s<"u").length>0)}async function j6(t,e){var g;const{batchSize:r=1024,wait:n=0}=typeof((g=t.batch)==null?void 0:g.multicall)=="object"?t.batch.multicall:{},{blockNumber:s,blockTag:i="latest",data:o,multicallAddress:a,to:c}=e;let u=a;if(!u){if(!t.chain)throw new Ov;u=$v({blockNumber:s,chain:t.chain,contract:"multicall3"})}const d=(typeof s=="bigint"?Ee(s):void 0)||i,{schedule:h}=kv({id:`${t.uid}.${d}`,wait:n,shouldSplitBatch(m){return m.reduce((b,{data:v})=>b+(v.length-2),0)>r*2},fn:async m=>{const w=m.map(A=>({allowFailure:!0,callData:A.data,target:A.to})),b=tl({abi:Oh,args:[w],functionName:"aggregate3"}),v=await t.request({method:"eth_call",params:[{data:b,to:u},d]});return Rf({abi:Oh,args:[w],functionName:"aggregate3",data:v||"0x"})}}),[{returnData:f,success:p}]=await h({data:o,to:c});if(!p)throw new Af({data:f});return f==="0x"?{data:void 0}:{data:f}}function q6(t){const{code:e,data:r}=t;return Rv({abi:Yw(["constructor(bytes, bytes)"]),bytecode:k6,args:[e,r]})}function z6(t){const{data:e,factory:r,factoryData:n,to:s}=t;return Rv({abi:Yw(["constructor(address, bytes, address, bytes)"]),bytecode:U6,args:[s,e,r,n]})}function H6(t){var r;if(!(t instanceof j))return;const e=t.walk();return typeof(e==null?void 0:e.data)=="object"?(r=e.data)==null?void 0:r.data:e.data}async function Lv(t,e){const{abi:r,address:n,args:s,functionName:i,...o}=e,a=tl({abi:r,args:s,functionName:i});try{const{data:c}=await Ze(t,Uv,"call")({...o,data:a,to:n});return Rf({abi:r,args:s,functionName:i,data:c||"0x"})}catch(c){throw lu(c,{abi:r,address:n,args:s,docsPath:"/docs/contract/readContract",functionName:i})}}const hd=new Map,gy=new Map;let W6=0;function fu(t,e,r){const n=++W6,s=()=>hd.get(t)||[],i=()=>{const l=s();hd.set(t,l.filter(d=>d.id!==n))},o=()=>{const l=s();if(!l.some(h=>h.id===n))return;const d=gy.get(t);l.length===1&&d&&d(),i()},a=s();if(hd.set(t,[...a,{id:n,fns:e}]),a&&a.length>0)return o;const c={};for(const l in e)c[l]=(...d)=>{var f,p;const h=s();if(h.length!==0)for(const g of h)(p=(f=g.fns)[l])==null||p.call(f,...d)};const u=r(c);return typeof u=="function"&&gy.set(t,u),o}async function pu(t){return new Promise(e=>setTimeout(e,t))}function Mv(t,{emitOnBegin:e,initialWaitTime:r,interval:n}){let s=!0;const i=()=>s=!1;return(async()=>{let a;e&&(a=await t({unpoll:i}));const c=await(r==null?void 0:r(a))??n;await pu(c);const u=async()=>{s&&(await t({unpoll:i}),await pu(n),u())};u()})(),i}const V6=new Map,K6=new Map;function G6(t){const e=(s,i)=>({clear:()=>i.delete(s),get:()=>i.get(s),set:o=>i.set(s,o)}),r=e(t,V6),n=e(t,K6);return{clear:()=>{r.clear(),n.clear()},promise:r,response:n}}async function Y6(t,{cacheKey:e,cacheTime:r=Number.POSITIVE_INFINITY}){const n=G6(e),s=n.response.get();if(s&&r>0&&new Date().getTime()-s.created.getTime()<r)return s.data;let i=n.promise.get();i||(i=t(),n.promise.set(i));try{const o=await i;return n.response.set({created:new Date,data:o}),o}finally{n.promise.clear()}}const Z6=t=>`blockNumber.${t}`;async function J6(t,{cacheTime:e=t.cacheTime}={}){const r=await Y6(()=>t.request({method:"eth_blockNumber"}),{cacheKey:Z6(t.uid),cacheTime:e});return BigInt(r)}async function X6(t,{filter:e}){const r="strict"in e&&e.strict,n=await e.request({method:"eth_getFilterChanges",params:[e.id]});if(typeof n[0]=="string")return n;const s=n.map(i=>Tv(i));return!("abi"in e)||!e.abi?s:A6({abi:e.abi,logs:s,strict:r})}async function Q6(t,{filter:e}){return e.request({method:"eth_uninstallFilter",params:[e.id]})}class $f extends j{constructor({docsPath:e}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class fd extends j{constructor({docsPath:e,metaMessages:r,type:n}){super(`Account type "${n}" is not supported.`,{docsPath:e,metaMessages:r,name:"AccountTypeNotSupportedError"})}}function eL({chain:t,currentChainId:e}){if(!t)throw new M6;if(e!==t.id)throw new L6({chain:t,currentChainId:e})}function tL(t,{docsPath:e,...r}){const n=(()=>{const s=Sf(t,r);return s instanceof nl?t:s})();return new M8(n,{docsPath:e,...r})}async function rL(t,{serializedTransaction:e}){return t.request({method:"eth_sendRawTransaction",params:[e]},{retryCount:0})}const pd=new Xu(128);async function Bv(t,e){var b,v,A,E;const{account:r=t.account,chain:n=t.chain,accessList:s,authorizationList:i,blobs:o,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,type:p,value:g,...m}=e;if(typeof r>"u")throw new $f({docsPath:"/docs/actions/wallet/sendTransaction"});const w=r?ln(r):null;try{sl(e);const y=await(async()=>{if(e.to)return e.to;if(e.to!==null&&i&&i.length>0)return await pv({authorization:i[0]}).catch(()=>{throw new j("`to` is required. Could not infer from `authorizationList`.")})})();if((w==null?void 0:w.type)==="json-rpc"||w===null){let _;n!==null&&(_=await Ze(t,Av,"getChainId")({}),eL({currentChainId:_,chain:n}));const T=(A=(v=(b=t.chain)==null?void 0:b.formatters)==null?void 0:v.transactionRequest)==null?void 0:A.format,x=(T||Tf)({...Nf(m,{format:T}),accessList:s,authorizationList:i,blobs:o,chainId:_,data:a,from:w==null?void 0:w.address,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,to:y,type:p,value:g}),O=pd.get(t.uid),L=O?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:L,params:[x]},{retryCount:0})}catch(M){if(O===!1)throw M;const R=M;if(R.name==="InvalidInputRpcError"||R.name==="InvalidParamsRpcError"||R.name==="MethodNotFoundRpcError"||R.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[x]},{retryCount:0}).then(I=>(pd.set(t.uid,!0),I)).catch(I=>{const N=I;throw N.name==="MethodNotFoundRpcError"||N.name==="MethodNotSupportedRpcError"?(pd.set(t.uid,!1),R):N});throw R}}if((w==null?void 0:w.type)==="local"){const _=await Ze(t,Of,"prepareTransactionRequest")({account:w,accessList:s,authorizationList:i,blobs:o,chain:n,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,nonceManager:w.nonceManager,parameters:[...Iv,"sidecars"],type:p,value:g,...m,to:y}),T=(E=n==null?void 0:n.serializers)==null?void 0:E.transaction,S=await w.signTransaction(_,{serializer:T});return await Ze(t,rL,"sendRawTransaction")({serializedTransaction:S})}throw(w==null?void 0:w.type)==="smart"?new fd({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new fd({docsPath:"/docs/actions/wallet/sendTransaction",type:w==null?void 0:w.type})}catch(y){throw y instanceof fd?y:tL(y,{...e,account:w,chain:e.chain||void 0})}}async function nL(t,e){const{abi:r,account:n=t.account,address:s,args:i,dataSuffix:o,functionName:a,...c}=e;if(typeof n>"u")throw new $f({docsPath:"/docs/contract/writeContract"});const u=n?ln(n):null,l=tl({abi:r,args:i,functionName:a});try{return await Ze(t,Bv,"sendTransaction")({data:`${l}${o?o.replace("0x",""):""}`,to:s,account:u,...c})}catch(d){throw lu(d,{abi:r,address:s,args:i,docsPath:"/docs/contract/writeContract",functionName:a,sender:u==null?void 0:u.address})}}const sL={"0x0":"reverted","0x1":"success"};function iL(t){const e={...t,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs?t.logs.map(r=>Tv(r)):null,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Fs(t.transactionIndex):null,status:t.status?sL[t.status]:null,type:t.type?yv[t.type]||t.type:null};return t.blobGasPrice&&(e.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(e.blobGasUsed=BigInt(t.blobGasUsed)),e}const $h=256;let Nc=$h,Tc;function Fv(t=11){if(!Tc||Nc+t>$h*2){Tc="",Nc=0;for(let e=0;e<$h;e++)Tc+=(256+Math.random()*256|0).toString(16).substring(1)}return Tc.substring(Nc,Nc+++t)}function jv(t){const{batch:e,cacheTime:r=t.pollingInterval??4e3,ccipRead:n,key:s="base",name:i="Base Client",pollingInterval:o=4e3,type:a="base"}=t,c=t.chain,u=t.account?ln(t.account):void 0,{config:l,request:d,value:h}=t.transport({chain:c,pollingInterval:o}),f={...l,...h},p={account:u,batch:e,cacheTime:r,ccipRead:n,chain:c,key:s,name:i,pollingInterval:o,request:d,transport:f,type:a,uid:Fv()};function g(m){return w=>{const b=w(m);for(const A in p)delete b[A];const v={...m,...b};return Object.assign(v,{extend:g(v)})}}return Object.assign(p,{extend:g(p)})}const Pc=new Xu(8192);function oL(t,{enabled:e=!0,id:r}){if(!e||!r)return t();if(Pc.get(r))return Pc.get(r);const n=t().finally(()=>Pc.delete(r));return Pc.set(r,n),n}function gu(t,{delay:e=100,retryCount:r=2,shouldRetry:n=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:u})=>{const l=typeof e=="function"?e({count:a,error:u}):e;l&&await pu(l),o({count:a+1})};try{const u=await t();s(u)}catch(u){if(a<r&&await n({count:a,error:u}))return c({error:u});i(u)}};o()})}function aL(t,e={}){return async(r,n={})=>{var d;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...n},{method:u}=r;if((d=i==null?void 0:i.exclude)!=null&&d.includes(u))throw new Is(new Error("method not supported"),{method:u});if(i!=null&&i.include&&!i.include.includes(u))throw new Is(new Error("method not supported"),{method:u});const l=s?Zu(`${c}.${Er(r)}`):void 0;return oL(()=>gu(async()=>{try{return await t(r)}catch(h){const f=h;switch(f.code){case oa.code:throw new oa(f);case aa.code:throw new aa(f);case ca.code:throw new ca(f,{method:r.method});case ua.code:throw new ua(f);case qs.code:throw new qs(f);case la.code:throw new la(f);case da.code:throw new da(f);case Qn.code:throw new Qn(f);case zi.code:throw new zi(f);case Is.code:throw new Is(f,{method:r.method});case Hi.code:throw new Hi(f);case ha.code:throw new ha(f);case at.code:throw new at(f);case fa.code:throw new fa(f);case pa.code:throw new pa(f);case ga.code:throw new ga(f);case ma.code:throw new ma(f);case an.code:throw new an(f);case ya.code:throw new ya(f);case wa.code:throw new wa(f);case ba.code:throw new ba(f);case va.code:throw new va(f);case Ea.code:throw new Ea(f);case _a.code:throw new _a(f);case Ca.code:throw new Ca(f);case 5e3:throw new at(f);default:throw h instanceof j?h:new V8(f)}}},{delay:({count:h,error:f})=>{var p;if(f&&f instanceof jo){const g=(p=f==null?void 0:f.headers)==null?void 0:p.get("Retry-After");if(g!=null&&g.match(/\d/))return Number.parseInt(g)*1e3}return~~(1<<h)*o},retryCount:a,shouldRetry:({error:h})=>cL(h)}),{enabled:s,id:l})}}function cL(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===Hi.code||t.code===qs.code:t instanceof jo&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function Df({key:t,methods:e,name:r,request:n,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const u=Fv();return{config:{key:t,methods:e,name:r,request:n,retryCount:s,retryDelay:i,timeout:o,type:a},request:aL(n,{methods:e,retryCount:s,retryDelay:i,uid:u}),value:c}}function uL(t,e={}){const{key:r="custom",methods:n,name:s="Custom Provider",retryDelay:i}=e;return({retryCount:o})=>Df({key:r,methods:n,name:s,request:t.request.bind(t),retryCount:e.retryCount??o,retryDelay:i,type:"custom"})}function my(t,e={}){const{key:r="fallback",name:n="Fallback",rank:s=!1,shouldThrow:i=lL,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:u=4e3,timeout:l,...d})=>{let h=t,f=()=>{};const p=Df({key:r,name:n,async request({method:g,params:m}){let w;const b=async(v=0)=>{const A=h[v]({...d,chain:c,retryCount:0,timeout:l});try{const E=await A.request({method:g,params:m});return f({method:g,params:m,response:E,transport:A,status:"success"}),E}catch(E){if(f({error:E,method:g,params:m,transport:A,status:"error"}),i(E)||v===h.length-1||(w??(w=h.slice(v+1).some(y=>{const{include:_,exclude:T}=y({chain:c}).config.methods||{};return _?_.includes(g):T?!T.includes(g):!0})),!w))throw E;return b(v+1)}};return b()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>f=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};dL({chain:c,interval:g.interval??u,onTransports:m=>h=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return p}}function lL(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===zi.code||t.code===at.code||Ss.nodeMessage.test(t.message)||t.code===5e3))}function dL({chain:t,interval:e=4e3,onTransports:r,ping:n,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:u=.3}=a,l=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const m=g({chain:t,retryCount:0,timeout:i}),w=Date.now();let b,v;try{await(n?n({transport:m}):m.request({method:"net_listening"})),v=1}catch{v=0}finally{b=Date.now()}return{latency:b-w,success:v}}));l.push(h),l.length>s&&l.shift();const f=Math.max(...l.map(g=>Math.max(...g.map(({latency:m})=>m)))),p=o.map((g,m)=>{const w=l.map(y=>y[m].latency),v=1-w.reduce((y,_)=>y+_,0)/w.length/f,A=l.map(y=>y[m].success),E=A.reduce((y,_)=>y+_,0)/A.length;return E===0?[0,m]:[u*v+c*E,m]}).sort((g,m)=>m[0]-g[0]);r(p.map(([,g])=>o[g])),await pu(e),d()};d()}class hL extends j{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function qv(t,{errorInstance:e=new Error("timed out"),timeout:r,signal:n}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;r>0&&(o=setTimeout(()=>{n?a.abort():i(e)},r)),s(await t({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function fL(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const yy=fL();function pL(t,e={}){return{async request(r){var d;const{body:n,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=r,a={...e.fetchOptions??{},...r.fetchOptions??{}},{headers:c,method:u,signal:l}=a;try{const h=await qv(async({signal:p})=>{const g={...a,body:Array.isArray(n)?Er(n.map(v=>({jsonrpc:"2.0",id:v.id??yy.take(),...v}))):Er({jsonrpc:"2.0",id:n.id??yy.take(),...n}),headers:{"Content-Type":"application/json",...c},method:u||"POST",signal:l||(o>0?p:null)},m=new Request(t,g),w=await(s==null?void 0:s(m,g))??{...g,url:t};return await fetch(w.url??t,w)},{errorInstance:new ay({body:n,url:t}),timeout:o,signal:!0});i&&await i(h);let f;if((d=h.headers.get("Content-Type"))!=null&&d.startsWith("application/json"))f=await h.json();else{f=await h.text();try{f=JSON.parse(f||"{}")}catch(p){if(h.ok)throw p;f={error:f}}}if(!h.ok)throw new jo({body:n,details:Er(f.error)||h.statusText,headers:h.headers,status:h.status,url:t});return f}catch(h){throw h instanceof jo||h instanceof ay?h:new jo({body:n,cause:h,url:t})}}}}function xc(t,e={}){const{batch:r,fetchOptions:n,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:u,raw:l}=e;return({chain:d,retryCount:h,timeout:f})=>{const{batchSize:p=1e3,wait:g=0}=typeof r=="object"?r:{},m=e.retryCount??h,w=f??e.timeout??1e4,b=t||(d==null?void 0:d.rpcUrls.default.http[0]);if(!b)throw new hL;const v=pL(b,{fetchOptions:n,onRequest:a,onResponse:c,timeout:w});return Df({key:s,methods:i,name:o,async request({method:A,params:E}){const y={method:A,params:E},{schedule:_}=kv({id:b,wait:g,shouldSplitBatch(O){return O.length>p},fn:O=>v.request({body:O}),sort:(O,L)=>O.id-L.id}),T=async O=>r?_(O):[await v.request({body:O})],[{error:S,result:x}]=await T(y);if(l)return{error:S,result:x};if(S)throw new If({body:y,error:S,url:b});return x},retryCount:m,retryDelay:u,timeout:w,type:"http"},{fetchOptions:n,url:b})}}async function gL(t){const e=h8(t,{method:"eth_newPendingTransactionFilter"}),r=await t.request({method:"eth_newPendingTransactionFilter"});return{id:r,request:e(r),type:"transaction"}}function mL(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}class yL extends j{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function wL(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new yL({value:t});let[r,n="0"]=t.split(".");const s=r.startsWith("-");if(s&&(r=r.slice(1)),n=n.replace(/(0+)$/,""),e===0)Math.round(+`.${n}`)===1&&(r=`${BigInt(r)+1n}`),n="";else if(n.length>e){const[i,o,a]=[n.slice(0,e-1),n.slice(e-1,e),n.slice(e)],c=Math.round(+`${o}.${a}`);c>9?n=`${BigInt(i)+BigInt(1)}0`.padStart(i.length+1,"0"):n=`${i}${c}`,n.length>e&&(n=n.slice(1),r=`${BigInt(r)+1n}`),n=n.slice(0,e)}else n=n.padEnd(e,"0");return BigInt(`${s?"-":""}${r}${n}`)}async function zv(t,{blockHash:e,blockNumber:r,blockTag:n,hash:s,index:i}){var l,d,h;const o=n||"latest",a=r!==void 0?Ee(r):void 0;let c=null;if(s?c=await t.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):e?c=await t.request({method:"eth_getTransactionByBlockHashAndIndex",params:[e,Ee(i)]},{dedupe:!0}):c=await t.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[a||o,Ee(i)]},{dedupe:!!a}),!c)throw new uv({blockHash:e,blockNumber:r,blockTag:o,hash:s,index:i});return(((h=(d=(l=t.chain)==null?void 0:l.formatters)==null?void 0:d.transaction)==null?void 0:h.format)||wv)(c)}async function wy(t,{hash:e}){var s,i,o;const r=await t.request({method:"eth_getTransactionReceipt",params:[e]},{dedupe:!0});if(!r)throw new lv({hash:e});return(((o=(i=(s=t.chain)==null?void 0:s.formatters)==null?void 0:i.transactionReceipt)==null?void 0:o.format)||iL)(r)}async function bL(t,e){var w;const{account:r,allowFailure:n=!0,batchSize:s,blockNumber:i,blockTag:o,multicallAddress:a,stateOverride:c}=e,u=e.contracts,l=s??(typeof((w=t.batch)==null?void 0:w.multicall)=="object"&&t.batch.multicall.batchSize||1024);let d=a;if(!d){if(!t.chain)throw new Error("client chain not configured. multicallAddress is required.");d=$v({blockNumber:i,chain:t.chain,contract:"multicall3"})}const h=[[]];let f=0,p=0;for(let b=0;b<u.length;b++){const{abi:v,address:A,args:E,functionName:y}=u[b];try{const _=tl({abi:v,args:E,functionName:y});p+=(_.length-2)/2,l>0&&p>l&&h[f].length>0&&(f++,p=(_.length-2)/2,h[f]=[]),h[f]=[...h[f],{allowFailure:!0,callData:_,target:A}]}catch(_){const T=lu(_,{abi:v,address:A,args:E,docsPath:"/docs/contract/multicall",functionName:y,sender:r});if(!n)throw T;h[f]=[...h[f],{allowFailure:!0,callData:"0x",target:A}]}}const g=await Promise.allSettled(h.map(b=>Ze(t,Lv,"readContract")({abi:Oh,account:r,address:d,args:[b],blockNumber:i,blockTag:o,functionName:"aggregate3",stateOverride:c}))),m=[];for(let b=0;b<g.length;b++){const v=g[b];if(v.status==="rejected"){if(!n)throw v.reason;for(let E=0;E<h[b].length;E++)m.push({status:"failure",error:v.reason,result:void 0});continue}const A=v.value;for(let E=0;E<A.length;E++){const{returnData:y,success:_}=A[E],{callData:T}=h[b][E],{abi:S,address:x,functionName:O,args:L}=u[m.length];try{if(T==="0x")throw new Yu;if(!_)throw new Af({data:y});const M=Rf({abi:S,args:L,data:y,functionName:O});m.push(n?{result:M,status:"success"}:M)}catch(M){const R=lu(M,{abi:S,address:x,args:L,docsPath:"/docs/contract/multicall",functionName:O});if(!n)throw R;m.push({error:R,result:void 0,status:"failure"})}}}if(m.length!==u.length)throw new j("multicall results mismatch");return m}function vL(t,{emitOnBegin:e=!1,emitMissed:r=!1,onBlockNumber:n,onError:s,poll:i,pollingInterval:o=t.pollingInterval}){const a=typeof i<"u"?i:!(t.transport.type==="webSocket"||t.transport.type==="fallback"&&t.transport.transports[0].config.type==="webSocket");let c;return a?(()=>{const d=Er(["watchBlockNumber",t.uid,e,r,o]);return fu(d,{onBlockNumber:n,onError:s},h=>Mv(async()=>{var f;try{const p=await Ze(t,J6,"getBlockNumber")({cacheTime:0});if(c){if(p===c)return;if(p-c>1&&r)for(let g=c+1n;g<p;g++)h.onBlockNumber(g,c),c=g}(!c||p>c)&&(h.onBlockNumber(p,c),c=p)}catch(p){(f=h.onError)==null||f.call(h,p)}},{emitOnBegin:e,interval:o}))})():(()=>{const d=Er(["watchBlockNumber",t.uid,e,r]);return fu(d,{onBlockNumber:n,onError:s},h=>{let f=!0,p=()=>f=!1;return(async()=>{try{const g=(()=>{if(t.transport.type==="fallback"){const w=t.transport.transports.find(b=>b.config.type==="webSocket");return w?w.value:t.transport}return t.transport})(),{unsubscribe:m}=await g.subscribe({params:["newHeads"],onData(w){var v;if(!f)return;const b=Fi((v=w.result)==null?void 0:v.number);h.onBlockNumber(b,c),c=b},onError(w){var b;(b=h.onError)==null||b.call(h,w)}});p=m,f||p()}catch(g){s==null||s(g)}})(),()=>p()})})()}async function EL(t,{confirmations:e=1,hash:r,onReplaced:n,pollingInterval:s=t.pollingInterval,retryCount:i=6,retryDelay:o=({count:c})=>~~(1<<c)*200,timeout:a=18e4}){const c=Er(["waitForTransactionReceipt",t.uid,r]);let u,l,d,h=!1,f,p;const{promise:g,resolve:m,reject:w}=Dv(),b=a?setTimeout(()=>{p(),f(),w(new B8({hash:r}))},a):void 0;return f=fu(c,{onReplaced:n,resolve:m,reject:w},v=>{p=Ze(t,vL,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:s,async onBlockNumber(A){const E=_=>{clearTimeout(b),p(),_(),f()};let y=A;if(!h)try{if(d){if(e>1&&(!d.blockNumber||y-d.blockNumber+1n<e))return;E(()=>v.resolve(d));return}if(u||(h=!0,await gu(async()=>{u=await Ze(t,zv,"getTransaction")({hash:r}),u.blockNumber&&(y=u.blockNumber)},{delay:o,retryCount:i}),h=!1),d=await Ze(t,wy,"getTransactionReceipt")({hash:r}),e>1&&(!d.blockNumber||y-d.blockNumber+1n<e))return;E(()=>v.resolve(d))}catch(_){if(_ instanceof uv||_ instanceof lv){if(!u){h=!1;return}try{l=u,h=!0;const T=await gu(()=>Ze(t,Aa,"getBlock")({blockNumber:y,includeTransactions:!0}),{delay:o,retryCount:i,shouldRetry:({error:O})=>O instanceof mv});h=!1;const S=T.transactions.find(({from:O,nonce:L})=>O===l.from&&L===l.nonce);if(!S||(d=await Ze(t,wy,"getTransactionReceipt")({hash:S.hash}),e>1&&(!d.blockNumber||y-d.blockNumber+1n<e)))return;let x="replaced";S.to===l.to&&S.value===l.value&&S.input===l.input?x="repriced":S.from===S.to&&S.value===0n&&(x="cancelled"),E(()=>{var O;(O=v.onReplaced)==null||O.call(v,{reason:x,replacedTransaction:l,transaction:S,transactionReceipt:d}),v.resolve(d)})}catch(T){E(()=>v.reject(T))}}else E(()=>v.reject(_))}}})}),g}function _L(t,{batch:e=!0,onError:r,onTransactions:n,poll:s,pollingInterval:i=t.pollingInterval}){return(typeof s<"u"?s:t.transport.type!=="webSocket")?(()=>{const u=Er(["watchPendingTransactions",t.uid,e,i]);return fu(u,{onTransactions:n,onError:r},l=>{let d;const h=Mv(async()=>{var f;try{if(!d)try{d=await Ze(t,gL,"createPendingTransactionFilter")({});return}catch(g){throw h(),g}const p=await Ze(t,X6,"getFilterChanges")({filter:d});if(p.length===0)return;if(e)l.onTransactions(p);else for(const g of p)l.onTransactions([g])}catch(p){(f=l.onError)==null||f.call(l,p)}},{emitOnBegin:!0,interval:i});return async()=>{d&&await Ze(t,Q6,"uninstallFilter")({filter:d}),h()}})})():(()=>{let u=!0,l=()=>u=!1;return(async()=>{try{const{unsubscribe:d}=await t.transport.subscribe({params:["newPendingTransactions"],onData(h){if(!u)return;const f=h.result;n([f])},onError(h){r==null||r(h)}});l=d,u||l()}catch(d){r==null||r(d)}})(),()=>l()})()}async function CL(t,{account:e=t.account,message:r}){if(!e)throw new $f({docsPath:"/docs/actions/wallet/signMessage"});const n=ln(e);if(n.signMessage)return n.signMessage({message:r});const s=typeof r=="string"?Zu(r):r.raw instanceof Uint8Array?ji(r.raw):r.raw;return t.request({method:"personal_sign",params:[s,n.address]},{retryCount:0})}const gd={createBalance(t,e){const r={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:r.name,symbol:r.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:r.value,price:r.price,quantity:{decimals:r.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:r.decimals})},iconUrl:r.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return oo(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const r=e[1],n=parseInt(r,10);return isNaN(n)?"0x0":`0x${n.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(r=>this.isValidAsset(r)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}},by={async getMyTokensWithBalance(t){const e=ne.state.address,r=P.state.activeCaipNetwork;if(!e||!r)return[];if(r.chainNamespace==="eip155"){const s=await this.getEIP155Balances(e,r);if(s)return this.filterLowQualityTokens(s)}const n=await he.getBalance(e,r.caipNetworkId,t);return this.filterLowQualityTokens(n.balances)},async getEIP155Balances(t,e){var r,n;try{const s=gd.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await le.getCapabilities(t);if(!((n=(r=i==null?void 0:i[s])==null?void 0:r.assetDiscovery)!=null&&n.supported))return null;const o=await le.walletGetAssets({account:t,chainFilter:[s]});return gd.isWalletGetAssetsResponse(o)?(o[s]||[]).map(c=>gd.createBalance(c,e.caipNetworkId)):null}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},mapBalancesToSwapTokens(t){return(t==null?void 0:t.map(e=>({...e,address:e!=null&&e.address?e.address:P.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},ke=Ye({tokenBalances:[],loading:!1}),AL={state:ke,subscribe(t){return Bt(ke,()=>t(ke))},subscribeKey(t,e){return Rt(ke,t,e)},setToken(t){t&&(ke.token=Rs(t))},setTokenAmount(t){ke.sendTokenAmount=t},setReceiverAddress(t){ke.receiverAddress=t},setReceiverProfileImageUrl(t){ke.receiverProfileImageUrl=t},setReceiverProfileName(t){ke.receiverProfileName=t},setNetworkBalanceInUsd(t){ke.networkBalanceInUSD=t},setLoading(t){ke.loading=t},async sendToken(){var t;try{switch(Oe.setLoading(!0),(t=P.state.activeCaipNetwork)==null?void 0:t.chainNamespace){case"eip155":await Oe.sendEvmToken();return;case"solana":await Oe.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{Oe.setLoading(!1)}},async sendEvmToken(){var r,n,s,i;const t=P.state.activeChain,e=(r=ne.state.preferredAccountTypes)==null?void 0:r[t];if(!Oe.state.sendTokenAmount||!Oe.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Oe.state.token)throw new Error("A token is required");(n=Oe.state.token)!=null&&n.address?(Ge.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===It.ACCOUNT_TYPES.SMART_ACCOUNT,token:Oe.state.token.address,amount:Oe.state.sendTokenAmount,network:((s=P.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}}),await Oe.sendERC20Token({receiverAddress:Oe.state.receiverAddress,tokenAddress:Oe.state.token.address,sendTokenAmount:Oe.state.sendTokenAmount,decimals:Oe.state.token.quantity.decimals})):(Ge.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===It.ACCOUNT_TYPES.SMART_ACCOUNT,token:Oe.state.token.symbol||"",amount:Oe.state.sendTokenAmount,network:((i=P.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)||""}}),await Oe.sendNativeToken({receiverAddress:Oe.state.receiverAddress,sendTokenAmount:Oe.state.sendTokenAmount,decimals:Oe.state.token.quantity.decimals}))},async fetchTokenBalance(t){var i,o;ke.loading=!0;const e=(i=P.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,r=(o=P.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=P.state.activeCaipAddress,s=n?ae.getPlainAddress(n):void 0;if(ke.lastRetry&&!ae.isAllowedRetry(ke.lastRetry,30*st.ONE_SEC_MS))return ke.loading=!1,[];try{if(s&&e&&r){const a=await by.getMyTokensWithBalance();return ke.tokenBalances=a,ke.lastRetry=void 0,a}}catch(a){ke.lastRetry=Date.now(),t==null||t(a),kr.showError("Token Balance Unavailable")}finally{ke.loading=!1}return[]},fetchNetworkBalance(){if(ke.tokenBalances.length===0)return;const t=by.mapBalancesToSwapTokens(ke.tokenBalances);if(!t)return;const e=t.find(r=>r.address===P.getActiveNetworkTokenAddress());e&&(ke.networkBalanceInUSD=e?ZE.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){var i,o,a,c;Ae.pushTransactionStack({view:null,goBack:!1});const e=t.receiverAddress,r=ne.state.address,n=le.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));await le.sendTransaction({chainNamespace:"eip155",to:e,address:r,data:"0x",value:n??BigInt(0)}),Ge.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:((i=ne.state.preferredAccountTypes)==null?void 0:i.eip155)===It.ACCOUNT_TYPES.SMART_ACCOUNT,token:((o=Oe.state.token)==null?void 0:o.symbol)||"",amount:t.sendTokenAmount,network:((a=P.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)||""}}),(c=le._getClient())==null||c.updateBalance("eip155"),Oe.resetSend()},async sendERC20Token(t){Ae.pushTransactionStack({view:"Account",goBack:!1});const e=le.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));if(ne.state.address&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const r=ae.getPlainAddress(t.tokenAddress);await le.writeContract({fromAddress:ne.state.address,tokenAddress:r,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:e_.getERC20Abi(r),chainNamespace:"eip155"}),Oe.resetSend()}},async sendSolanaToken(){var t;if(!Oe.state.sendTokenAmount||!Oe.state.receiverAddress)throw new Error("An amount and receiver address are required");Ae.pushTransactionStack({view:"Account",goBack:!1}),await le.sendTransaction({chainNamespace:"solana",to:Oe.state.receiverAddress,value:Oe.state.sendTokenAmount}),(t=le._getClient())==null||t.updateBalance("solana"),Oe.resetSend()},resetSend(){ke.token=void 0,ke.sendTokenAmount=void 0,ke.receiverAddress=void 0,ke.receiverProfileImageUrl=void 0,ke.receiverProfileName=void 0,ke.loading=!1,ke.tokenBalances=[]}},Oe=Cr(AL),md={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},Oc={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},Y=Ye({chains:BE(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),IL={state:Y,subscribe(t){return Bt(Y,()=>{t(Y)})},subscribeKey(t,e){return Rt(Y,t,e)},subscribeChainProp(t,e,r){let n;return Bt(Y.chains,()=>{var i;const s=r||Y.activeChain;if(s){const o=(i=Y.chains.get(s))==null?void 0:i[t];n!==o&&(n=o,e(o))}})},initialize(t,e,r){const{chainId:n,namespace:s}=Z.getActiveNetworkProps(),i=e==null?void 0:e.find(l=>l.id.toString()===(n==null?void 0:n.toString())),a=t.find(l=>(l==null?void 0:l.namespace)===s)||(t==null?void 0:t[0]),c=t.map(l=>l.namespace).filter(l=>l!==void 0),u=F.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(l=>l.chainNamespace))??[]]);((t==null?void 0:t.length)===0||!a)&&(Y.noAdapters=!0),Y.noAdapters||(Y.activeChain=a==null?void 0:a.namespace,Y.activeCaipNetwork=i,P.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),Y.activeChain&&rn.set({activeChain:a==null?void 0:a.namespace})),u.forEach(l=>{const d=e==null?void 0:e.filter(h=>h.chainNamespace===l);P.state.chains.set(l,{namespace:l,networkState:Ye({...Oc,caipNetwork:d==null?void 0:d[0]}),accountState:Ye(md),caipNetworks:d??[],...r}),P.setRequestedCaipNetworks(d??[],l)})},removeAdapter(t){var e,r;if(Y.activeChain===t){const n=Array.from(Y.chains.entries()).find(([s])=>s!==t);if(n){const s=(r=(e=n[1])==null?void 0:e.caipNetworks)==null?void 0:r[0];s&&P.setActiveCaipNetwork(s)}}Y.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:r},n){Y.chains.set(t.namespace,{namespace:t.namespace,networkState:{...Oc,caipNetwork:n[0]},accountState:md,caipNetworks:n,connectionControllerClient:r,networkControllerClient:e}),P.setRequestedCaipNetworks((n==null?void 0:n.filter(s=>s.chainNamespace===t.namespace))??[],t.namespace)},addNetwork(t){var r;const e=Y.chains.get(t.chainNamespace);if(e){const n=[...e.caipNetworks||[]];(r=e.caipNetworks)!=null&&r.find(s=>s.id===t.id)||n.push(t),Y.chains.set(t.chainNamespace,{...e,caipNetworks:n}),P.setRequestedCaipNetworks(n,t.chainNamespace),ee.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){var n,s,i;const r=Y.chains.get(t);if(r){const o=((n=Y.activeCaipNetwork)==null?void 0:n.id)===e,a=[...((s=r.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=r==null?void 0:r.caipNetworks)!=null&&i[0])&&P.setActiveCaipNetwork(r.caipNetworks[0]),Y.chains.set(t,{...r,caipNetworks:a}),P.setRequestedCaipNetworks(a||[],t),a.length===0&&ee.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const r=Y.chains.get(t);r&&(r.networkState={...r.networkState||Oc,...e},Y.chains.set(t,r))},setChainAccountData(t,e,r=!0){if(!t)throw new Error("Chain is required to update chain account data");const n=Y.chains.get(t);if(n){const s={...n.accountState||md,...e};Y.chains.set(t,{...n,accountState:s}),(Y.chains.size===1||Y.activeChain===t)&&(e.caipAddress&&(Y.activeCaipAddress=e.caipAddress),ne.replaceState(s))}},setChainNetworkData(t,e){if(!t)return;const r=Y.chains.get(t);if(r){const n={...r.networkState||Oc,...e};Y.chains.set(t,{...r,networkState:n})}},setAccountProp(t,e,r,n=!0){P.setChainAccountData(r,{[t]:e},n),t==="status"&&e==="disconnected"&&r&&ee.removeConnectorId(r)},setActiveNamespace(t){var n,s;Y.activeChain=t;const e=t?Y.chains.get(t):void 0,r=(n=e==null?void 0:e.networkState)==null?void 0:n.caipNetwork;r!=null&&r.id&&t&&(Y.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,Y.activeCaipNetwork=r,P.setChainNetworkData(t,{caipNetwork:r}),Z.setActiveCaipNetworkId(r==null?void 0:r.caipNetworkId),rn.set({activeChain:t,selectedNetworkId:r==null?void 0:r.caipNetworkId}))},setActiveCaipNetwork(t){var n,s,i;if(!t)return;Y.activeChain!==t.chainNamespace&&P.setIsSwitchingNamespace(!0);const e=Y.chains.get(t.chainNamespace);Y.activeChain=t.chainNamespace,Y.activeCaipNetwork=t,P.setChainNetworkData(t.chainNamespace,{caipNetwork:t}),(n=e==null?void 0:e.accountState)!=null&&n.address?Y.activeCaipAddress=`${t.chainNamespace}:${t.id}:${(s=e==null?void 0:e.accountState)==null?void 0:s.address}`:Y.activeCaipAddress=void 0,P.setAccountProp("caipAddress",Y.activeCaipAddress,t.chainNamespace),e&&ne.replaceState(e.accountState),Oe.resetSend(),rn.set({activeChain:Y.activeChain,selectedNetworkId:(i=Y.activeCaipNetwork)==null?void 0:i.caipNetworkId}),Z.setActiveCaipNetworkId(t.caipNetworkId),!P.checkIfSupportedNetwork(t.chainNamespace)&&F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&!le.state.wcBasic&&P.showUnsupportedChainUI()},addCaipNetwork(t){var r;if(!t)return;const e=Y.chains.get(t.chainNamespace);e&&((r=e==null?void 0:e.caipNetworks)==null||r.push(t))},async switchActiveNamespace(t){var s;if(!t)return;const e=t!==P.state.activeChain,r=(s=P.getNetworkData(t))==null?void 0:s.caipNetwork,n=P.getCaipNetworkByNamespace(t,r==null?void 0:r.id);e&&n&&await P.switchActiveNetwork(n)},async switchActiveNetwork(t){var s;const e=P.state.chains.get(P.state.activeChain);!((s=e==null?void 0:e.caipNetworks)!=null&&s.some(i=>{var o;return i.id===((o=Y.activeCaipNetwork)==null?void 0:o.id)}))&&Ae.goBack();const n=P.getNetworkControllerClient(t.chainNamespace);n&&(await n.switchCaipNetwork(t),Ge.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}}))},getNetworkControllerClient(t){const e=t||Y.activeChain,r=Y.chains.get(e);if(!r)throw new Error("Chain adapter not found");if(!r.networkControllerClient)throw new Error("NetworkController client not set");return r.networkControllerClient},getConnectionControllerClient(t){const e=t||Y.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const r=Y.chains.get(e);if(!(r!=null&&r.connectionControllerClient))throw new Error("ConnectionController client not set");return r.connectionControllerClient},getAccountProp(t,e){var s;let r=Y.activeChain;if(e&&(r=e),!r)return;const n=(s=Y.chains.get(r))==null?void 0:s.accountState;if(n)return n[t]},getNetworkProp(t,e){var n;const r=(n=Y.chains.get(e))==null?void 0:n.networkState;if(r)return r[t]},getRequestedCaipNetworks(t){const e=Y.chains.get(t),{approvedCaipNetworkIds:r=[],requestedCaipNetworks:n=[]}=(e==null?void 0:e.networkState)||{};return ae.sortRequestedNetworks(r,n)},getAllRequestedCaipNetworks(){const t=[];return Y.chains.forEach(e=>{const r=P.getRequestedCaipNetworks(e.namespace);t.push(...r)}),t},setRequestedCaipNetworks(t,e){P.setAdapterNetworkState(e,{requestedCaipNetworks:t});const n=P.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(n));ee.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return Y.chains.forEach(e=>{const r=P.getApprovedCaipNetworkIds(e.namespace);t.push(...r)}),t},getActiveCaipNetwork(){return Y.activeCaipNetwork},getActiveCaipAddress(){return Y.activeCaipAddress},getApprovedCaipNetworkIds(t){var n;const e=Y.chains.get(t);return((n=e==null?void 0:e.networkState)==null?void 0:n.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(t){const e=P.getNetworkControllerClient(),r=await(e==null?void 0:e.getApprovedCaipNetworksData());P.setAdapterNetworkState(t,{approvedCaipNetworkIds:r==null?void 0:r.approvedCaipNetworkIds,supportsAllNetworks:r==null?void 0:r.supportsAllNetworks})},checkIfSupportedNetwork(t,e){const r=e||Y.activeCaipNetwork,n=P.getRequestedCaipNetworks(t);return n.length?n==null?void 0:n.some(s=>s.id===(r==null?void 0:r.id)):!0},checkIfSupportedChainId(t){if(!Y.activeChain)return!0;const e=P.getRequestedCaipNetworks(Y.activeChain);return e==null?void 0:e.some(r=>r.id===t)},setSmartAccountEnabledNetworks(t,e){P.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){var n;const t=Go.caipNetworkIdToNumber((n=Y.activeCaipNetwork)==null?void 0:n.caipNetworkId),e=Y.activeChain;if(!e||!t)return!1;const r=P.getNetworkProp("smartAccountEnabledNetworks",e);return!!(r!=null&&r.includes(Number(t)))},getActiveNetworkTokenAddress(){var n,s;const t=((n=Y.activeCaipNetwork)==null?void 0:n.chainNamespace)||"eip155",e=((s=Y.activeCaipNetwork)==null?void 0:s.id)||1,r=st.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${r}`},showUnsupportedChainUI(){tt.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=Y.activeCaipNetwork;return!!(t!=null&&t.chainNamespace&&st.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){P.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");Y.activeCaipAddress=void 0,P.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountTypes:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),ee.removeConnectorId(e)},async disconnect(t){const e=b_(t);try{Oe.resetSend();const r=await Promise.allSettled(e.map(async([s,i])=>{var o;try{const{caipAddress:a}=P.getAccountData(s)||{};a&&((o=i.connectionControllerClient)!=null&&o.disconnect)&&await i.connectionControllerClient.disconnect(s),P.resetAccount(s),P.resetNetwork(s)}catch(a){throw new Error(`Failed to disconnect chain ${s}: ${a.message}`)}}));le.resetWcConnection();const n=r.filter(s=>s.status==="rejected");if(n.length>0)throw new Error(n.map(s=>s.reason.message).join(", "));Z.deleteConnectedSocialProvider(),t?ee.removeConnectorId(t):ee.resetConnectorIds(),Ge.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:t||"all"}})}catch(r){console.error(r.message||"Failed to disconnect chains"),Ge.sendEvent({type:"track",event:"DISCONNECT_ERROR",properties:{message:r.message||"Failed to disconnect chains"}})}},setIsSwitchingNamespace(t){Y.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){var r,n;const t=[];let e;if(Y.chains.forEach(s=>{q.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&t.push(s.namespace)}),t.length>0){const s=t[0];return e=s?(n=(r=Y.chains.get(s))==null?void 0:r.caipNetworks)==null?void 0:n[0]:void 0,e}},getAccountData(t){var e;return t?(e=P.state.chains.get(t))==null?void 0:e.accountState:ne.state},getNetworkData(t){var r;const e=t||Y.activeChain;if(e)return(r=P.state.chains.get(e))==null?void 0:r.networkState},getCaipNetworkByNamespace(t,e){var s,i,o;if(!t)return;const r=P.state.chains.get(t),n=(s=r==null?void 0:r.caipNetworks)==null?void 0:s.find(a=>a.id===e);return n||((i=r==null?void 0:r.networkState)==null?void 0:i.caipNetwork)||((o=r==null?void 0:r.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const t=ee.state.filterByNamespace;return(t?[Y.chains.get(t)]:Array.from(Y.chains.values())).flatMap(r=>(r==null?void 0:r.caipNetworks)||[]).map(r=>r.caipNetworkId)},getCaipNetworks(t){return t?P.getRequestedCaipNetworks(t):P.getAllRequestedCaipNetworks()}},P=Cr(IL),SL={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},Hv=ae.getBlockchainApiUrl(),zt=Ye({clientId:null,api:new qa({baseUrl:Hv,clientId:null}),supportedChains:{http:[],ws:[]}}),he={state:zt,async get(t){const{st:e,sv:r}=he.getSdkProperties(),n=F.state.projectId,s={...t.params||{},st:e,sv:r,projectId:n};return zt.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=F.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{zt.supportedChains.http.length||await he.getSupportedNetworks()}catch{return!1}return zt.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await he.get({path:"v1/supported-chains"});return zt.supportedChains=t,t}catch{return zt.supportedChains}},async fetchIdentity({address:t,caipNetworkId:e}){if(!await he.isNetworkSupported(e))return{avatar:"",name:""};const n=Z.getIdentityFromCacheForAddress(t);if(n)return n;const s=await he.get({path:`/v1/identity/${t}`,params:{sender:P.state.activeCaipAddress?ae.getPlainAddress(P.state.activeCaipAddress):void 0}});return Z.updateIdentityCache({address:t,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:t,cursor:e,onramp:r,signal:n,cache:s,chainId:i}){var a;return await he.isNetworkSupported((a=P.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?he.get({path:`/v1/account/${t}/history`,params:{cursor:e,onramp:r,chainId:i},signal:n,cache:s}):{data:[],next:void 0}},async fetchSwapQuote({amount:t,userAddress:e,from:r,to:n,gasPrice:s}){var o;return await he.isNetworkSupported((o=P.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?he.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:r,to:n,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){var r;return await he.isNetworkSupported((r=P.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?he.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){var r;return await he.isNetworkSupported((r=P.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?zt.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:F.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){var n;return await he.isNetworkSupported((n=P.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?he.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){var s;const{st:e,sv:r}=he.getSdkProperties();if(!await he.isNetworkSupported((s=P.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return he.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:r}})},async generateSwapCalldata({amount:t,from:e,to:r,userAddress:n,disableEstimate:s}){var o;if(!await he.isNetworkSupported((o=P.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return zt.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:st.CONVERT_SLIPPAGE_TOLERANCE},projectId:F.state.projectId,from:e,to:r,userAddress:n,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:r}){var o;const{st:n,sv:s}=he.getSdkProperties();if(!await he.isNetworkSupported((o=P.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return he.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:r,from:t,to:e,st:n,sv:s}})},async getBalance(t,e,r){var u;const{st:n,sv:s}=he.getSdkProperties();if(!await he.isNetworkSupported((u=P.state.activeCaipNetwork)==null?void 0:u.caipNetworkId))return kr.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=Z.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await he.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:r,st:n,sv:s}});return Z.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){var r;return await he.isNetworkSupported((r=P.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?he.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){var r;return await he.isNetworkSupported((r=P.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?he.get({path:`/v1/profile/reverse/${t}`,params:{sender:ne.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(t){var r;return await he.isNetworkSupported((r=P.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?he.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:r,signature:n}){var i;return await he.isNetworkSupported((i=P.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?zt.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:r,signature:n},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:r,purchaseAmount:n,paymentAmount:s}){var a;return await he.isNetworkSupported((a=P.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await zt.api.post({path:"/v1/generators/onrampurl",params:{projectId:F.state.projectId},body:{destinationWallets:t,defaultNetwork:r,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:n,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await he.isNetworkSupported((e=P.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await he.get({path:"/v1/onramp/options"})}catch{return SL}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:r,network:n}){var s;try{return await he.isNetworkSupported((s=P.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await zt.api.post({path:"/v1/onramp/quote",params:{projectId:F.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:r,network:n}}):null}catch{return{coinbaseFee:{amount:r,currency:e.id},networkFee:{amount:r,currency:e.id},paymentSubtotal:{amount:r,currency:e.id},paymentTotal:{amount:r,currency:e.id},purchaseAmount:{amount:r,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){var r;return await he.isNetworkSupported((r=P.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?he.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,r){var s;return await he.isNetworkSupported((s=P.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?zt.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:F.state.projectId},body:{pci:e,signature:r}}):{success:!1}},setClientId(t){zt.clientId=t,zt.api=new qa({baseUrl:Hv,clientId:t})}},gr=Ye({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),NL={state:gr,replaceState(t){t&&Object.assign(gr,Rs(t))},subscribe(t){return P.subscribeChainProp("accountState",e=>{if(e)return t(e)})},subscribeKey(t,e,r){let n;return P.subscribeChainProp("accountState",s=>{if(s){const i=s[t];n!==i&&(n=i,e(i))}},r)},setStatus(t,e){P.setAccountProp("status",t,e)},getCaipAddress(t){return P.getAccountProp("caipAddress",t)},setCaipAddress(t,e){const r=t?ae.getPlainAddress(t):void 0;e===P.state.activeChain&&(P.state.activeCaipAddress=t),P.setAccountProp("caipAddress",t,e),P.setAccountProp("address",r,e)},setBalance(t,e,r){P.setAccountProp("balance",t,r),P.setAccountProp("balanceSymbol",e,r)},setProfileName(t,e){P.setAccountProp("profileName",t,e)},setProfileImage(t,e){P.setAccountProp("profileImage",t,e)},setUser(t,e){P.setAccountProp("user",t,e)},setAddressExplorerUrl(t,e){P.setAccountProp("addressExplorerUrl",t,e)},setSmartAccountDeployed(t,e){P.setAccountProp("smartAccountDeployed",t,e)},setCurrentTab(t){P.setAccountProp("currentTab",t,P.state.activeChain)},setTokenBalance(t,e){t&&P.setAccountProp("tokenBalance",t,e)},setShouldUpdateToAddress(t,e){P.setAccountProp("shouldUpdateToAddress",t,e)},setAllAccounts(t,e){P.setAccountProp("allAccounts",t,e)},addAddressLabel(t,e,r){const n=P.getAccountProp("addressLabels",r)||new Map;n.set(t,e),P.setAccountProp("addressLabels",n,r)},removeAddressLabel(t,e){const r=P.getAccountProp("addressLabels",e)||new Map;r.delete(t),P.setAccountProp("addressLabels",r,e)},setConnectedWalletInfo(t,e){P.setAccountProp("connectedWalletInfo",t,e,!1)},setPreferredAccountType(t,e){P.setAccountProp("preferredAccountTypes",{...gr.preferredAccountTypes,[e]:t},e)},setPreferredAccountTypes(t){gr.preferredAccountTypes=t},setSocialProvider(t,e){t&&P.setAccountProp("socialProvider",t,e)},setSocialWindow(t,e){P.setAccountProp("socialWindow",t?Rs(t):void 0,e)},setFarcasterUrl(t,e){P.setAccountProp("farcasterUrl",t,e)},async fetchTokenBalance(t){var i,o;gr.balanceLoading=!0;const e=(i=P.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,r=(o=P.state.activeCaipNetwork)==null?void 0:o.chainNamespace,n=P.state.activeCaipAddress,s=n?ae.getPlainAddress(n):void 0;if(gr.lastRetry&&!ae.isAllowedRetry(gr.lastRetry,30*st.ONE_SEC_MS))return gr.balanceLoading=!1,[];try{if(s&&e&&r){const c=(await he.getBalance(s,e)).balances.filter(u=>u.quantity.decimals!=="0");return ne.setTokenBalance(c,r),gr.lastRetry=void 0,gr.balanceLoading=!1,c}}catch(a){gr.lastRetry=Date.now(),t==null||t(a),kr.showError("Token Balance Unavailable")}finally{gr.balanceLoading=!1}return[]},resetAccount(t){P.resetAccount(t)}},ne=Cr(NL),Ht=Ye({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),TL={state:Ht,subscribe(t){return Bt(Ht,()=>t(Ht))},subscribeKey(t,e){return Rt(Ht,t,e)},async open(t){var s;const e=ne.state.status==="connected";le.state.wcBasic?ue.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await ue.prefetch({fetchConnectorImages:!e,fetchFeaturedWallets:!e,fetchRecommendedWallets:!e}),t!=null&&t.namespace?(await P.switchActiveNamespace(t.namespace),tt.setLoading(!0,t.namespace)):tt.setLoading(!0),ee.setFilterByNamespace(t==null?void 0:t.namespace);const r=(s=P.getAccountData(t==null?void 0:t.namespace))==null?void 0:s.caipAddress,n=P.state.noAdapters;F.state.manualWCControl||n&&!r?ae.isMobile()?Ae.reset("AllWallets"):Ae.reset("ConnectingWalletConnectBasic"):t!=null&&t.view?Ae.reset(t.view,t.data):r?Ae.reset("Account"):Ae.reset("Connect"),Ht.open=!0,rn.set({open:!0}),Ge.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!r}})},close(t=!1){if(t||Ae.state.view!=="ApproveTransaction"){const e=F.state.enableEmbedded,r=!!P.state.activeCaipAddress;Ht.open&&Ge.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:r}}),Ht.open=!1,tt.clearLoading(),e?r?Ae.replace("Account"):Ae.push("Connect"):rn.set({open:!1})}le.resetUri()},setLoading(t,e){e&&Ht.loadingNamespaceMap.set(e,t),Ht.loading=t,rn.set({loading:t})},clearLoading(){Ht.loadingNamespaceMap.clear(),Ht.loading=!1},shake(){Ht.shake||(Ht.shake=!0,setTimeout(()=>{Ht.shake=!1},500))}},tt=Cr(TL),vy=2147483648,PL={convertEVMChainIdToCoinType(t){if(t>=vy)throw new Error("Invalid chainId");return(vy|t)>>>0}},mr=Ye({suggestions:[],loading:!1}),xL={state:mr,subscribe(t){return Bt(mr,()=>t(mr))},subscribeKey(t,e){return Rt(mr,t,e)},async resolveName(t){var e,r;try{return await he.lookupEnsName(t)}catch(n){const s=n;throw new Error(((r=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:r.description)||"Error resolving name")}},async isNameRegistered(t){try{return await he.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{mr.loading=!0,mr.suggestions=[];const e=await he.getEnsNameSuggestions(t);return mr.suggestions=e.suggestions.map(r=>({...r,name:r.name}))||[],mr.suggestions}catch(e){const r=qo.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(r)}finally{mr.loading=!1}},async getNamesForAddress(t){try{if(!P.state.activeCaipNetwork)return[];const r=Z.getEnsFromCacheForAddress(t);if(r)return r;const n=await he.reverseLookupEnsName({address:t});return Z.updateEnsCache({address:t,ens:n,timestamp:Date.now()}),n}catch(e){const r=qo.parseEnsApiError(e,"Error fetching names for address");throw new Error(r)}},async registerName(t){const e=P.state.activeCaipNetwork;if(!e)throw new Error("Network not found");const r=ne.state.address,n=ee.getAuthConnector();if(!r||!n)throw new Error("Address or auth connector not found");mr.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});Ae.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){mr.loading=!1}});const i=await le.signMessage(s),o=e.id;if(!o)throw new Error("Network not found");const a=PL.convertEVMChainIdToCoinType(Number(o));await he.registerEnsName({coinType:a,address:r,signature:i,message:s}),ne.setProfileName(t,e.chainNamespace),Ae.replace("RegisterAccountNameSuccess")}catch(s){const i=qo.parseEnsApiError(s,`Error registering name ${t}`);throw Ae.replace("RegisterAccountName"),new Error(i)}finally{mr.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){var n,s;const r=t;return((s=(n=r==null?void 0:r.reasons)==null?void 0:n[0])==null?void 0:s.description)||e}},qo=Cr(xL),Ke={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},Yn={ConnectorExplorerIds:{[q.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[q.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[q.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[q.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[q.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[Ke.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[Ke.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[Ke.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[Ke.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[Ke.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[Ke.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[Ke.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[Ke.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[Ke.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[Ke.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[Ke.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[q.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[q.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[q.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[q.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[q.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[q.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[q.CONNECTOR_ID.INJECTED]:"Browser Wallet",[q.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[q.CONNECTOR_ID.COINBASE]:"Coinbase",[q.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[q.CONNECTOR_ID.LEDGER]:"Ledger",[q.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[q.CONNECTOR_ID.INJECTED]:"INJECTED",[q.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[q.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[q.CONNECTOR_ID.AUTH]:"AUTH"}},il={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([r,n])=>{e[`${Ke.EIP155}:${r}`]=n}),e},isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())}},OL=new AbortController,pt={EmbeddedWalletAbortController:OL,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${RL()?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};function RL(){return typeof window<"u"}const $L={createLogger(t,e="error"){const r=Ji({level:e}),{logger:n}=Hh({opts:r});return n.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},n}},DL="rpc.walletconnect.org";function Ey(t,e){const r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",t),r.searchParams.set("projectId",e),r.toString()}const yd=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],en={extendRpcUrlWithProjectId(t,e){let r=!1;try{r=new URL(t).host===DL}catch{r=!1}if(r){const n=new URL(t);return n.searchParams.has("projectId")||n.searchParams.set("projectId",e),n.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:q.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${q.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,r){var s,i,o;const n=(o=(i=(s=t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return yd.includes(e)?Ey(e,r):n||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:r,customRpcUrls:n}){var h,f,p,g,m;const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=(h=t.rpcUrls.default.http)==null?void 0:h[0],a=this.getDefaultRpcUrl(t,i,r),c=((g=(p=(f=t==null?void 0:t.rpcUrls)==null?void 0:f.chainDefault)==null?void 0:p.http)==null?void 0:g[0])||o,u=((m=n==null?void 0:n[i])==null?void 0:m.map(w=>w.url))||[],l=[...u,a],d=[...u];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:Yn.NetworkImageIds[t.id],imageUrl:e==null?void 0:e[t.id]},rpcUrls:{...t.rpcUrls,default:{http:l},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:r,customRpcUrls:n}){return t.map(s=>en.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:n,projectId:r}))},getViemTransport(t,e,r){var s,i,o;const n=[];return r==null||r.forEach(a=>{n.push(xc(a.url,a.config))}),yd.includes(t.caipNetworkId)&&n.push(xc(Ey(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=t==null?void 0:t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{n.push(xc(a))}),my(n)},extendWagmiTransports(t,e,r){if(yd.includes(t.caipNetworkId)){const n=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return my([r,xc(n)])}return r},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:q.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){var c;const e=Z.getActiveCaipNetworkId(),r=P.getAllRequestedCaipNetworks(),n=Array.from(((c=P.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?n.includes(s):!1,o=r==null?void 0:r.find(u=>u.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||(r==null?void 0:r[0])}},mu={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},Wt=Ye({providers:{...mu},providerIds:{...mu}}),Le={state:Wt,subscribeKey(t,e){return Rt(Wt,t,e)},subscribe(t){return Bt(Wt,()=>{t(Wt)})},subscribeProviders(t){return Bt(Wt.providers,()=>t(Wt.providers))},setProvider(t,e){e&&(Wt.providers[t]=Rs(e))},getProvider(t){return Wt.providers[t]},setProviderId(t,e){e&&(Wt.providerIds[t]=e)},getProviderId(t){if(t)return Wt.providerIds[t]},reset(){Wt.providers={...mu},Wt.providerIds={...mu}},resetChain(t){Wt.providers[t]=void 0,Wt.providerIds[t]=void 0}},kL={BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org"},_y={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Ct={set(t,e){ar.isClient&&localStorage.setItem(`${re.STORAGE_KEY}${t}`,e)},get(t){return ar.isClient?localStorage.getItem(`${re.STORAGE_KEY}${t}`):null},delete(t,e){ar.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${re.STORAGE_KEY}${t}`))}},Rc=30*1e3,ar={checkIfAllowedToTriggerEmail(){const t=Ct.get(re.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Rc){const r=Math.ceil((Rc-e)/1e3);throw new Error(`Please try again after ${r} seconds`)}}},getTimeToNextEmailLogin(){const t=Ct.get(re.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Rc)return Math.ceil((Rc-e)/1e3)}return 0},checkIfRequestExists(t){return It.NOT_SAFE_RPC_METHODS.includes(t.method)||It.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&((t==null?void 0:t.match(_y.transactionHash))||(t==null?void 0:t.match(_y.signedMessage)))?re.RPC_RESPONSE_TYPE_TX:re.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return It.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var Pe;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Pe||(Pe={}));var Dh;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Dh||(Dh={}));const J=Pe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Wn=t=>{switch(typeof t){case"undefined":return J.undefined;case"string":return J.string;case"number":return isNaN(t)?J.nan:J.number;case"boolean":return J.boolean;case"function":return J.function;case"bigint":return J.bigint;case"symbol":return J.symbol;case"object":return Array.isArray(t)?J.array:t===null?J.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?J.promise:typeof Map<"u"&&t instanceof Map?J.map:typeof Set<"u"&&t instanceof Set?J.set:typeof Date<"u"&&t instanceof Date?J.date:J.object;default:return J.unknown}},z=Pe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),UL=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Mr extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const r=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let a=n,c=0;for(;c<o.path.length;){const u=o.path[c];c===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(r(o))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,Pe.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Mr.create=t=>new Mr(t);const Ia=(t,e)=>{let r;switch(t.code){case z.invalid_type:t.received===J.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case z.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Pe.jsonStringifyReplacer)}`;break;case z.unrecognized_keys:r=`Unrecognized key(s) in object: ${Pe.joinValues(t.keys,", ")}`;break;case z.invalid_union:r="Invalid input";break;case z.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Pe.joinValues(t.options)}`;break;case z.invalid_enum_value:r=`Invalid enum value. Expected ${Pe.joinValues(t.options)}, received '${t.received}'`;break;case z.invalid_arguments:r="Invalid function arguments";break;case z.invalid_return_type:r="Invalid function return type";break;case z.invalid_date:r="Invalid date";break;case z.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Pe.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case z.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case z.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case z.custom:r="Invalid input";break;case z.invalid_intersection_types:r="Intersection results could not be merged";break;case z.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case z.not_finite:r="Number must be finite";break;default:r=e.defaultError,Pe.assertNever(t)}return{message:r}};let Wv=Ia;function LL(t){Wv=t}function yu(){return Wv}const wu=t=>{const{data:e,path:r,errorMaps:n,issueData:s}=t,i=[...r,...s.path||[]],o={...s,path:i};let a="";const c=n.filter(u=>!!u).slice().reverse();for(const u of c)a=u(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},ML=[];function te(t,e){const r=wu({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,yu(),Ia].filter(n=>!!n)});t.common.issues.push(r)}class Ot{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const s of r){if(s.status==="aborted")return pe;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const s of r)n.push({key:await s.key,value:await s.value});return Ot.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const s of r){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return pe;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}}const pe=Object.freeze({status:"aborted"}),Vv=t=>({status:"dirty",value:t}),Ft=t=>({status:"valid",value:t}),kh=t=>t.status==="aborted",Uh=t=>t.status==="dirty",Sa=t=>t.status==="valid",bu=t=>typeof Promise<"u"&&t instanceof Promise;var oe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(oe||(oe={}));class cn{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Cy=(t,e)=>{if(Sa(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Mr(t.common.issues);return this._error=r,this._error}}};function we(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:n??a.defaultError}:{message:r??a.defaultError},description:s}}class ve{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Wn(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Wn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ot,ctx:{common:e.parent.common,data:e.data,parsedType:Wn(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(bu(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const s={common:{issues:[],async:(n=r==null?void 0:r.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wn(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Cy(s,i)}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Wn(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(bu(s)?s:Promise.resolve(s));return Cy(n,i)}refine(e,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:z.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new Fr({schema:this,typeName:de.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Tn.create(this,this._def)}nullable(){return Ws.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Br.create(this,this._def)}promise(){return Vi.create(this,this._def)}or(e){return xa.create([this,e],this._def)}and(e){return Oa.create(this,e,this._def)}transform(e){return new Fr({...we(this._def),schema:this,typeName:de.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new Ua({...we(this._def),innerType:this,defaultValue:r,typeName:de.ZodDefault})}brand(){return new Gv({typeName:de.ZodBranded,type:this,...we(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new Cu({...we(this._def),innerType:this,catchValue:r,typeName:de.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return oc.create(this,e)}readonly(){return Iu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const BL=/^c[^\s-]{8,}$/i,FL=/^[a-z][a-z0-9]*$/,jL=/^[0-9A-HJKMNP-TV-Z]{26}$/,qL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,zL=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,HL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let wd;const WL=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,VL=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,KL=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function GL(t,e){return!!((e==="v4"||!e)&&WL.test(t)||(e==="v6"||!e)&&VL.test(t))}class Lr extends ve{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==J.string){const i=this._getOrReturnCtx(e);return te(i,{code:z.invalid_type,expected:J.string,received:i.parsedType}),pe}const n=new Ot;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),te(s,{code:z.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),te(s,{code:z.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?te(s,{code:z.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&te(s,{code:z.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")zL.test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"email",code:z.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")wd||(wd=new RegExp(HL,"u")),wd.test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"emoji",code:z.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")qL.test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"uuid",code:z.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")BL.test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"cuid",code:z.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")FL.test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"cuid2",code:z.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")jL.test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"ulid",code:z.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),te(s,{validation:"url",code:z.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"regex",code:z.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),te(s,{code:z.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),te(s,{code:z.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),te(s,{code:z.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?KL(i).test(e.data)||(s=this._getOrReturnCtx(e,s),te(s,{code:z.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="ip"?GL(e.data,i.version)||(s=this._getOrReturnCtx(e,s),te(s,{validation:"ip",code:z.invalid_string,message:i.message}),n.dirty()):Pe.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:z.invalid_string,...oe.errToObj(n)})}_addCheck(e){return new Lr({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...oe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...oe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...oe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...oe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...oe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...oe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...oe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...oe.errToObj(e)})}datetime(e){var r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(r=e==null?void 0:e.offset)!==null&&r!==void 0?r:!1,...oe.errToObj(e==null?void 0:e.message)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...oe.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r==null?void 0:r.position,...oe.errToObj(r==null?void 0:r.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...oe.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...oe.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...oe.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...oe.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...oe.errToObj(r)})}nonempty(e){return this.min(1,oe.errToObj(e))}trim(){return new Lr({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Lr({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Lr({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Lr.create=t=>{var e;return new Lr({checks:[],typeName:de.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...we(t)})};function YL(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class is extends ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==J.number){const i=this._getOrReturnCtx(e);return te(i,{code:z.invalid_type,expected:J.number,received:i.parsedType}),pe}let n;const s=new Ot;for(const i of this._def.checks)i.kind==="int"?Pe.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),te(n,{code:z.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:z.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:z.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?YL(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),te(n,{code:z.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),te(n,{code:z.not_finite,message:i.message}),s.dirty()):Pe.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,oe.toString(r))}gt(e,r){return this.setLimit("min",e,!1,oe.toString(r))}lte(e,r){return this.setLimit("max",e,!0,oe.toString(r))}lt(e,r){return this.setLimit("max",e,!1,oe.toString(r))}setLimit(e,r,n,s){return new is({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:oe.toString(s)}]})}_addCheck(e){return new is({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:oe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:oe.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:oe.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:oe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:oe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:oe.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Pe.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}is.create=t=>new is({checks:[],typeName:de.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...we(t)});class os extends ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==J.bigint){const i=this._getOrReturnCtx(e);return te(i,{code:z.invalid_type,expected:J.bigint,received:i.parsedType}),pe}let n;const s=new Ot;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:z.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),te(n,{code:z.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),te(n,{code:z.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Pe.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,oe.toString(r))}gt(e,r){return this.setLimit("min",e,!1,oe.toString(r))}lte(e,r){return this.setLimit("max",e,!0,oe.toString(r))}lt(e,r){return this.setLimit("max",e,!1,oe.toString(r))}setLimit(e,r,n,s){return new os({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:oe.toString(s)}]})}_addCheck(e){return new os({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:oe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:oe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:oe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:oe.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:oe.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}os.create=t=>{var e;return new os({checks:[],typeName:de.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...we(t)})};class Na extends ve{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==J.boolean){const n=this._getOrReturnCtx(e);return te(n,{code:z.invalid_type,expected:J.boolean,received:n.parsedType}),pe}return Ft(e.data)}}Na.create=t=>new Na({typeName:de.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...we(t)});class zs extends ve{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==J.date){const i=this._getOrReturnCtx(e);return te(i,{code:z.invalid_type,expected:J.date,received:i.parsedType}),pe}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return te(i,{code:z.invalid_date}),pe}const n=new Ot;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),te(s,{code:z.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),te(s,{code:z.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Pe.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new zs({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:oe.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:oe.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}zs.create=t=>new zs({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:de.ZodDate,...we(t)});class vu extends ve{_parse(e){if(this._getType(e)!==J.symbol){const n=this._getOrReturnCtx(e);return te(n,{code:z.invalid_type,expected:J.symbol,received:n.parsedType}),pe}return Ft(e.data)}}vu.create=t=>new vu({typeName:de.ZodSymbol,...we(t)});class Ta extends ve{_parse(e){if(this._getType(e)!==J.undefined){const n=this._getOrReturnCtx(e);return te(n,{code:z.invalid_type,expected:J.undefined,received:n.parsedType}),pe}return Ft(e.data)}}Ta.create=t=>new Ta({typeName:de.ZodUndefined,...we(t)});class Pa extends ve{_parse(e){if(this._getType(e)!==J.null){const n=this._getOrReturnCtx(e);return te(n,{code:z.invalid_type,expected:J.null,received:n.parsedType}),pe}return Ft(e.data)}}Pa.create=t=>new Pa({typeName:de.ZodNull,...we(t)});class Wi extends ve{constructor(){super(...arguments),this._any=!0}_parse(e){return Ft(e.data)}}Wi.create=t=>new Wi({typeName:de.ZodAny,...we(t)});class Ps extends ve{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ft(e.data)}}Ps.create=t=>new Ps({typeName:de.ZodUnknown,...we(t)});class xn extends ve{_parse(e){const r=this._getOrReturnCtx(e);return te(r,{code:z.invalid_type,expected:J.never,received:r.parsedType}),pe}}xn.create=t=>new xn({typeName:de.ZodNever,...we(t)});class Eu extends ve{_parse(e){if(this._getType(e)!==J.undefined){const n=this._getOrReturnCtx(e);return te(n,{code:z.invalid_type,expected:J.void,received:n.parsedType}),pe}return Ft(e.data)}}Eu.create=t=>new Eu({typeName:de.ZodVoid,...we(t)});class Br extends ve{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==J.array)return te(r,{code:z.invalid_type,expected:J.array,received:r.parsedType}),pe;if(s.exactLength!==null){const o=r.data.length>s.exactLength.value,a=r.data.length<s.exactLength.value;(o||a)&&(te(r,{code:o?z.too_big:z.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(te(r,{code:z.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(te(r,{code:z.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,a)=>s.type._parseAsync(new cn(r,o,r.path,a)))).then(o=>Ot.mergeArray(n,o));const i=[...r.data].map((o,a)=>s.type._parseSync(new cn(r,o,r.path,a)));return Ot.mergeArray(n,i)}get element(){return this._def.type}min(e,r){return new Br({...this._def,minLength:{value:e,message:oe.toString(r)}})}max(e,r){return new Br({...this._def,maxLength:{value:e,message:oe.toString(r)}})}length(e,r){return new Br({...this._def,exactLength:{value:e,message:oe.toString(r)}})}nonempty(e){return this.min(1,e)}}Br.create=(t,e)=>new Br({type:t,minLength:null,maxLength:null,exactLength:null,typeName:de.ZodArray,...we(e)});function Ci(t){if(t instanceof Je){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Tn.create(Ci(n))}return new Je({...t._def,shape:()=>e})}else return t instanceof Br?new Br({...t._def,type:Ci(t.element)}):t instanceof Tn?Tn.create(Ci(t.unwrap())):t instanceof Ws?Ws.create(Ci(t.unwrap())):t instanceof un?un.create(t.items.map(e=>Ci(e))):t}class Je extends ve{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Pe.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==J.object){const u=this._getOrReturnCtx(e);return te(u,{code:z.invalid_type,expected:J.object,received:u.parsedType}),pe}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof xn&&this._def.unknownKeys==="strip"))for(const u in s.data)o.includes(u)||a.push(u);const c=[];for(const u of o){const l=i[u],d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new cn(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof xn){const u=this._def.unknownKeys;if(u==="passthrough")for(const l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(u==="strict")a.length>0&&(te(s,{code:z.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const l of a){const d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new cn(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const l of c){const d=await l.key;u.push({key:d,value:await l.value,alwaysSet:l.alwaysSet})}return u}).then(u=>Ot.mergeObjectSync(n,u)):Ot.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return oe.errToObj,new Je({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&o!==void 0?o:n.defaultError;return r.code==="unrecognized_keys"?{message:(a=oe.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new Je({...this._def,unknownKeys:"strip"})}passthrough(){return new Je({...this._def,unknownKeys:"passthrough"})}extend(e){return new Je({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Je({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:de.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Je({...this._def,catchall:e})}pick(e){const r={};return Pe.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Je({...this._def,shape:()=>r})}omit(e){const r={};return Pe.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new Je({...this._def,shape:()=>r})}deepPartial(){return Ci(this)}partial(e){const r={};return Pe.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}),new Je({...this._def,shape:()=>r})}required(e){const r={};return Pe.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Tn;)i=i._def.innerType;r[n]=i}}),new Je({...this._def,shape:()=>r})}keyof(){return Kv(Pe.objectKeys(this.shape))}}Je.create=(t,e)=>new Je({shape:()=>t,unknownKeys:"strip",catchall:xn.create(),typeName:de.ZodObject,...we(e)});Je.strictCreate=(t,e)=>new Je({shape:()=>t,unknownKeys:"strict",catchall:xn.create(),typeName:de.ZodObject,...we(e)});Je.lazycreate=(t,e)=>new Je({shape:t,unknownKeys:"strip",catchall:xn.create(),typeName:de.ZodObject,...we(e)});class xa extends ve{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new Mr(a.ctx.common.issues));return te(r,{code:z.invalid_union,unionErrors:o}),pe}if(r.common.async)return Promise.all(n.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of n){const u={...r,common:{...r.common,issues:[]},parent:null},l=c._parseSync({data:r.data,path:r.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!i&&(i={result:l,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new Mr(c));return te(r,{code:z.invalid_union,unionErrors:a}),pe}}get options(){return this._def.options}}xa.create=(t,e)=>new xa({options:t,typeName:de.ZodUnion,...we(e)});const Hc=t=>t instanceof $a?Hc(t.schema):t instanceof Fr?Hc(t.innerType()):t instanceof Da?[t.value]:t instanceof as?t.options:t instanceof ka?Object.keys(t.enum):t instanceof Ua?Hc(t._def.innerType):t instanceof Ta?[void 0]:t instanceof Pa?[null]:null;class ol extends ve{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==J.object)return te(r,{code:z.invalid_type,expected:J.object,received:r.parsedType}),pe;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(te(r,{code:z.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),pe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const s=new Map;for(const i of r){const o=Hc(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new ol({typeName:de.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...we(n)})}}function Lh(t,e){const r=Wn(t),n=Wn(e);if(t===e)return{valid:!0,data:t};if(r===J.object&&n===J.object){const s=Pe.objectKeys(e),i=Pe.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=Lh(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(r===J.array&&n===J.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=Lh(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return r===J.date&&n===J.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Oa extends ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(kh(i)||kh(o))return pe;const a=Lh(i.value,o.value);return a.valid?((Uh(i)||Uh(o))&&r.dirty(),{status:r.value,value:a.data}):(te(n,{code:z.invalid_intersection_types}),pe)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}Oa.create=(t,e,r)=>new Oa({left:t,right:e,typeName:de.ZodIntersection,...we(r)});class un extends ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.array)return te(n,{code:z.invalid_type,expected:J.array,received:n.parsedType}),pe;if(n.data.length<this._def.items.length)return te(n,{code:z.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),pe;!this._def.rest&&n.data.length>this._def.items.length&&(te(n,{code:z.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new cn(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Ot.mergeArray(r,o)):Ot.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new un({...this._def,rest:e})}}un.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new un({items:t,typeName:de.ZodTuple,rest:null,...we(e)})};class Ra extends ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.object)return te(n,{code:z.invalid_type,expected:J.object,received:n.parsedType}),pe;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in n.data)s.push({key:i._parse(new cn(n,a,n.path,a)),value:o._parse(new cn(n,n.data[a],n.path,a))});return n.common.async?Ot.mergeObjectAsync(r,s):Ot.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof ve?new Ra({keyType:e,valueType:r,typeName:de.ZodRecord,...we(n)}):new Ra({keyType:Lr.create(),valueType:e,typeName:de.ZodRecord,...we(r)})}}class _u extends ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.map)return te(n,{code:z.invalid_type,expected:J.map,received:n.parsedType}),pe;const s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,c],u)=>({key:s._parse(new cn(n,a,n.path,[u,"key"])),value:i._parse(new cn(n,c,n.path,[u,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return pe;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}})}else{const a=new Map;for(const c of o){const u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return pe;(u.status==="dirty"||l.status==="dirty")&&r.dirty(),a.set(u.value,l.value)}return{status:r.value,value:a}}}}_u.create=(t,e,r)=>new _u({valueType:e,keyType:t,typeName:de.ZodMap,...we(r)});class Hs extends ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==J.set)return te(n,{code:z.invalid_type,expected:J.set,received:n.parsedType}),pe;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(te(n,{code:z.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(te(n,{code:z.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function o(c){const u=new Set;for(const l of c){if(l.status==="aborted")return pe;l.status==="dirty"&&r.dirty(),u.add(l.value)}return{status:r.value,value:u}}const a=[...n.data.values()].map((c,u)=>i._parse(new cn(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,r){return new Hs({...this._def,minSize:{value:e,message:oe.toString(r)}})}max(e,r){return new Hs({...this._def,maxSize:{value:e,message:oe.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Hs.create=(t,e)=>new Hs({valueType:t,minSize:null,maxSize:null,typeName:de.ZodSet,...we(e)});class Pi extends ve{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==J.function)return te(r,{code:z.invalid_type,expected:J.function,received:r.parsedType}),pe;function n(a,c){return wu({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,yu(),Ia].filter(u=>!!u),issueData:{code:z.invalid_arguments,argumentsError:c}})}function s(a,c){return wu({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,yu(),Ia].filter(u=>!!u),issueData:{code:z.invalid_return_type,returnTypeError:c}})}const i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof Vi){const a=this;return Ft(async function(...c){const u=new Mr([]),l=await a._def.args.parseAsync(c,i).catch(f=>{throw u.addIssue(n(c,f)),u}),d=await Reflect.apply(o,this,l);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw u.addIssue(s(d,f)),u})})}else{const a=this;return Ft(function(...c){const u=a._def.args.safeParse(c,i);if(!u.success)throw new Mr([n(c,u.error)]);const l=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(l,i);if(!d.success)throw new Mr([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Pi({...this._def,args:un.create(e).rest(Ps.create())})}returns(e){return new Pi({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new Pi({args:e||un.create([]).rest(Ps.create()),returns:r||Ps.create(),typeName:de.ZodFunction,...we(n)})}}class $a extends ve{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}$a.create=(t,e)=>new $a({getter:t,typeName:de.ZodLazy,...we(e)});class Da extends ve{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return te(r,{received:r.data,code:z.invalid_literal,expected:this._def.value}),pe}return{status:"valid",value:e.data}}get value(){return this._def.value}}Da.create=(t,e)=>new Da({value:t,typeName:de.ZodLiteral,...we(e)});function Kv(t,e){return new as({values:t,typeName:de.ZodEnum,...we(e)})}class as extends ve{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return te(r,{expected:Pe.joinValues(n),received:r.parsedType,code:z.invalid_type}),pe}if(this._def.values.indexOf(e.data)===-1){const r=this._getOrReturnCtx(e),n=this._def.values;return te(r,{received:r.data,code:z.invalid_enum_value,options:n}),pe}return Ft(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e){return as.create(e)}exclude(e){return as.create(this.options.filter(r=>!e.includes(r)))}}as.create=Kv;class ka extends ve{_parse(e){const r=Pe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==J.string&&n.parsedType!==J.number){const s=Pe.objectValues(r);return te(n,{expected:Pe.joinValues(s),received:n.parsedType,code:z.invalid_type}),pe}if(r.indexOf(e.data)===-1){const s=Pe.objectValues(r);return te(n,{received:n.data,code:z.invalid_enum_value,options:s}),pe}return Ft(e.data)}get enum(){return this._def.values}}ka.create=(t,e)=>new ka({values:t,typeName:de.ZodNativeEnum,...we(e)});class Vi extends ve{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==J.promise&&r.common.async===!1)return te(r,{code:z.invalid_type,expected:J.promise,received:r.parsedType}),pe;const n=r.parsedType===J.promise?r.data:Promise.resolve(r.data);return Ft(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Vi.create=(t,e)=>new Vi({type:t,typeName:de.ZodPromise,...we(e)});class Fr extends ve{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===de.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{te(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:n.path,parent:n})):this._def.schema._parseSync({data:o,path:n.path,parent:n})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?pe:(a.status==="dirty"&&r.dirty(),o(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?pe:(a.status==="dirty"&&r.dirty(),o(a.value).then(()=>({status:r.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Sa(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Sa(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:r.value,value:a})):o);Pe.assertNever(s)}}Fr.create=(t,e,r)=>new Fr({schema:t,typeName:de.ZodEffects,effect:e,...we(r)});Fr.createWithPreprocess=(t,e,r)=>new Fr({schema:e,effect:{type:"preprocess",transform:t},typeName:de.ZodEffects,...we(r)});class Tn extends ve{_parse(e){return this._getType(e)===J.undefined?Ft(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Tn.create=(t,e)=>new Tn({innerType:t,typeName:de.ZodOptional,...we(e)});class Ws extends ve{_parse(e){return this._getType(e)===J.null?Ft(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ws.create=(t,e)=>new Ws({innerType:t,typeName:de.ZodNullable,...we(e)});class Ua extends ve{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===J.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}Ua.create=(t,e)=>new Ua({innerType:t,typeName:de.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...we(e)});class Cu extends ve{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return bu(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Mr(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Mr(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}Cu.create=(t,e)=>new Cu({innerType:t,typeName:de.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...we(e)});class Au extends ve{_parse(e){if(this._getType(e)!==J.nan){const n=this._getOrReturnCtx(e);return te(n,{code:z.invalid_type,expected:J.nan,received:n.parsedType}),pe}return{status:"valid",value:e.data}}}Au.create=t=>new Au({typeName:de.ZodNaN,...we(t)});const ZL=Symbol("zod_brand");class Gv extends ve{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class oc extends ve{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?pe:i.status==="dirty"?(r.dirty(),Vv(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?pe:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new oc({in:e,out:r,typeName:de.ZodPipeline})}}class Iu extends ve{_parse(e){const r=this._def.innerType._parse(e);return Sa(r)&&(r.value=Object.freeze(r.value)),r}}Iu.create=(t,e)=>new Iu({innerType:t,typeName:de.ZodReadonly,...we(e)});const Yv=(t,e={},r)=>t?Wi.create().superRefine((n,s)=>{var i,o;if(!t(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...u,fatal:c})}}):Wi.create(),JL={object:Je.lazycreate};var de;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(de||(de={}));const XL=(t,e={message:`Input not instance of ${t.name}`})=>Yv(r=>r instanceof t,e),Zv=Lr.create,Jv=is.create,QL=Au.create,eM=os.create,Xv=Na.create,tM=zs.create,rM=vu.create,nM=Ta.create,sM=Pa.create,iM=Wi.create,oM=Ps.create,aM=xn.create,cM=Eu.create,uM=Br.create,lM=Je.create,dM=Je.strictCreate,hM=xa.create,fM=ol.create,pM=Oa.create,gM=un.create,mM=Ra.create,yM=_u.create,wM=Hs.create,bM=Pi.create,vM=$a.create,EM=Da.create,_M=as.create,CM=ka.create,AM=Vi.create,Ay=Fr.create,IM=Tn.create,SM=Ws.create,NM=Fr.createWithPreprocess,TM=oc.create,PM=()=>Zv().optional(),xM=()=>Jv().optional(),OM=()=>Xv().optional(),RM={string:t=>Lr.create({...t,coerce:!0}),number:t=>is.create({...t,coerce:!0}),boolean:t=>Na.create({...t,coerce:!0}),bigint:t=>os.create({...t,coerce:!0}),date:t=>zs.create({...t,coerce:!0})},$M=pe;var C=Object.freeze({__proto__:null,defaultErrorMap:Ia,setErrorMap:LL,getErrorMap:yu,makeIssue:wu,EMPTY_PATH:ML,addIssueToContext:te,ParseStatus:Ot,INVALID:pe,DIRTY:Vv,OK:Ft,isAborted:kh,isDirty:Uh,isValid:Sa,isAsync:bu,get util(){return Pe},get objectUtil(){return Dh},ZodParsedType:J,getParsedType:Wn,ZodType:ve,ZodString:Lr,ZodNumber:is,ZodBigInt:os,ZodBoolean:Na,ZodDate:zs,ZodSymbol:vu,ZodUndefined:Ta,ZodNull:Pa,ZodAny:Wi,ZodUnknown:Ps,ZodNever:xn,ZodVoid:Eu,ZodArray:Br,ZodObject:Je,ZodUnion:xa,ZodDiscriminatedUnion:ol,ZodIntersection:Oa,ZodTuple:un,ZodRecord:Ra,ZodMap:_u,ZodSet:Hs,ZodFunction:Pi,ZodLazy:$a,ZodLiteral:Da,ZodEnum:as,ZodNativeEnum:ka,ZodPromise:Vi,ZodEffects:Fr,ZodTransformer:Fr,ZodOptional:Tn,ZodNullable:Ws,ZodDefault:Ua,ZodCatch:Cu,ZodNaN:Au,BRAND:ZL,ZodBranded:Gv,ZodPipeline:oc,ZodReadonly:Iu,custom:Yv,Schema:ve,ZodSchema:ve,late:JL,get ZodFirstPartyTypeKind(){return de},coerce:RM,any:iM,array:uM,bigint:eM,boolean:Xv,date:tM,discriminatedUnion:fM,effect:Ay,enum:_M,function:bM,instanceof:XL,intersection:pM,lazy:vM,literal:EM,map:yM,nan:QL,nativeEnum:CM,never:aM,null:sM,nullable:SM,number:Jv,object:lM,oboolean:OM,onumber:xM,optional:IM,ostring:PM,pipeline:TM,preprocess:NM,promise:AM,record:mM,set:wM,strictObject:dM,string:Zv,symbol:rM,transformer:Ay,tuple:gM,undefined:nM,union:hM,unknown:oM,void:cM,NEVER:$M,ZodIssueCode:z,quotelessJson:UL,ZodError:Mr});const Xe=C.object({message:C.string()});function X(t){return C.literal(re[t])}C.object({accessList:C.array(C.string()),blockHash:C.string().nullable(),blockNumber:C.string().nullable(),chainId:C.string().or(C.number()),from:C.string(),gas:C.string(),hash:C.string(),input:C.string().nullable(),maxFeePerGas:C.string(),maxPriorityFeePerGas:C.string(),nonce:C.string(),r:C.string(),s:C.string(),to:C.string(),transactionIndex:C.string().nullable(),type:C.string(),v:C.string(),value:C.string()});const DM=C.object({chainId:C.string().or(C.number())}),kM=C.object({email:C.string().email()}),UM=C.object({otp:C.string()}),LM=C.object({uri:C.string(),preferredAccountType:C.optional(C.string())}),MM=C.object({chainId:C.optional(C.string().or(C.number())),preferredAccountType:C.optional(C.string()),socialUri:C.optional(C.string())}),BM=C.object({provider:C.enum(["google","github","apple","facebook","x","discord"])}),FM=C.object({email:C.string().email()}),jM=C.object({otp:C.string()}),qM=C.object({otp:C.string()}),zM=C.object({themeMode:C.optional(C.enum(["light","dark"])),themeVariables:C.optional(C.record(C.string(),C.string().or(C.number()))),w3mThemeVariables:C.optional(C.record(C.string(),C.string()))}),HM=C.object({metadata:C.object({name:C.string(),description:C.string(),url:C.string(),icons:C.array(C.string())}).optional(),sdkVersion:C.string().optional(),sdkType:C.string().optional(),projectId:C.string()}),WM=C.object({type:C.string()}),VM=C.object({action:C.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),KM=C.object({url:C.string()}),GM=C.object({userName:C.string()}),YM=C.object({email:C.string().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),accounts:C.array(C.object({address:C.string(),type:C.enum([It.ACCOUNT_TYPES.EOA,It.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:C.string().optional().nullable(),preferredAccountType:C.optional(C.string())}),ZM=C.object({action:C.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),JM=C.object({email:C.string().email().optional().nullable(),address:C.string(),chainId:C.string().or(C.number()),smartAccountDeployed:C.optional(C.boolean()),accounts:C.array(C.object({address:C.string(),type:C.enum([It.ACCOUNT_TYPES.EOA,It.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:C.optional(C.string())}),XM=C.object({uri:C.string()}),QM=C.object({isConnected:C.boolean()}),eB=C.object({chainId:C.string().or(C.number())}),tB=C.object({chainId:C.string().or(C.number())}),rB=C.object({newEmail:C.string().email()}),nB=C.object({smartAccountEnabledNetworks:C.array(C.number())});C.object({address:C.string(),isDeployed:C.boolean()});const sB=C.object({version:C.string().optional()}),iB=C.object({type:C.string(),address:C.string()}),oB=C.any(),aB=C.object({method:C.literal("eth_accounts")}),cB=C.object({method:C.literal("eth_blockNumber")}),uB=C.object({method:C.literal("eth_call"),params:C.array(C.any())}),lB=C.object({method:C.literal("eth_chainId")}),dB=C.object({method:C.literal("eth_estimateGas"),params:C.array(C.any())}),hB=C.object({method:C.literal("eth_feeHistory"),params:C.array(C.any())}),fB=C.object({method:C.literal("eth_gasPrice")}),pB=C.object({method:C.literal("eth_getAccount"),params:C.array(C.any())}),gB=C.object({method:C.literal("eth_getBalance"),params:C.array(C.any())}),mB=C.object({method:C.literal("eth_getBlockByHash"),params:C.array(C.any())}),yB=C.object({method:C.literal("eth_getBlockByNumber"),params:C.array(C.any())}),wB=C.object({method:C.literal("eth_getBlockReceipts"),params:C.array(C.any())}),bB=C.object({method:C.literal("eth_getBlockTransactionCountByHash"),params:C.array(C.any())}),vB=C.object({method:C.literal("eth_getBlockTransactionCountByNumber"),params:C.array(C.any())}),EB=C.object({method:C.literal("eth_getCode"),params:C.array(C.any())}),_B=C.object({method:C.literal("eth_getFilterChanges"),params:C.array(C.any())}),CB=C.object({method:C.literal("eth_getFilterLogs"),params:C.array(C.any())}),AB=C.object({method:C.literal("eth_getLogs"),params:C.array(C.any())}),IB=C.object({method:C.literal("eth_getProof"),params:C.array(C.any())}),SB=C.object({method:C.literal("eth_getStorageAt"),params:C.array(C.any())}),NB=C.object({method:C.literal("eth_getTransactionByBlockHashAndIndex"),params:C.array(C.any())}),TB=C.object({method:C.literal("eth_getTransactionByBlockNumberAndIndex"),params:C.array(C.any())}),PB=C.object({method:C.literal("eth_getTransactionByHash"),params:C.array(C.any())}),xB=C.object({method:C.literal("eth_getTransactionCount"),params:C.array(C.any())}),OB=C.object({method:C.literal("eth_getTransactionReceipt"),params:C.array(C.any())}),RB=C.object({method:C.literal("eth_getUncleCountByBlockHash"),params:C.array(C.any())}),$B=C.object({method:C.literal("eth_getUncleCountByBlockNumber"),params:C.array(C.any())}),DB=C.object({method:C.literal("eth_maxPriorityFeePerGas")}),kB=C.object({method:C.literal("eth_newBlockFilter")}),UB=C.object({method:C.literal("eth_newFilter"),params:C.array(C.any())}),LB=C.object({method:C.literal("eth_newPendingTransactionFilter")}),MB=C.object({method:C.literal("eth_sendRawTransaction"),params:C.array(C.any())}),BB=C.object({method:C.literal("eth_syncing"),params:C.array(C.any())}),FB=C.object({method:C.literal("eth_uninstallFilter"),params:C.array(C.any())}),Iy=C.object({method:C.literal("personal_sign"),params:C.array(C.any())}),jB=C.object({method:C.literal("eth_signTypedData_v4"),params:C.array(C.any())}),qB=C.object({method:C.literal("eth_sendTransaction"),params:C.array(C.any())}),zB=C.object({method:C.literal("solana_signMessage"),params:C.object({message:C.string(),pubkey:C.string()})}),HB=C.object({method:C.literal("solana_signTransaction"),params:C.object({transaction:C.string()})}),WB=C.object({method:C.literal("solana_signAllTransactions"),params:C.object({transactions:C.array(C.string())})}),VB=C.object({method:C.literal("solana_signAndSendTransaction"),params:C.object({transaction:C.string(),options:C.object({skipPreflight:C.boolean().optional(),preflightCommitment:C.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:C.number().optional(),minContextSlot:C.number().optional()}).optional()})}),KB=C.object({method:C.literal("wallet_sendCalls"),params:C.array(C.object({chainId:C.string().or(C.number()).optional(),from:C.string().optional(),version:C.string().optional(),capabilities:C.any().optional(),calls:C.array(C.object({to:C.string().startsWith("0x"),data:C.string().startsWith("0x").optional(),value:C.string().optional()}))}))}),GB=C.object({method:C.literal("wallet_getCallsStatus"),params:C.array(C.string())}),YB=C.object({method:C.literal("wallet_getCapabilities")}),ZB=C.object({method:C.literal("wallet_grantPermissions"),params:C.array(C.any())}),JB=C.object({method:C.literal("wallet_revokePermissions"),params:C.any()}),XB=C.object({method:C.literal("wallet_getAssets"),params:C.any()}),Sy=C.object({token:C.string()}),Q=C.object({id:C.string().optional()}),Io={appEvent:Q.extend({type:X("APP_SWITCH_NETWORK"),payload:DM}).or(Q.extend({type:X("APP_CONNECT_EMAIL"),payload:kM})).or(Q.extend({type:X("APP_CONNECT_DEVICE")})).or(Q.extend({type:X("APP_CONNECT_OTP"),payload:UM})).or(Q.extend({type:X("APP_CONNECT_SOCIAL"),payload:LM})).or(Q.extend({type:X("APP_GET_FARCASTER_URI")})).or(Q.extend({type:X("APP_CONNECT_FARCASTER")})).or(Q.extend({type:X("APP_GET_USER"),payload:C.optional(MM)})).or(Q.extend({type:X("APP_GET_SOCIAL_REDIRECT_URI"),payload:BM})).or(Q.extend({type:X("APP_SIGN_OUT")})).or(Q.extend({type:X("APP_IS_CONNECTED"),payload:C.optional(Sy)})).or(Q.extend({type:X("APP_GET_CHAIN_ID")})).or(Q.extend({type:X("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(Q.extend({type:X("APP_INIT_SMART_ACCOUNT")})).or(Q.extend({type:X("APP_SET_PREFERRED_ACCOUNT"),payload:WM})).or(Q.extend({type:X("APP_RPC_REQUEST"),payload:Iy.or(XB).or(aB).or(cB).or(uB).or(lB).or(dB).or(hB).or(fB).or(pB).or(gB).or(mB).or(yB).or(wB).or(bB).or(vB).or(EB).or(_B).or(CB).or(AB).or(IB).or(SB).or(NB).or(TB).or(PB).or(xB).or(OB).or(RB).or($B).or(DB).or(kB).or(UB).or(LB).or(MB).or(BB).or(FB).or(Iy).or(jB).or(qB).or(zB).or(HB).or(WB).or(VB).or(GB).or(KB).or(YB).or(ZB).or(JB)})).or(Q.extend({type:X("APP_UPDATE_EMAIL"),payload:FM})).or(Q.extend({type:X("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:jM})).or(Q.extend({type:X("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:qM})).or(Q.extend({type:X("APP_SYNC_THEME"),payload:zM})).or(Q.extend({type:X("APP_SYNC_DAPP_DATA"),payload:HM})).or(Q.extend({type:X("APP_RELOAD")})),frameEvent:Q.extend({type:X("FRAME_SWITCH_NETWORK_ERROR"),payload:Xe}).or(Q.extend({type:X("FRAME_SWITCH_NETWORK_SUCCESS"),payload:tB})).or(Q.extend({type:X("FRAME_CONNECT_EMAIL_SUCCESS"),payload:VM})).or(Q.extend({type:X("FRAME_CONNECT_EMAIL_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:KM})).or(Q.extend({type:X("FRAME_GET_FARCASTER_URI_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:GM})).or(Q.extend({type:X("FRAME_CONNECT_FARCASTER_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_CONNECT_OTP_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_CONNECT_OTP_SUCCESS")})).or(Q.extend({type:X("FRAME_CONNECT_DEVICE_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_CONNECT_DEVICE_SUCCESS")})).or(Q.extend({type:X("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:YM})).or(Q.extend({type:X("FRAME_CONNECT_SOCIAL_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_GET_USER_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_GET_USER_SUCCESS"),payload:JM})).or(Q.extend({type:X("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:XM})).or(Q.extend({type:X("FRAME_SIGN_OUT_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_SIGN_OUT_SUCCESS")})).or(Q.extend({type:X("FRAME_IS_CONNECTED_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_IS_CONNECTED_SUCCESS"),payload:QM})).or(Q.extend({type:X("FRAME_GET_CHAIN_ID_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_GET_CHAIN_ID_SUCCESS"),payload:eB})).or(Q.extend({type:X("FRAME_RPC_REQUEST_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_RPC_REQUEST_SUCCESS"),payload:oB})).or(Q.extend({type:X("FRAME_SESSION_UPDATE"),payload:Sy})).or(Q.extend({type:X("FRAME_UPDATE_EMAIL_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_UPDATE_EMAIL_SUCCESS"),payload:ZM})).or(Q.extend({type:X("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(Q.extend({type:X("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:rB})).or(Q.extend({type:X("FRAME_SYNC_THEME_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_SYNC_THEME_SUCCESS")})).or(Q.extend({type:X("FRAME_SYNC_DAPP_DATA_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(Q.extend({type:X("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:nB})).or(Q.extend({type:X("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:iB})).or(Q.extend({type:X("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_READY"),payload:sB})).or(Q.extend({type:X("FRAME_RELOAD_ERROR"),payload:Xe})).or(Q.extend({type:X("FRAME_RELOAD_SUCCESS")}))};function bd(t,e={}){var r;return typeof(e==null?void 0:e.type)=="string"&&((r=e==null?void 0:e.type)==null?void 0:r.includes(t))}class QB{constructor({projectId:e,isAppClient:r=!1,chainId:n="eip155:1",enableLogger:s=!0}){if(this.iframe=null,this.iframeIsReady=!1,this.rpcUrl=kL.BLOCKCHAIN_API_RPC_URL,this.initFrame=()=>{const i=document.getElementById("w3m-iframe");this.iframe&&!i&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(i,o,a)=>{function c({data:u}){if(!bd(re.FRAME_EVENT_KEY,u))return;const l=Io.frameEvent.parse(u);l.id===i&&(o(l),window.removeEventListener("message",c))}ar.isClient&&(window.addEventListener("message",c),a.addEventListener("abort",()=>{window.removeEventListener("message",c)}))},onFrameEvent:i=>{ar.isClient&&window.addEventListener("message",({data:o})=>{if(!bd(re.FRAME_EVENT_KEY,o))return;const a=Io.frameEvent.parse(o);i(a)})},onAppEvent:i=>{ar.isClient&&window.addEventListener("message",({data:o})=>{if(!bd(re.APP_EVENT_KEY,o))return;const a=Io.appEvent.parse(o);i(a)})},postAppEvent:i=>{var o;if(ar.isClient){if(!((o=this.iframe)!=null&&o.contentWindow))throw new Error("W3mFrame: iframe is not set");Io.appEvent.parse(i),this.iframe.contentWindow.postMessage(i,"*")}},postFrameEvent:i=>{if(ar.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");Io.frameEvent.parse(i),parent.postMessage(i,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),r&&(this.frameLoadPromise=new Promise((i,o)=>{this.frameLoadPromiseResolver={resolve:i,reject:o}}),ar.isClient)){const i=document.createElement("iframe");i.id="w3m-iframe",i.src=`${AU}?projectId=${e}&chainId=${n}&version=${SU}&enableLogger=${s}`,i.name="w3m-secure-iframe",i.style.position="fixed",i.style.zIndex="999999",i.style.display="none",i.style.border="none",i.style.animationDelay="0s, 50ms",i.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",i.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=i,this.iframe.onerror=()=>{var o;(o=this.frameLoadPromiseResolver)==null||o.reject("Unable to load email login dependency")},this.events.onFrameEvent(o=>{var a;o.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(a=this.frameLoadPromiseResolver)==null||a.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(r=>({[r]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${r}&projectId=${this.projectId}`,chainId:r}}));return Object.assign({},...e)}}class e4{constructor(e){var i;const r=Ji({level:IU}),{logger:n,chunkLoggerController:s}=Hh({opts:r});this.logger=$t(n,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class t4{constructor({projectId:e,chainId:r,enableLogger:n=!0,onTimeout:s,abortController:i}){this.openRpcRequests=[],this.isInitialized=!1,n&&(this.w3mLogger=new e4(e)),this.abortController=i,this.w3mFrame=new QB({projectId:e,isAppClient:!0,chainId:r,enableLogger:n}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(r=>{r.type===re.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Ct.get(re.EMAIL_LOGIN_USED_KEY)}getEmail(){return Ct.get(re.EMAIL)}getUsername(){return Ct.get(re.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:re.APP_RELOAD})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error reloading iframe"),r}}async connectEmail(e){var r;try{ar.checkIfAllowedToTriggerEmail(),await this.init();const n=await this.appEvent({type:re.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){var e;try{return this.appEvent({type:re.APP_CONNECT_DEVICE})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error connecting device"),r}}async connectOtp(e){var r;try{return this.appEvent({type:re.APP_CONNECT_OTP,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const r=await this.appEvent({type:re.APP_IS_CONNECTED});return r!=null&&r.isConnected||this.deleteAuthLoginCache(),r}catch(r){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:r},"Error checking connection"),r}}async getChainId(){var e;try{const r=await this.appEvent({type:re.APP_GET_CHAIN_ID});return this.setLastUsedChainId(r.chainId),r}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error getting chain id"),r}}async getSocialRedirectUri(e){var r;try{return await this.init(),this.appEvent({type:re.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){var r;try{const n=await this.appEvent({type:re.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){var r;try{return this.appEvent({type:re.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){var r;try{const n=await this.appEvent({type:re.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){var r;try{return this.appEvent({type:re.APP_SYNC_THEME,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){var r;try{return this.appEvent({type:re.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){var e;try{const r=await this.appEvent({type:re.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(r.smartAccountEnabledNetworks),r}catch(r){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:r},"Error getting smart account enabled networks"),r}}async setPreferredAccount(e){var r;try{return this.appEvent({type:re.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){var r,n;if(e!=null&&e.socialUri)try{await this.init();const s=await this.appEvent({type:re.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType}});return s.userName&&this.setSocialLoginSuccess(s.userName),this.setLoginSuccess(s.email),this.setLastUsedChainId(s.chainId),this.user=s,s}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1;e!=null&&e.preferredAccountType&&await this.setPreferredAccount(e.preferredAccountType);const i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(n=this.w3mLogger)==null||n.logger.error({error:s},"Error connecting"),s}}async getUser(e){var r;try{await this.init();const n=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:re.APP_GET_USER,payload:{...e,chainId:n}});return this.user=s,s}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting"),n}}async connectSocial(e){var r;try{await this.init();const n=await this.appEvent({type:re.APP_CONNECT_SOCIAL,payload:{uri:e}});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error connecting social"),n}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:re.APP_GET_FARCASTER_URI})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error getting farcaster uri"),r}}async connectFarcaster(){var e;try{const r=await this.appEvent({type:re.APP_CONNECT_FARCASTER});return r.userName&&this.setSocialLoginSuccess(r.userName),r}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error connecting farcaster"),r}}async switchNetwork(e){var r;try{const n=await this.appEvent({type:re.APP_SWITCH_NETWORK,payload:{chainId:e}});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(r=this.w3mLogger)==null||r.logger.error({error:n},"Error switching network"),n}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async n=>{const s=setTimeout(()=>{n()},3e3);await this.appEvent({type:re.APP_SIGN_OUT}),clearTimeout(s),n()})}catch(r){throw(e=this.w3mLogger)==null||e.logger.error({error:r},"Error disconnecting"),r}}async request(e){var r,n,s,i;try{if(It.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();(r=this.rpcRequestHandler)==null||r.call(this,e);const o=await this.appEvent({type:re.APP_RPC_REQUEST,payload:e});return(n=this.rpcSuccessHandler)==null||n.call(this,o,e),o}catch(o){throw(s=this.rpcErrorHandler)==null||s.call(this,o,e),(i=this.w3mLogger)==null||i.logger.error({error:o},"Error requesting"),o}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===re.FRAME_IS_CONNECTED_SUCCESS&&r.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===re.FRAME_IS_CONNECTED_ERROR&&e(),r.type===re.FRAME_IS_CONNECTED_SUCCESS&&!r.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===re.FRAME_GET_USER_SUCCESS&&e(r.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===re.FRAME_CONNECT_SOCIAL_SUCCESS&&e(r.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===re.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(r.payload):r.type===re.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:It.ACCOUNT_TYPES.EOA})})}onGetSmartAccountEnabledNetworks(e){this.w3mFrame.events.onFrameEvent(r=>{r.type===re.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS?e(r.payload.smartAccountEnabledNetworks):r.type===re.FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR&&e([])})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}rejectRpcRequests(){var e;try{this.openRpcRequests.forEach(({abortController:r,method:n})=>{It.SAFE_RPC_METHODS.includes(n)||r.abort()}),this.openRpcRequests=[]}catch(r){(e=this.w3mLogger)==null||e.logger.error({error:r},"Error aborting RPC request")}}async appEvent(e){let r,n;function s(c){return c.replace("@w3m-app/","")}const i=[re.APP_SYNC_DAPP_DATA,re.APP_SYNC_THEME,re.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(n=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(n),[re.APP_CONNECT_EMAIL,re.APP_CONNECT_DEVICE,re.APP_CONNECT_OTP,re.APP_CONNECT_SOCIAL,re.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(r=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},3e4)),new Promise((c,u)=>{var f,p,g;const l=Math.random().toString(36).substring(7);(g=(f=this.w3mLogger)==null?void 0:(p=f.logger).info)==null||g.call(p,{event:e,id:l},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:l});const d=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests=[...this.openRpcRequests,{...m.payload,abortController:d}]}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?u(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&u(new Error("Something went wrong"))});function h(m,w){var b,v,A;m.id===l&&((v=w==null?void 0:(b=w.logger).info)==null||v.call(b,{framEvent:m,id:l},"Received frame response"),m.type===`@w3m-frame/${o}_SUCCESS`?(r&&clearTimeout(r),n&&clearTimeout(n),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(r&&clearTimeout(r),n&&clearTimeout(n),"payload"in m&&u(new Error(((A=m.payload)==null?void 0:A.message)||"An error occurred")),u(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(l,m=>h(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Ct.set(re.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Ct.set(re.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Ct.set(re.EMAIL,e),Ct.set(re.EMAIL_LOGIN_USED_KEY,"true"),Ct.delete(re.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Ct.delete(re.EMAIL_LOGIN_USED_KEY),Ct.delete(re.EMAIL),Ct.delete(re.LAST_USED_CHAIN_KEY),Ct.delete(re.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Ct.set(re.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Ct.get(re.LAST_USED_CHAIN_KEY)??void 0,r=Number(e);return isNaN(r)?e:r}persistSmartAccountEnabledNetworks(e){Ct.set(re.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}}class xs{constructor(){}static getInstance({projectId:e,chainId:r,enableLogger:n,onTimeout:s,abortController:i}){return xs.instance||(xs.instance=new t4({projectId:e,chainId:r,enableLogger:n,onTimeout:s,abortController:i})),xs.instance}}var Ny={};const r4={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof Ny<"u"?Ny.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},Mh={filterOutDuplicatesByRDNS(t){const e=F.state.enableEIP6963?ee.state.connectors:[],r=Z.getRecentWallets(),n=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=r.map(a=>a.rdns).filter(Boolean),i=n.concat(s);if(i.includes("io.metamask.mobile")&&ae.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!i.includes(String(a==null?void 0:a.rdns)))},filterOutDuplicatesByIds(t){const e=ee.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),r=Z.getRecentWallets(),n=e.map(a=>a.explorerId),s=r.map(a=>a.id),i=n.concat(s);return t.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=ee.state,r=e.filter(i=>i.type==="ANNOUNCED").reduce((i,o)=>{var a;return(a=o.info)!=null&&a.rdns&&(i[o.info.rdns]=!0),i},{});return t.map(i=>({...i,installed:!!i.rdns&&!!r[i.rdns??""]})).sort((i,o)=>Number(o.installed)-Number(i.installed))},getConnectOrderMethod(t,e){var c;const r=(t==null?void 0:t.connectMethodsOrder)||((c=F.state.features)==null?void 0:c.connectMethodsOrder),n=e||ee.state.connectors;if(r)return r;const{injected:s,announced:i}=Wc.getConnectorsByType(n,ue.state.recommended,ue.state.featured),o=s.filter(Wc.showConnector),a=i.filter(Wc.showConnector);return o.length||a.length?["wallet","email","social"]:r4.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&ue.state.excludedWallets.some(n=>n.rdns===t.rdns),r=!!t.name&&ue.state.excludedWallets.some(n=>il.isLowerCaseMatch(n.name,t.name));return e||r}},Wc={getConnectorsByType(t,e,r){const{customWallets:n}=F.state,s=Z.getRecentWallets(),i=Mh.filterOutDuplicateWallets(e),o=Mh.filterOutDuplicateWallets(r),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),u=t.filter(d=>d.type==="INJECTED"),l=t.filter(d=>d.type==="EXTERNAL");return{custom:n,recent:s,external:l,multiChain:a,announced:c,injected:u,recommended:i,featured:o}},showConnector(t){var s;const e=(s=t.info)==null?void 0:s.rdns,r=!!e&&ue.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),n=!!t.name&&ue.state.excludedWallets.some(i=>il.isLowerCaseMatch(i.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!ae.isMobile()||ae.isMobile()&&!e&&!le.checkInstalled())||r||n)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(r||n))},getIsConnectedWithWC(){return Array.from(P.state.chains.values()).some(r=>ee.getConnectorId(r.namespace)===q.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:r,recent:n,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(u=>(u=F.state.features)==null?void 0:u.connectorTypeOrder)()??[]}){const l=Wc.getIsConnectedWithWC(),f=[{type:"walletConnect",isEnabled:F.state.enableWalletConnect&&!l},{type:"recent",isEnabled:n.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:r&&r.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(w=>w.isEnabled),p=new Set(f.map(w=>w.type)),g=c.filter(w=>p.has(w)).map(w=>({type:w,isEnabled:!0})),m=f.filter(({type:w})=>!g.some(({type:v})=>v===w));return Array.from(new Set([...g,...m].map(({type:w})=>w)))}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Vc=globalThis,kf=Vc.ShadowRoot&&(Vc.ShadyCSS===void 0||Vc.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Uf=Symbol(),Ty=new WeakMap;let Qv=class{constructor(e,r,n){if(this._$cssResult$=!0,n!==Uf)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=r}get styleSheet(){let e=this.o;const r=this.t;if(kf&&e===void 0){const n=r!==void 0&&r.length===1;n&&(e=Ty.get(r)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&Ty.set(r,e))}return e}toString(){return this.cssText}};const yr=t=>new Qv(typeof t=="string"?t:t+"",void 0,Uf),xi=(t,...e)=>{const r=t.length===1?t[0]:e.reduce((n,s,i)=>n+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new Qv(r,t,Uf)},n4=(t,e)=>{if(kf)t.adoptedStyleSheets=e.map(r=>r instanceof CSSStyleSheet?r:r.styleSheet);else for(const r of e){const n=document.createElement("style"),s=Vc.litNonce;s!==void 0&&n.setAttribute("nonce",s),n.textContent=r.cssText,t.appendChild(n)}},Py=kf?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let r="";for(const n of e.cssRules)r+=n.cssText;return yr(r)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:s4,defineProperty:i4,getOwnPropertyDescriptor:o4,getOwnPropertyNames:a4,getOwnPropertySymbols:c4,getPrototypeOf:u4}=Object,es=globalThis,xy=es.trustedTypes,l4=xy?xy.emptyScript:"",vd=es.reactiveElementPolyfillSupport,zo=(t,e)=>t,Bh={toAttribute(t,e){switch(e){case Boolean:t=t?l4:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let r=t;switch(e){case Boolean:r=t!==null;break;case Number:r=t===null?null:Number(t);break;case Object:case Array:try{r=JSON.parse(t)}catch{r=null}}return r}},eE=(t,e)=>!s4(t,e),Oy={attribute:!0,type:String,converter:Bh,reflect:!1,useDefault:!1,hasChanged:eE};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),es.litPropertyMetadata??(es.litPropertyMetadata=new WeakMap);let Ai=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,r=Oy){if(r.state&&(r.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((r=Object.create(r)).wrapped=!0),this.elementProperties.set(e,r),!r.noAccessor){const n=Symbol(),s=this.getPropertyDescriptor(e,n,r);s!==void 0&&i4(this.prototype,e,s)}}static getPropertyDescriptor(e,r,n){const{get:s,set:i}=o4(this.prototype,e)??{get(){return this[r]},set(o){this[r]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Oy}static _$Ei(){if(this.hasOwnProperty(zo("elementProperties")))return;const e=u4(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(zo("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(zo("properties"))){const r=this.properties,n=[...a4(r),...c4(r)];for(const s of n)this.createProperty(s,r[s])}const e=this[Symbol.metadata];if(e!==null){const r=litPropertyMetadata.get(e);if(r!==void 0)for(const[n,s]of r)this.elementProperties.set(n,s)}this._$Eh=new Map;for(const[r,n]of this.elementProperties){const s=this._$Eu(r,n);s!==void 0&&this._$Eh.set(s,r)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const r=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const s of n)r.unshift(Py(s))}else e!==void 0&&r.push(Py(e));return r}static _$Eu(e,r){const n=r.attribute;return n===!1?void 0:typeof n=="string"?n:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(r=>this.enableUpdating=r),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(r=>r(this))}addController(e){var r;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((r=e.hostConnected)==null||r.call(e))}removeController(e){var r;(r=this._$EO)==null||r.delete(e)}_$E_(){const e=new Map,r=this.constructor.elementProperties;for(const n of r.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return n4(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(r=>{var n;return(n=r.hostConnected)==null?void 0:n.call(r)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(r=>{var n;return(n=r.hostDisconnected)==null?void 0:n.call(r)})}attributeChangedCallback(e,r,n){this._$AK(e,n)}_$ET(e,r){var i;const n=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,n);if(s!==void 0&&n.reflect===!0){const o=(((i=n.converter)==null?void 0:i.toAttribute)!==void 0?n.converter:Bh).toAttribute(r,n.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,r){var i,o;const n=this.constructor,s=n._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=n.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:Bh;this._$Em=s,this[s]=c.fromAttribute(r,a.type)??((o=this._$Ej)==null?void 0:o.get(s))??null,this._$Em=null}}requestUpdate(e,r,n){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(n??(n=i.getPropertyOptions(e)),!((n.hasChanged??eE)(o,r)||n.useDefault&&n.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,n))))return;this.C(e,r,n)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,r,{useDefault:n,reflect:s,wrapped:i},o){n&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??r??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||n||(r=void 0),this._$AL.set(e,r)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(r){Promise.reject(r)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var n;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const r=this._$AL;try{e=this.shouldUpdate(r),e?(this.willUpdate(r),(n=this._$EO)==null||n.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(r)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(r)}willUpdate(e){}_$AE(e){var r;(r=this._$EO)==null||r.forEach(n=>{var s;return(s=n.hostUpdated)==null?void 0:s.call(n)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(r=>this._$ET(r,this[r]))),this._$EM()}updated(e){}firstUpdated(e){}};Ai.elementStyles=[],Ai.shadowRootOptions={mode:"open"},Ai[zo("elementProperties")]=new Map,Ai[zo("finalized")]=new Map,vd==null||vd({ReactiveElement:Ai}),(es.reactiveElementVersions??(es.reactiveElementVersions=[])).push("2.1.0");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ho=globalThis,Su=Ho.trustedTypes,Ry=Su?Su.createPolicy("lit-html",{createHTML:t=>t}):void 0,tE="$lit$",Vn=`lit$${Math.random().toFixed(9).slice(2)}$`,rE="?"+Vn,d4=`<${rE}>`,Vs=document,La=()=>Vs.createComment(""),Ma=t=>t===null||typeof t!="object"&&typeof t!="function",Lf=Array.isArray,h4=t=>Lf(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",Ed=`[ 	
\f\r]`,So=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,$y=/-->/g,Dy=/>/g,ps=RegExp(`>|${Ed}(?:([^\\s"'>=/]+)(${Ed}*=${Ed}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),ky=/'/g,Uy=/"/g,nE=/^(?:script|style|textarea|title)$/i,sE=t=>(e,...r)=>({_$litType$:t,strings:e,values:r}),kj=sE(1),Uj=sE(2),Ki=Symbol.for("lit-noChange"),mt=Symbol.for("lit-nothing"),Ly=new WeakMap,Ns=Vs.createTreeWalker(Vs,129);function iE(t,e){if(!Lf(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Ry!==void 0?Ry.createHTML(e):e}const f4=(t,e)=>{const r=t.length-1,n=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=So;for(let a=0;a<r;a++){const c=t[a];let u,l,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,l=o.exec(c),l!==null);)h=o.lastIndex,o===So?l[1]==="!--"?o=$y:l[1]!==void 0?o=Dy:l[2]!==void 0?(nE.test(l[2])&&(s=RegExp("</"+l[2],"g")),o=ps):l[3]!==void 0&&(o=ps):o===ps?l[0]===">"?(o=s??So,d=-1):l[1]===void 0?d=-2:(d=o.lastIndex-l[2].length,u=l[1],o=l[3]===void 0?ps:l[3]==='"'?Uy:ky):o===Uy||o===ky?o=ps:o===$y||o===Dy?o=So:(o=ps,s=void 0);const f=o===ps&&t[a+1].startsWith("/>")?" ":"";i+=o===So?c+d4:d>=0?(n.push(u),c.slice(0,d)+tE+c.slice(d)+Vn+f):c+Vn+(d===-2?a:f)}return[iE(t,i+(t[r]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),n]};class Ba{constructor({strings:e,_$litType$:r},n){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[u,l]=f4(e,r);if(this.el=Ba.createElement(u,n),Ns.currentNode=this.el.content,r===2||r===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Ns.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(tE)){const h=l[o++],f=s.getAttribute(d).split(Vn),p=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:p[2],strings:f,ctor:p[1]==="."?g4:p[1]==="?"?m4:p[1]==="@"?y4:al}),s.removeAttribute(d)}else d.startsWith(Vn)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(nE.test(s.tagName)){const d=s.textContent.split(Vn),h=d.length-1;if(h>0){s.textContent=Su?Su.emptyScript:"";for(let f=0;f<h;f++)s.append(d[f],La()),Ns.nextNode(),c.push({type:2,index:++i});s.append(d[h],La())}}}else if(s.nodeType===8)if(s.data===rE)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Vn,d+1))!==-1;)c.push({type:7,index:i}),d+=Vn.length-1}i++}}static createElement(e,r){const n=Vs.createElement("template");return n.innerHTML=e,n}}function Gi(t,e,r=t,n){var o,a;if(e===Ki)return e;let s=n!==void 0?(o=r._$Co)==null?void 0:o[n]:r._$Cl;const i=Ma(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,r,n)),n!==void 0?(r._$Co??(r._$Co=[]))[n]=s:r._$Cl=s),s!==void 0&&(e=Gi(t,s._$AS(t,e.values),s,n)),e}class p4{constructor(e,r){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=r}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:r},parts:n}=this._$AD,s=((e==null?void 0:e.creationScope)??Vs).importNode(r,!0);Ns.currentNode=s;let i=Ns.nextNode(),o=0,a=0,c=n[0];for(;c!==void 0;){if(o===c.index){let u;c.type===2?u=new ac(i,i.nextSibling,this,e):c.type===1?u=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(u=new w4(i,this,e)),this._$AV.push(u),c=n[++a]}o!==(c==null?void 0:c.index)&&(i=Ns.nextNode(),o++)}return Ns.currentNode=Vs,s}p(e){let r=0;for(const n of this._$AV)n!==void 0&&(n.strings!==void 0?(n._$AI(e,n,r),r+=n.strings.length-2):n._$AI(e[r])),r++}}class ac{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,r,n,s){this.type=2,this._$AH=mt,this._$AN=void 0,this._$AA=e,this._$AB=r,this._$AM=n,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const r=this._$AM;return r!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=r.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,r=this){e=Gi(this,e,r),Ma(e)?e===mt||e==null||e===""?(this._$AH!==mt&&this._$AR(),this._$AH=mt):e!==this._$AH&&e!==Ki&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):h4(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==mt&&Ma(this._$AH)?this._$AA.nextSibling.data=e:this.T(Vs.createTextNode(e)),this._$AH=e}$(e){var i;const{values:r,_$litType$:n}=e,s=typeof n=="number"?this._$AC(e):(n.el===void 0&&(n.el=Ba.createElement(iE(n.h,n.h[0]),this.options)),n);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(r);else{const o=new p4(s,this),a=o.u(this.options);o.p(r),this.T(a),this._$AH=o}}_$AC(e){let r=Ly.get(e.strings);return r===void 0&&Ly.set(e.strings,r=new Ba(e)),r}k(e){Lf(this._$AH)||(this._$AH=[],this._$AR());const r=this._$AH;let n,s=0;for(const i of e)s===r.length?r.push(n=new ac(this.O(La()),this.O(La()),this,this.options)):n=r[s],n._$AI(i),s++;s<r.length&&(this._$AR(n&&n._$AB.nextSibling,s),r.length=s)}_$AR(e=this._$AA.nextSibling,r){var n;for((n=this._$AP)==null?void 0:n.call(this,!1,!0,r);e&&e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var r;this._$AM===void 0&&(this._$Cv=e,(r=this._$AP)==null||r.call(this,e))}}class al{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,r,n,s,i){this.type=1,this._$AH=mt,this._$AN=void 0,this.element=e,this.name=r,this._$AM=s,this.options=i,n.length>2||n[0]!==""||n[1]!==""?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=mt}_$AI(e,r=this,n,s){const i=this.strings;let o=!1;if(i===void 0)e=Gi(this,e,r,0),o=!Ma(e)||e!==this._$AH&&e!==Ki,o&&(this._$AH=e);else{const a=e;let c,u;for(e=i[0],c=0;c<i.length-1;c++)u=Gi(this,a[n+c],r,c),u===Ki&&(u=this._$AH[c]),o||(o=!Ma(u)||u!==this._$AH[c]),u===mt?e=mt:e!==mt&&(e+=(u??"")+i[c+1]),this._$AH[c]=u}o&&!s&&this.j(e)}j(e){e===mt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class g4 extends al{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===mt?void 0:e}}class m4 extends al{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==mt)}}class y4 extends al{constructor(e,r,n,s,i){super(e,r,n,s,i),this.type=5}_$AI(e,r=this){if((e=Gi(this,e,r,0)??mt)===Ki)return;const n=this._$AH,s=e===mt&&n!==mt||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,i=e!==mt&&(n===mt||s);s&&this.element.removeEventListener(this.name,this,n),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var r;typeof this._$AH=="function"?this._$AH.call(((r=this.options)==null?void 0:r.host)??this.element,e):this._$AH.handleEvent(e)}}class w4{constructor(e,r,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=r,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){Gi(this,e)}}const _d=Ho.litHtmlPolyfillSupport;_d==null||_d(Ba,ac),(Ho.litHtmlVersions??(Ho.litHtmlVersions=[])).push("3.3.0");const b4=(t,e,r)=>{const n=(r==null?void 0:r.renderBefore)??e;let s=n._$litPart$;if(s===void 0){const i=(r==null?void 0:r.renderBefore)??null;n._$litPart$=s=new ac(e.insertBefore(La(),i),i,void 0,r??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Os=globalThis;class Kc extends Ai{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var r;const e=super.createRenderRoot();return(r=this.renderOptions).renderBefore??(r.renderBefore=e.firstChild),e}update(e){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=b4(r,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return Ki}}var Jy;Kc._$litElement$=!0,Kc.finalized=!0,(Jy=Os.litElementHydrateSupport)==null||Jy.call(Os,{LitElement:Kc});const Cd=Os.litElementPolyfillSupport;Cd==null||Cd({LitElement:Kc});(Os.litElementVersions??(Os.litElementVersions=[])).push("4.2.0");let Wo,ts,rs;function Lj(t,e){Wo=document.createElement("style"),ts=document.createElement("style"),rs=document.createElement("style"),Wo.textContent=Oi(t).core.cssText,ts.textContent=Oi(t).dark.cssText,rs.textContent=Oi(t).light.cssText,document.head.appendChild(Wo),document.head.appendChild(ts),document.head.appendChild(rs),oE(e)}function oE(t){ts&&rs&&(t==="light"?(ts.removeAttribute("media"),rs.media="enabled"):(rs.removeAttribute("media"),ts.media="enabled"))}function v4(t){Wo&&ts&&rs&&(Wo.textContent=Oi(t).core.cssText,ts.textContent=Oi(t).dark.cssText,rs.textContent=Oi(t).light.cssText)}function Oi(t){return{core:xi`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${yr(t!=null&&t["--w3m-color-mix-strength"]?`${t["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${yr((t==null?void 0:t["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${yr((t==null?void 0:t["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${yr((t==null?void 0:t["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${yr((t==null?void 0:t["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:xi`
      :root {
        --w3m-color-mix: ${yr((t==null?void 0:t["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${yr(An(t,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${yr(An(t,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:xi`
      :root {
        --w3m-color-mix: ${yr((t==null?void 0:t["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${yr(An(t,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${yr(An(t,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const Mj=xi`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,Bj=xi`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,Fj=xi`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,Do={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]},My=mL({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function cc(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const By=cc({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),Fy=cc({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});cc({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});cc({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});cc({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const E4={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Vo={getMethodsByChainNamespace(t){return E4[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const r={...t},n=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>n.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>n.add(s)),e.events&&Object.keys(e.events).forEach(s=>n.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&n.add(i)}),n.forEach(s=>{r[s]||(r[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{r[s]&&(r[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{r[s]&&(r[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{r[s]&&(r[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!r[a]||(r[a].rpcMap||(r[a].rpcMap={}),s.has(a)||(r[a].rpcMap={},s.add(a)),r[a].rpcMap[c]=o)})}return r},createNamespaces(t,e){const r=t.reduce((n,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];n[o]||(n[o]=this.createDefaultNamespace(o));const u=`${o}:${i}`,l=n[o];switch(l.chains.push(u),u){case By.caipNetworkId:l.chains.push(By.deprecatedCaipNetworkId);break;case Fy.caipNetworkId:l.chains.push(Fy.deprecatedCaipNetworkId);break}return l!=null&&l.rpcMap&&c&&(l.rpcMap[i]=c),n},{});return this.applyNamespaceOverrides(r,e)},resolveReownName:async t=>{var n;const e=await qo.resolveName(t);return((n=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:n.address)||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const r=e.chains||[],n=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...r,...n]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isOriginAllowed(t,e,r){for(const n of[...e,...r])if(n.includes("*")){const i=`^${n.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else if(n===t)return!0;return!1}};class Mf{constructor({provider:e,namespace:r}){this.id=q.CONNECTOR_ID.WALLET_CONNECT,this.name=Yn.ConnectorNamesMap[q.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Yn.ConnectorImageIds[q.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=P.getCaipNetworks.bind(P),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=r}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const r=this.getCaipNetworks(),n=F.state.universalProviderConfigOverride,s=Vo.createNamespaces(r,n);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(r=>r.caipNetworkId);return Fo.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:_4})}}const _4=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class aE{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,this.getCaipNetworks=r=>P.getCaipNetworks(r),e&&this.construct(e)}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.getCaipNetworks(this.namespace)}setAuthProvider(e){this.addConnector({id:q.CONNECTOR_ID.AUTH,type:"AUTH",name:q.CONNECTOR_NAMES.AUTH,provider:e,imageId:Yn.ConnectorImageIds[q.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const r=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(n=>r.has(n.id)?!1:(r.add(n.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,r){ne.setStatus(e,r)}on(e,r){var n;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(n=this.eventListeners.get(e))==null||n.add(r)}off(e,r){const n=this.eventListeners.get(e);n&&n.delete(r)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,r){const n=this.eventListeners.get(e);n&&n.forEach(s=>s(r))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){var i;const{caipNetwork:r,providerType:n}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(n==="WALLET_CONNECT"){s.setDefaultChain(r.caipNetworkId);return}if(s&&n==="AUTH"){const o=s,a=(i=ne.state.preferredAccountTypes)==null?void 0:i[r.chainNamespace];await o.switchNetwork(r.caipNetworkId);const c=await o.getUser({chainId:r.caipNetworkId,preferredAccountType:a});this.emit("switchNetwork",c)}}getWalletConnectConnector(){const e=this.connectors.find(r=>r instanceof Mf);if(!e)throw new Error("WalletConnectConnector not found");return e}}class C4 extends aE{setUniversalProvider(e){this.addConnector(new Mf({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){var s,i,o,a;const r=this.provider,n=((a=(o=(i=(s=r==null?void 0:r.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,u]=c.split(":");return u}).filter((c,u,l)=>l.indexOf(c)===u))||[];return Promise.resolve({accounts:n.map(c=>ae.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,u;if(!(e.caipNetwork&&st.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(ne.state.balanceLoading&&e.chainId===((c=P.state.activeCaipNetwork)==null?void 0:c.id))return{balance:ne.state.balance||"0.00",symbol:ne.state.balanceSymbol||""};const s=(await ne.fetchTokenBalance()).find(l=>{var d,h;return l.chainId===`${(d=e.caipNetwork)==null?void 0:d.chainNamespace}:${e.chainId}`&&l.symbol===((h=e.caipNetwork)==null?void 0:h.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((u=e.caipNetwork)==null?void 0:u.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:r,message:n,address:s}=e;if(!r)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=P.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===q.CHAIN.SOLANA?i=(await r.request({method:"solana_signMessage",params:{message:mb.encode(new TextEncoder().encode(n)),pubkey:s}},(a=P.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await r.request({method:"personal_sign",params:[n,s]},(c=P.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,u;const{caipNetwork:r}=e,n=this.getWalletConnectConnector();if(r.chainNamespace===q.CHAIN.EVM)try{await((s=n.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:ji(r.id)}]}))}catch(l){if(l.code===Do.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||l.code===Do.ERROR_INVALID_CHAIN_ID||l.code===Do.ERROR_CODE_DEFAULT||((o=(i=l==null?void 0:l.data)==null?void 0:i.originalError)==null?void 0:o.code)===Do.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((u=n.provider)==null?void 0:u.request({method:"wallet_addEthereumChain",params:[{chainId:ji(r.id),rpcUrls:[(a=r==null?void 0:r.rpcUrls.chainDefault)==null?void 0:a.http],chainName:r.name,nativeCurrency:r.nativeCurrency,blockExplorerUrls:[(c=r.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}n.provider.setDefaultChain(r.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(n=>n.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}class A4{constructor(e){this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=(r,n)=>{var s,i,o,a;if(r){const c=(i=(s=P.getNetworkData(r))==null?void 0:s.requestedCaipNetworks)==null?void 0:i.find(d=>d.id===n);if(c)return c;const u=(o=P.getNetworkData(r))==null?void 0:o.caipNetwork;return u||((a=P.getRequestedCaipNetworks(r).filter(d=>d.chainNamespace===r))==null?void 0:a[0])}return P.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const r=this.getCaipNetwork();if(r)return r.id},this.getCaipNetworks=r=>P.getCaipNetworks(r),this.getActiveChainNamespace=()=>P.state.activeChain,this.setRequestedCaipNetworks=(r,n)=>{P.setRequestedCaipNetworks(r,n)},this.getApprovedCaipNetworkIds=()=>P.getAllApprovedCaipNetworkIds(),this.getCaipAddress=r=>P.state.activeChain===r||!r?P.state.activeCaipAddress:P.getAccountProp("caipAddress",r),this.setClientId=r=>{he.setClientId(r)},this.getProvider=r=>Le.getProvider(r),this.getProviderType=r=>Le.getProviderId(r),this.getPreferredAccountType=r=>{var n;return(n=ne.state.preferredAccountTypes)==null?void 0:n[r]},this.setCaipAddress=(r,n)=>{ne.setCaipAddress(r,n)},this.setBalance=(r,n,s)=>{ne.setBalance(r,n,s)},this.setProfileName=(r,n)=>{ne.setProfileName(r,n)},this.setProfileImage=(r,n)=>{ne.setProfileImage(r,n)},this.setUser=(r,n)=>{ne.setUser(r,n),F.state.enableEmbedded&&tt.close()},this.resetAccount=r=>{ne.resetAccount(r)},this.setCaipNetwork=r=>{P.setActiveCaipNetwork(r)},this.setCaipNetworkOfNamespace=(r,n)=>{P.setChainNetworkData(n,{caipNetwork:r})},this.setAllAccounts=(r,n)=>{ne.setAllAccounts(r,n),F.setHasMultipleAddresses((r==null?void 0:r.length)>1)},this.setStatus=(r,n)=>{ne.setStatus(r,n),ee.isConnected()?Z.setConnectionStatus("connected"):Z.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=r=>P.getAccountProp("address",r),this.setConnectors=r=>{const n=[...ee.state.allConnectors,...r];ee.setConnectors(n)},this.setConnections=(r,n)=>{le.setConnections(r,n)},this.fetchIdentity=r=>he.fetchIdentity(r),this.getReownName=r=>qo.getNamesForAddress(r),this.getConnectors=()=>ee.getConnectors(),this.getConnectorImage=r=>ew.getConnectorImage(r),this.setConnectedWalletInfo=(r,n)=>{const s=Le.getProviderId(n),i=r?{...r,type:s}:void 0;ne.setConnectedWalletInfo(i,n)},this.getIsConnectedState=()=>!!P.state.activeCaipAddress,this.addAddressLabel=(r,n,s)=>{ne.addAddressLabel(r,n,s)},this.removeAddressLabel=(r,n)=>{ne.removeAddressLabel(r,n)},this.getAddress=r=>P.state.activeChain===r||!r?ne.state.address:P.getAccountProp("address",r),this.setApprovedCaipNetworksData=r=>P.setApprovedCaipNetworksData(r),this.resetNetwork=r=>{P.resetNetwork(r)},this.addConnector=r=>{ee.addConnector(r)},this.resetWcConnection=()=>{le.resetWcConnection()},this.setAddressExplorerUrl=(r,n)=>{ne.setAddressExplorerUrl(r,n)},this.setSmartAccountDeployed=(r,n)=>{ne.setSmartAccountDeployed(r,n)},this.setSmartAccountEnabledNetworks=(r,n)=>{P.setSmartAccountEnabledNetworks(r,n)},this.setPreferredAccountType=(r,n)=>{ne.setPreferredAccountType(r,n)},this.setEIP6963Enabled=r=>{F.setEIP6963Enabled(r)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e)}getChainNamespacesSet(e,r){const n=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(n!=null&&n.length)return[...new Set(n)];const s=r==null?void 0:r.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var r,n,s;this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),this.sendInitializeEvent(e),rn.set({initialized:!0}),await this.syncExistingConnection(),((r=F.state.features)!=null&&r.email||Array.isArray((n=F.state.features)==null?void 0:n.socials)&&((s=F.state.features)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){const e=await ue.fetchAllowedOrigins();if(e&&ae.isClient()){const r=window.location.origin;Vo.isOriginAllowed(r,e,Do.DEFAULT_ALLOWED_ANCESTORS)||Lt.open(pt.ALERT_ERRORS.INVALID_APP_CONFIGURATION,"error")}else Lt.open(pt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}sendInitializeEvent(e){var n;const{...r}=e;delete r.adapters,delete r.universalProvider,Ge.sendEvent({type:"track",event:"INITIALIZE",properties:{...r,networks:e.networks.map(s=>s.id),siweConfig:{options:((n=e.siweConfig)==null?void 0:n.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&Gt.setThemeMode(e.themeMode),e.themeVariables&&Gt.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");P.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const r=this.getDefaultNetwork();r&&P.setActiveCaipNetwork(r)}initializeConnectionController(e){le.setWcBasic(e.basic??!1)}initializeConnectorController(){ee.initialize(this.chainNamespaces)}initializeOptionsController(e){var o;F.setDebug(e.debug!==!1),F.setEnableWalletConnect(e.enableWalletConnect!==!1),F.setEnableWalletGuide(e.enableWalletGuide!==!1),F.setEnableWallets(e.enableWallets!==!1),F.setEIP6963Enabled(e.enableEIP6963!==!1),F.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),F.setEnableAuthLogger(e.enableAuthLogger!==!1),F.setCustomRpcUrls(e.customRpcUrls),F.setSdkVersion(e.sdkVersion),F.setProjectId(e.projectId),F.setEnableEmbedded(e.enableEmbedded),F.setAllWallets(e.allWallets),F.setIncludeWalletIds(e.includeWalletIds),F.setExcludeWalletIds(e.excludeWalletIds),F.setFeaturedWalletIds(e.featuredWalletIds),F.setTokens(e.tokens),F.setTermsConditionsUrl(e.termsConditionsUrl),F.setPrivacyPolicyUrl(e.privacyPolicyUrl),F.setCustomWallets(e.customWallets),F.setFeatures(e.features),F.setAllowUnsupportedChain(e.allowUnsupportedChain),F.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),F.setPreferUniversalLinks(e.experimental_preferUniversalLinks),F.setDefaultAccountTypes(e.defaultAccountTypes);const r=Z.getPreferredAccountTypes()||{},n={...F.state.defaultAccountTypes,...r};ne.setPreferredAccountTypes(n);const s=this.getDefaultMetaData();if(!e.metadata&&s&&(e.metadata=s),F.setMetadata(e.metadata),F.setDisableAppend(e.disableAppend),F.setEnableEmbedded(e.enableEmbedded),F.setSIWX(e.siwx),!e.projectId){Lt.open(pt.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((o=e.adapters)==null?void 0:o.find(a=>a.namespace===q.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");F.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,r,n,s;return typeof window<"u"&&typeof document<"u"?{name:((r=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:r.textContent)||"",description:((n=document.querySelector('meta[property="og:description"]'))==null?void 0:n.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const r=this.getActiveChainNamespace();if(r){const n=en.getUnsupportedNetwork(`${r}:${e}`);P.setActiveCaipNetwork(n)}}getDefaultNetwork(){return en.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,r){return en.extendCaipNetwork(e,{customNetworkImageUrls:r.chainImages,projectId:r.projectId})}extendCaipNetworks(e){return en.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const r=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return r?en.extendCaipNetwork(r,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var i;const e=P.state.activeChain,r=this.getAdapter(e),n=(i=this.getCaipNetwork(e))==null?void 0:i.id;if(!r)throw new Error("Adapter not found");const s=await r.connectWalletConnect(n);this.close(),this.setClientId((s==null?void 0:s.clientId)||null),Z.setConnectedNamespaces([...P.state.chains.keys()]),this.chainNamespaces.forEach(o=>{ee.setConnectorId(Ke.CONNECTOR_TYPE_WALLET_CONNECT,o)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:r,type:n,provider:s,chain:i,caipNetwork:o,socialUri:a})=>{var g,m,w,b,v,A;const c=P.state.activeChain,u=i||c,l=this.getAdapter(u);if(i&&i!==c&&!o){const E=this.getCaipNetworks().find(y=>y.chainNamespace===i);E&&this.setCaipNetwork(E)}if(!l)throw new Error("Adapter not found");const d=this.getCaipNetwork(u),h=await l.connect({id:e,info:r,type:n,provider:s,socialUri:a,chainId:(o==null?void 0:o.id)||(d==null?void 0:d.id),rpcUrl:((w=(m=(g=o==null?void 0:o.rpcUrls)==null?void 0:g.default)==null?void 0:m.http)==null?void 0:w[0])||((A=(v=(b=d==null?void 0:d.rpcUrls)==null?void 0:b.default)==null?void 0:v.http)==null?void 0:A[0])});if(!h)return;Z.addConnectedNamespace(u),this.syncProvider({...h,chainNamespace:u});const f=ne.state.allAccounts,{accounts:p}=(f==null?void 0:f.length)>0?{accounts:[...f]}:await l.getAccounts({namespace:u,id:e});this.setAllAccounts(p,u),this.setStatus("connected",u),this.syncConnectedWalletInfo(u)},reconnectExternal:async({id:e,info:r,type:n,provider:s})=>{var a;const i=P.state.activeChain,o=this.getAdapter(i);o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:r,type:n,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),Z.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{const r=e||P.state.activeChain,n=this.getAdapter(r),s=Le.getProvider(r),i=Le.getProviderId(r);await(n==null?void 0:n.disconnect({provider:s,providerType:i})),Z.removeConnectedNamespace(r),Le.resetChain(r),this.setUser(void 0,r),this.setStatus("disconnected",r),this.setConnectedWalletInfo(void 0,r)},checkInstalled:e=>e?e.some(r=>{var n;return!!((n=window.ethereum)!=null&&n[String(r)])}):!!window.ethereum,signMessage:async e=>{const r=this.getAdapter(P.state.activeChain),n=await(r==null?void 0:r.signMessage({message:e,address:ne.state.address,provider:Le.getProvider(P.state.activeChain)}));return(n==null?void 0:n.signature)||""},sendTransaction:async e=>{const r=e.chainNamespace;if(st.SEND_SUPPORTED_NAMESPACES.includes(r)){const n=this.getAdapter(P.state.activeChain),s=Le.getProvider(r),i=await(n==null?void 0:n.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{if(e.chainNamespace===q.CHAIN.EVM){const r=this.getAdapter(P.state.activeChain),n=Le.getProvider(P.state.activeChain),s=this.getCaipNetwork();if(!s)throw new Error("CaipNetwork is undefined");const i=await(r==null?void 0:r.estimateGas({...e,provider:n,caipNetwork:s}));return(i==null?void 0:i.gas)||0n}return 0n},getEnsAvatar:async()=>{var e;return await this.syncIdentity({address:ne.state.address,chainId:Number((e=this.getCaipNetwork())==null?void 0:e.id),chainNamespace:P.state.activeChain}),ne.state.profileImage||!1},getEnsAddress:async e=>await Vo.resolveReownName(e),writeContract:async e=>{const r=this.getAdapter(P.state.activeChain),n=this.getCaipNetwork(),s=this.getCaipAddress(),i=Le.getProvider(P.state.activeChain);if(!n||!s)throw new Error("CaipNetwork or CaipAddress is undefined");const o=await(r==null?void 0:r.writeContract({...e,caipNetwork:n,provider:i,caipAddress:s}));return o==null?void 0:o.hash},parseUnits:(e,r)=>{const n=this.getAdapter(P.state.activeChain);return(n==null?void 0:n.parseUnits({value:e,decimals:r}))??0n},formatUnits:(e,r)=>{const n=this.getAdapter(P.state.activeChain);return(n==null?void 0:n.formatUnits({value:e,decimals:r}))??"0"},getCapabilities:async e=>{const r=this.getAdapter(P.state.activeChain);return await(r==null?void 0:r.getCapabilities(e))},grantPermissions:async e=>{const r=this.getAdapter(P.state.activeChain);return await(r==null?void 0:r.grantPermissions(e))},revokePermissions:async e=>{const r=this.getAdapter(P.state.activeChain);return r!=null&&r.revokePermissions?await r.revokePermissions(e):"0x"},walletGetAssets:async e=>{const r=this.getAdapter(P.state.activeChain);return await(r==null?void 0:r.walletGetAssets(e))??{}},updateBalance:e=>{const r=this.getCaipNetwork(e);!r||!ne.state.address||this.updateNativeBalance(ne.state.address,r==null?void 0:r.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},le.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var r,n,s,i,o;if(Le.getProviderId(P.state.activeChain)===Ke.CONNECTOR_TYPE_WALLET_CONNECT){const a=(n=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:n.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const r=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=Le.getProvider(r),i=Le.getProviderId(r);if(e.chainNamespace===P.state.activeChain){const o=this.getAdapter(r);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===Ke.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(r);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:r})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(r=>{const n=r.chains||[],s=r.accounts.map(i=>{const{chainId:o,chainNamespace:a}=Rn.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...n,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((r,n)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===n);return s?(s.construct({namespace:n,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),r[n]=s):r[n]=new C4({namespace:n,networks:this.getCaipNetworks()}),r},{})}async initChainAdapter(e){var r;this.onConnectors(e),this.listenAdapter(e),(r=this.chainAdapters)==null||r[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const r=this.getAdapter(e);r==null||r.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const r=this.getAdapter(e);if(!r)return;const n=Z.getConnectionStatus();n==="connected"?this.setStatus("connecting",e):n==="disconnected"?(Z.clearAddressCache(),this.setStatus(n,e)):this.setStatus(n,e),r.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(u=>u.id===i||u.caipNetworkId===i),a=P.state.activeChain===e,c=P.getAccountProp("address",e);if(o){const u=a&&s?s:c;u&&this.syncAccount({address:u,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),r.on("disconnect",this.disconnect.bind(this,e)),r.on("connections",s=>{this.setConnections(s,e)}),r.on("pendingTransactions",()=>{const s=ne.state.address,i=P.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),r.on("accountChanged",({address:s,chainId:i})=>{var a,c;const o=P.state.activeChain===e;o&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):o&&((a=P.state.activeCaipNetwork)!=null&&a.id)?this.syncAccount({address:s,chainId:(c=P.state.activeCaipNetwork)==null?void 0:c.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),this.syncAllAccounts(e)})}async createUniversalProviderForAdapter(e){var r,n,s;await this.getUniversalProvider(),this.universalProvider&&((s=(n=(r=this.chainAdapters)==null?void 0:r[e])==null?void 0:n.setUniversalProvider)==null||s.call(n,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{const r=ee.getConnectorId(e);switch(this.setStatus("connecting",e),r){case q.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case q.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(r){console.warn("AppKit couldn't sync existing connection",r),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){var o,a,c;const r=this.getAdapter(e),n=ee.getConnectorId(e),s=this.getCaipNetwork(e),i=ee.getConnectors(e).find(u=>u.id===n);try{if(!r||!i)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const u=await(r==null?void 0:r.syncConnection({namespace:e,id:i.id,chainId:s.id,rpcUrl:(c=(a=(o=s==null?void 0:s.rpcUrls)==null?void 0:o.default)==null?void 0:a.http)==null?void 0:c[0]}));if(u){const l=await(r==null?void 0:r.getAccounts({namespace:e,id:i.id}));l&&l.accounts.length>0?this.setAllAccounts(l.accounts,e):this.setAllAccounts([ae.createAccount(e,u.address,"eoa")],e),this.syncProvider({...u,chainNamespace:e}),await this.syncAccount({...u,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch{this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){const e=this.chainNamespaces.map(async r=>{var a,c,u,l,d;const n=this.getAdapter(r),s=((l=(u=(c=(a=this.universalProvider)==null?void 0:a.session)==null?void 0:c.namespaces)==null?void 0:u[r])==null?void 0:l.accounts)||[],i=(d=P.state.activeCaipNetwork)==null?void 0:d.id,o=s.find(h=>{const{chainId:f}=Rn.parseCaipAddress(h);return f===(i==null?void 0:i.toString())})||s[0];if(o){const h=Rn.validateCaipAddress(o),{chainId:f,address:p}=Rn.parseCaipAddress(h);if(Le.setProviderId(r,Ke.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&P.state.activeCaipNetwork&&(n==null?void 0:n.namespace)!==q.CHAIN.EVM){const g=n==null?void 0:n.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:P.state.activeCaipNetwork});Le.setProvider(r,g)}else Le.setProvider(r,this.universalProvider);ee.setConnectorId(q.CONNECTOR_ID.WALLET_CONNECT,r),Z.addConnectedNamespace(r),this.syncWalletConnectAccounts(r),await this.syncAccount({address:p,chainId:f,chainNamespace:r})}else this.setStatus("disconnected",r);this.syncConnectedWalletInfo(r),await P.setApprovedCaipNetworksData(r)});await Promise.all(e)}syncWalletConnectAccounts(e){var n,s,i,o,a;const r=(a=(o=(i=(s=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const{address:u}=Rn.parseCaipAddress(c);return u}).filter((c,u,l)=>l.indexOf(c)===u);r&&this.setAllAccounts(r.map(c=>ae.createAccount(e,c,e==="bip122"?"payment":"eoa")),e)}syncProvider({type:e,provider:r,id:n,chainNamespace:s}){Le.setProviderId(s,e),Le.setProvider(s,r),ee.setConnectorId(n,s)}async syncAllAccounts(e){const r=ee.getConnectorId(e);if(!r)return;const n=this.getAdapter(e),s=await(n==null?void 0:n.getAccounts({namespace:e,id:r}));s&&s.accounts.length>0&&this.setAllAccounts(s.accounts,e)}async syncAccount(e){var d,h;const r=e.chainNamespace===P.state.activeChain,n=P.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=Z.getActiveNetworkProps(),c=i||a,u=((d=P.state.activeCaipNetwork)==null?void 0:d.name)===q.UNSUPPORTED_NETWORK_NAME,l=P.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(u&&!l)&&c){let f=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),p=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!l&&!f&&!p){const m=this.getApprovedCaipNetworkIds()||[],w=m.find(v=>{var A;return((A=Rn.parseCaipNetworkId(v))==null?void 0:A.chainId)===c.toString()}),b=m.find(v=>{var A;return((A=Rn.parseCaipNetworkId(v))==null?void 0:A.chainNamespace)===o});f=this.getCaipNetworks().find(v=>v.caipNetworkId===w),p=this.getCaipNetworks().find(v=>v.caipNetworkId===b||"deprecatedCaipNetworkId"in v&&v.deprecatedCaipNetworkId===b)}const g=f||p;(g==null?void 0:g.chainNamespace)===P.state.activeChain?F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&((h=P.state.activeCaipNetwork)==null?void 0:h.name)===q.UNSUPPORTED_NETWORK_NAME?P.showUnsupportedChainUI():this.setCaipNetwork(g):r||n&&this.setCaipNetworkOfNamespace(n,o),this.syncConnectedWalletInfo(o),il.isLowerCaseMatch(s,ne.state.address)||this.syncAccountInfo(s,g==null?void 0:g.id,o),r?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:n==null?void 0:n.id,chainNamespace:o})}}async syncAccountInfo(e,r,n){const s=this.getCaipAddress(n),i=r||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${n}:${i}:${e}`;this.setCaipAddress(o,n),await this.syncIdentity({address:e,chainId:i,chainNamespace:n})}async syncReownName(e,r){try{const n=await this.getReownName(e);if(n[0]){const s=n[0];this.setProfileName(s.name,r)}else this.setProfileName(null,r)}catch{this.setProfileName(null,r)}}syncConnectedWalletInfo(e){var s;const r=ee.getConnectorId(e),n=Le.getProviderId(e);if(n===Ke.CONNECTOR_TYPE_ANNOUNCED||n===Ke.CONNECTOR_TYPE_INJECTED){if(r){const i=this.getConnectors().find(o=>o.id===r);if(i){const{info:o,name:a,imageUrl:c}=i,u=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:u,...o},e)}}}else if(n===Ke.CONNECTOR_TYPE_WALLET_CONNECT){const i=Le.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(r&&r===q.CONNECTOR_ID.COINBASE){const i=this.getConnectors().find(o=>o.id===q.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(i)},e)}}async syncBalance(e){!Go.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(n=>{var s;return n.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,r,n){const s=this.getAdapter(n),i=P.getCaipNetworkByNamespace(n,r);if(s){const o=await s.getBalance({address:e,chainId:r,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,n),o}}async initializeUniversalAdapter(){var n,s,i,o,a,c,u,l,d,h;const e=$L.createLogger((f,...p)=>{f&&this.handleAlertError(f),console.error(...p)}),r={projectId:(n=this.options)==null?void 0:n.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(u=this.options)==null?void 0:u.metadata.url:"",icons:(l=this.options)!=null&&l.metadata?(d=this.options)==null?void 0:d.metadata.icons:[""]},logger:e};F.setManualWCControl(!!((h=this.options)!=null&&h.manualWCControl)),this.universalProvider=this.options.universalProvider??await _U.init(r),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{le.setUri(e)}),this.universalProvider.on("connect",le.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),le.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{const r=this.getCaipNetworks().find(s=>s.id==e),n=this.getCaipNetwork();if(!r){this.setUnsupportedNetwork(e);return}(n==null?void 0:n.id)!==(r==null?void 0:r.id)&&this.setCaipNetwork(r)}),this.universalProvider.on("session_event",e=>{if(Vo.isSessionEventData(e)){const{name:r,data:n}=e.params.event;r==="accountsChanged"&&Array.isArray(n)&&ae.isCaipAddress(n[0])&&this.syncAccount(Rn.parseCaipAddress(n[0]))}}))}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&ae.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Ge.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const r=Object.entries(pt.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[n,s]=r??[],{message:i,alertErrorKey:o}=s??{};if(n&&i&&!this.reportedAlertErrors[n]){const a=pt.ALERT_ERRORS[o];a&&(Lt.open(a,"error"),this.reportedAlertErrors[n]=!0)}}getAdapter(e){var r;if(e)return(r=this.chainAdapters)==null?void 0:r[e]}createAdapter(e){var s;if(!e)return;const r=e.namespace;if(!r)return;this.createClients();const n=e;n.namespace=r,n.construct({namespace:r,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(r)||this.chainNamespaces.push(r),this.chainAdapters&&(this.chainAdapters[r]=n)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&le.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return tt.open({...e,data:{swap:e.arguments}})}return tt.open(e)}async close(e=!1){await this.injectModalUi(),tt.close(e)}setLoading(e,r){tt.setLoading(e,r)}async disconnect(e){await le.disconnect(e)}getSIWX(){return F.state.siwx}getError(){return""}getChainId(){var e;return(e=P.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const r=this.getCaipNetworks().find(n=>n.id===e.id);if(!r){Lt.open(pt.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await P.switchActiveNetwork(r)}getWalletProvider(){return P.state.activeChain?Le.state.providers[P.state.activeChain]:null}getWalletProviderType(){return Le.getProviderId(P.state.activeChain)}subscribeProviders(e){return Le.subscribeProviders(e)}getThemeMode(){return Gt.state.themeMode}getThemeVariables(){return Gt.state.themeVariables}setThemeMode(e){Gt.setThemeMode(e),oE(Gt.state.themeMode)}setTermsConditionsUrl(e){F.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){F.setPrivacyPolicyUrl(e)}setThemeVariables(e){Gt.setThemeVariables(e),v4(Gt.state.themeVariables)}subscribeTheme(e){return Gt.subscribe(e)}getWalletInfo(){return ne.state.connectedWalletInfo}getAccount(e){var o;const r=ee.getAuthConnector(e),n=P.getAccountData(e),s=P.state.activeChain,i=Z.getConnectedConnectorId(e);if(n)return{allAccounts:n.allAccounts,caipAddress:n.caipAddress,address:ae.getPlainAddress(n.caipAddress),isConnected:!!n.caipAddress,status:n.status,embeddedWalletInfo:r&&i===q.CONNECTOR_ID.AUTH?{user:n.user?{...n.user,username:Z.getConnectedSocialUsername()}:void 0,authProvider:n.socialProvider||"email",accountType:(o=n.preferredAccountTypes)==null?void 0:o[e||s],isSmartAccountDeployed:!!n.smartAccountDeployed}:void 0}}subscribeAccount(e,r){const n=()=>{const s=this.getAccount(r);s&&e(s)};r?P.subscribeChainProp("accountState",n,r):P.subscribe(n),ee.subscribe(n)}subscribeNetwork(e){return P.subscribe(({activeCaipNetwork:r})=>{e({caipNetwork:r,chainId:r==null?void 0:r.id,caipNetworkId:r==null?void 0:r.caipNetworkId})})}subscribeWalletInfo(e){return ne.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){ne.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){P.subscribeKey("activeCaipNetwork",e)}getState(){return rn.state}subscribeState(e){return rn.subscribe(e)}showErrorMessage(e){kr.showError(e)}showSuccessMessage(e){kr.showSuccess(e)}getEvent(){return{...Ge.state}}subscribeEvents(e){return Ge.subscribe(e)}replace(e){Ae.replace(e)}redirect(e){Ae.push(e)}popTransactionStack(e){Ae.popTransactionStack(e)}isOpen(){return tt.state.open}isTransactionStackEmpty(){return Ae.state.transactionStack.length===0}isTransactionShouldReplaceView(){var e;return(e=Ae.state.transactionStack[Ae.state.transactionStack.length-1])==null?void 0:e.replace}static getInstance(){return this.instance}updateFeatures(e){F.setFeatures(e)}updateOptions(e){const n={...F.state||{},...e};F.setOptions(n)}setConnectMethodsOrder(e){F.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){F.setWalletFeaturesOrder(e)}setCollapseWallets(e){F.setCollapseWallets(e)}setSocialsOrder(e){F.setSocialsOrder(e)}getConnectMethodsOrder(){return Mh.getConnectOrderMethod(F.state.features,ee.getConnectors())}addNetwork(e,r){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const n=this.extendCaipNetwork(r,this.options);this.getCaipNetworks().find(s=>s.id===n.id)||P.addNetwork(n)}removeNetwork(e,r){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===r)&&P.removeNetwork(e,r)}}let jy=!1;class I4 extends A4{setupAuthConnectorListeners(e){e.onRpcRequest(r=>{ar.checkIfRequestExists(r)?ar.checkIfRequestIsSafe(r)||this.handleUnsafeRPCRequest():(this.open(),console.error(It.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:r.method}),setTimeout(()=>{this.showErrorMessage(It.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close(!0):this.popTransactionStack(!0))}),e.onRpcSuccess((r,n)=>{const s=ar.checkIfRequestIsSafe(n),i=ne.state.address,o=P.state.activeCaipNetwork;s||(this.isTransactionStackEmpty()?(this.close(!0),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)):(this.popTransactionStack(),i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace)))}),e.onNotConnected(()=>{const r=P.state.activeChain;ee.getConnectorId(r)===q.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,r),this.setLoading(!1,r))}),e.onConnect(r=>{var u,l;const n=P.state.activeChain,s=n===q.CHAIN.EVM?`eip155:${r.chainId}:${r.address}`:`${r.chainId}:${r.address}`,i=F.state.defaultAccountTypes[n],o=(u=ne.state.preferredAccountTypes)==null?void 0:u[n],a=r.preferredAccountType||o||i;il.isLowerCaseMatch(r.address,ne.state.address)||this.syncIdentity({address:r.address,chainId:r.chainId,chainNamespace:n}),this.setCaipAddress(s,n),this.setUser({...ne.state.user||{},...r},n),this.setSmartAccountDeployed(!!r.smartAccountDeployed,n),this.setPreferredAccountType(a,n);const c=(l=r.accounts)==null?void 0:l.map(d=>ae.createAccount(n,d.address,d.type||o||i));this.setAllAccounts(c||[ae.createAccount(n,r.address,r.preferredAccountType||a)],n),this.setLoading(!1,n)}),e.onSocialConnected(({userName:r})=>{this.setUser({...ne.state.user||{},username:r},P.state.activeChain)}),e.onGetSmartAccountEnabledNetworks(r=>{this.setSmartAccountEnabledNetworks(r,P.state.activeChain)}),e.onSetPreferredAccount(({address:r,type:n})=>{r&&this.setPreferredAccountType(n,P.state.activeChain)})}async syncAuthConnector(e,r){var l,d,h,f;const n=q.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!n)return;this.setLoading(!0,r);const s=e.getLoginEmailUsed();this.setLoading(s,r),s&&this.setStatus("connecting",r);const i=e.getEmail(),o=e.getUsername();this.setUser({...((l=ne.state)==null?void 0:l.user)||{},username:o,email:i},P.state.activeChain),this.setupAuthConnectorListeners(e);const{isConnected:a}=await e.isConnected(),c=Gt.getSnapshot(),u=F.getSnapshot();await Promise.all([e.syncDappData({metadata:u.metadata,sdkVersion:u.sdkVersion,projectId:u.projectId,sdkType:u.sdkType}),e.syncTheme({themeMode:c.themeMode,themeVariables:c.themeVariables,w3mThemeVariables:An(c.themeVariables,c.themeMode)})]),await e.getSmartAccountEnabledNetworks(),r&&n&&(a&&((d=this.connectionControllerClient)!=null&&d.connectExternal)?(await((f=this.connectionControllerClient)==null?void 0:f.connectExternal({id:q.CONNECTOR_ID.AUTH,info:{name:q.CONNECTOR_ID.AUTH},type:Ke.CONNECTOR_TYPE_AUTH,provider:e,chainId:(h=P.state.activeCaipNetwork)==null?void 0:h.id,chain:r})),this.setStatus("connected",r)):ee.getConnectorId(r)===q.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",r),Z.removeConnectedNamespace(r))),this.setLoading(!1,r)}async checkExistingTelegramSocialConnection(e){var r;try{if(!ae.isTelegram())return;const n=Z.getTelegramSocialProvider();if(!n||typeof window>"u"||typeof document>"u")return;const i=new URL(window.location.href).searchParams.get("result_uri");if(!i)return;ne.setSocialProvider(n,e),await((r=this.authProvider)==null?void 0:r.init());const o=ee.getAuthConnector();n&&o&&(this.setLoading(!0,e),await le.connectExternal({id:o.id,type:o.type,socialUri:i},o.chain),Z.setConnectedSocialProvider(n),Z.removeTelegramSocialProvider(),Ge.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){var o,a,c,u,l,d,h,f,p,g,m,w,b;if(!q.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const n=((a=(o=this.options)==null?void 0:o.features)==null?void 0:a.email)===void 0?st.DEFAULT_FEATURES.email:(u=(c=this.options)==null?void 0:c.features)==null?void 0:u.email,s=(d=(l=this.options)==null?void 0:l.features)!=null&&d.socials?((p=(f=(h=this.options)==null?void 0:h.features)==null?void 0:f.socials)==null?void 0:p.length)>0:((m=(g=this.options)==null?void 0:g.features)==null?void 0:m.socials)??st.DEFAULT_FEATURES.socials,i=n||s;!this.authProvider&&((w=this.options)!=null&&w.projectId)&&i&&(this.authProvider=xs.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(b=this.getCaipNetwork(e))==null?void 0:b.caipNetworkId,abortController:pt.EmbeddedWalletAbortController,onTimeout:v=>{v==="iframe_load_failed"?Lt.open(pt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):v==="iframe_request_timeout"?Lt.open(pt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):v==="unverified_domain"&&Lt.open(pt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")}}),rn.subscribeOpen(v=>{var A;!v&&this.isTransactionStackEmpty()&&((A=this.authProvider)==null||A.rejectRpcRequests())}),this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var r,n,s;this.createAuthProvider(e),this.authProvider&&((s=(n=(r=this.chainAdapters)==null?void 0:r[e])==null?void 0:n.setAuthProvider)==null||s.call(n,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&ue.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var i,o;if(!e)return;const r=P.state.activeChain,n=e.chainNamespace,s=this.getAddressByChainNamespace(e.chainNamespace);if(e.chainNamespace===P.state.activeChain&&s){const a=this.getAdapter(n),c=Le.getProvider(n),u=Le.getProviderId(n);await(a==null?void 0:a.switchNetwork({caipNetwork:e,provider:c,providerType:u})),this.setCaipNetwork(e)}else{const c=Le.getProviderId(r)===Ke.CONNECTOR_TYPE_AUTH,u=Le.getProviderId(n),l=u===Ke.CONNECTOR_TYPE_AUTH,d=q.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n);if((c&&u===void 0||l)&&d)try{P.state.activeChain=e.chainNamespace,await((o=(i=this.connectionControllerClient)==null?void 0:i.connectExternal)==null?void 0:o.call(i,{id:q.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:n,chainId:e.id,type:Ke.CONNECTOR_TYPE_AUTH,caipNetwork:e})),this.setCaipNetwork(e)}catch{const f=this.getAdapter(n);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:u}))}else u===Ke.CONNECTOR_TYPE_WALLET_CONNECT?(this.setCaipNetwork(e),this.syncWalletConnectAccount()):(this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:n}))}}async initChainAdapter(e){await super.initChainAdapter(e),this.createAuthProviderForAdapter(e)}async syncIdentity({address:e,chainId:r,chainNamespace:n}){var o;const s=`${n}:${r}`,i=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===s);if(n!==q.CHAIN.EVM||i!=null&&i.testnet){this.setProfileName(null,n),this.setProfileImage(null,n);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});this.setProfileName(a,n),this.setProfileImage(c,n)}catch{await this.syncReownName(e,n),r!==1&&this.setProfileImage(null,n)}}syncConnectedWalletInfo(e){const r=Le.getProviderId(e);if(r===Ke.CONNECTOR_TYPE_AUTH){const n=this.authProvider;if(n){const s=Z.getConnectedSocialProvider()??"email",i=n.getEmail()??n.getUsername();this.setConnectedWalletInfo({name:r,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(!jy&&ae.isClient()){const e={...st.DEFAULT_FEATURES,...this.options.features},r=[];if(e&&((e.email||e.socials&&e.socials.length)&&r.push(Ut(()=>import("./CBqsacSD.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url)),e.email&&r.push(Ut(()=>import("./Du_0FKG0.js"),__vite__mapDeps([13,1,2,12,6,11,5,10,14,7]),import.meta.url)),e.socials&&r.push(Ut(()=>import("./sD-u_8bC.js"),__vite__mapDeps([15,1,2,16,5,17,18,11,19,10,6,12,20,4,21]),import.meta.url)),e.swaps&&r.push(Ut(()=>import("./B_mkjXUy.js"),__vite__mapDeps([22,1,2,10,6,23,24,25,4,11,21,7,5]),import.meta.url)),e.send&&r.push(Ut(()=>import("./Culcn6LT.js"),__vite__mapDeps([26,1,2,10,6,11,5,17,12,25,4,7,27,28]),import.meta.url)),e.receive&&r.push(Ut(()=>import("./X9RbzwjQ.js"),__vite__mapDeps([29,1,2,30,4,20]),import.meta.url)),e.onramp&&r.push(Ut(()=>import("./DxJtWbVs.js"),__vite__mapDeps([31,1,2,32,21,11,4,6,33,16,5,17,34,12,10,19,7]),import.meta.url)),e.history&&r.push(Ut(()=>import("./CEuyMYzZ.js"),__vite__mapDeps([35,1,2,36,32,21,11,12,4]),import.meta.url)),e.pay&&r.push(Ut(()=>import("./Bk-bOJzk.js"),__vite__mapDeps([37,1,2,10,6,38,4,11,8,33,28,19]),import.meta.url))),await Promise.all([...r,Ut(()=>import("./DsFCxamD.js"),__vite__mapDeps([39,1,2,4,6,27,11,40,24,8,33,10,9,38,36,32,21,12,23,5,7,28,14,16,17,18,3,19,30,20,34]),import.meta.url),Ut(()=>import("./DnwKvXWW.js"),__vite__mapDeps([41,1,2,8,4,11,9,6,24,40]),import.meta.url)]),!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!F.state.disableAppend&&!F.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}jy=!0}}}const S4="1.7.6";function N4(t){return new I4({...t,sdkVersion:ae.generateSdkVersion(t.adapters??[],"html",S4)})}function _r(t,e,r){const n=t[e.name];if(typeof n=="function")return n;const s=t[r];return typeof s=="function"?s:i=>e(t,i)}const Gc="2.17.2",T4=()=>`@wagmi/core@${Gc}`;var cE=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Nu,uE;class jr extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return T4()}constructor(e,r={}){var i;super(),Nu.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const n=r.cause instanceof jr?r.cause.details:(i=r.cause)!=null&&i.message?r.cause.message:r.details,s=r.cause instanceof jr&&r.cause.docsPath||r.docsPath;this.message=[e||"An error occurred.","",...r.metaMessages?[...r.metaMessages,""]:[],...s?[`Docs: ${this.docsBaseUrl}${s}.html${r.docsSlug?`#${r.docsSlug}`:""}`]:[],...n?[`Details: ${n}`]:[],`Version: ${this.version}`].join(`
`),r.cause&&(this.cause=r.cause),this.details=n,this.docsPath=s,this.metaMessages=r.metaMessages,this.shortMessage=e}walk(e){return cE(this,Nu,"m",uE).call(this,this,e)}}Nu=new WeakSet,uE=function t(e,r){return r!=null&&r(e)?e:e.cause?cE(this,Nu,"m",t).call(this,e.cause,r):e};class Fa extends jr{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class P4 extends jr{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class x4 extends jr{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class O4 extends jr{constructor({address:e,connector:r}){super(`Account "${e}" not found for connector "${r.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class R4 extends jr{constructor({connectionChainId:e,connectorChainId:r}){super(`The current chain of the connector (id: ${r}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${r}`,`Expected Chain ID: ${e}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class $4 extends jr{constructor({connector:e}){super(`Connector "${e.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function qy(t,e){var n;let r;if(typeof e.connector=="function"?r=t._internal.connectors.setup(e.connector):r=e.connector,r.uid===t.state.current)throw new P4;try{t.setState(c=>({...c,status:"connecting"})),r.emitter.emit("message",{type:"connecting"});const{connector:s,...i}=e,o=await r.connect(i),a=o.accounts;return r.emitter.off("connect",t._internal.events.connect),r.emitter.on("change",t._internal.events.change),r.emitter.on("disconnect",t._internal.events.disconnect),await((n=t.storage)==null?void 0:n.setItem("recentConnectorId",r.id)),t.setState(c=>({...c,connections:new Map(c.connections).set(r.uid,{accounts:a,chainId:o.chainId,connector:r}),current:r.uid,status:"connected"})),{accounts:a,chainId:o.chainId}}catch(s){throw t.setState(i=>({...i,status:i.current?"connected":"disconnected"})),s}}async function cl(t,e={}){let r;if(e.connector){const{connector:u}=e;if(t.state.status==="reconnecting"&&!u.getAccounts&&!u.getChainId)throw new $4({connector:u});const[l,d]=await Promise.all([u.getAccounts().catch(h=>{if(e.account===null)return[];throw h}),u.getChainId()]);r={accounts:l,chainId:d,connector:u}}else r=t.state.connections.get(t.state.current);if(!r)throw new x4;const n=e.chainId??r.chainId,s=await r.connector.getChainId();if(s!==r.chainId)throw new R4({connectionChainId:r.chainId,connectorChainId:s});const i=r.connector;if(i.getClient)return i.getClient({chainId:n});const o=ln(e.account??r.accounts[0]);if(o&&(o.address=As(o.address)),e.account&&!r.accounts.some(u=>u.toLowerCase()===o.address.toLowerCase()))throw new O4({address:o.address,connector:i});const a=t.chains.find(u=>u.id===n),c=await r.connector.getProvider({chainId:n});return jv({account:o,chain:a,name:"Connector Client",transport:u=>uL(c)({...u,retryCount:0})})}async function D4(t,e={}){var s,i;let r;if(e.connector)r=e.connector;else{const{connections:o,current:a}=t.state,c=o.get(a);r=c==null?void 0:c.connector}const n=t.state.connections;r&&(await r.disconnect(),r.emitter.off("change",t._internal.events.change),r.emitter.off("disconnect",t._internal.events.disconnect),r.emitter.on("connect",t._internal.events.connect),n.delete(r.uid)),t.setState(o=>{if(n.size===0)return{...o,connections:new Map,current:null,status:"disconnected"};const a=n.values().next().value;return{...o,connections:new Map(n),current:a.connector.uid}});{const o=t.state.current;if(!o)return;const a=(s=t.state.connections.get(o))==null?void 0:s.connector;if(!a)return;await((i=t.storage)==null?void 0:i.setItem("recentConnectorId",a.id))}}async function k4(t,e){const{chainId:r,connector:n,...s}=e;let i;e.account?i=e.account:i=(await cl(t,{account:e.account,chainId:r,connector:n})).account;const o=t.getClient({chainId:r});return _r(o,Nv,"estimateGas")({...s,account:i})}function lE(t){return typeof t=="number"?t:t==="wei"?0:Math.abs(R8[t])}function Tu(t){const e=t.state.current,r=t.state.connections.get(e),n=r==null?void 0:r.accounts,s=n==null?void 0:n[0],i=t.chains.find(a=>a.id===(r==null?void 0:r.chainId)),o=t.state.status;switch(o){case"connected":return{address:s,addresses:n,chain:i,chainId:r==null?void 0:r.chainId,connector:r==null?void 0:r.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:o};case"reconnecting":return{address:s,addresses:n,chain:i,chainId:r==null?void 0:r.chainId,connector:r==null?void 0:r.connector,isConnected:!!s,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:o};case"connecting":return{address:s,addresses:n,chain:i,chainId:r==null?void 0:r.chainId,connector:r==null?void 0:r.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:o};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:o}}}async function U4(t,e){const{allowFailure:r=!0,chainId:n,contracts:s,...i}=e,o=t.getClient({chainId:n});return _r(o,bL,"multicall")({allowFailure:r,contracts:s,...i})}function L4(t,e){const{chainId:r,...n}=e,s=t.getClient({chainId:r});return _r(s,Lv,"readContract")(n)}async function M4(t,e){var a;const{allowFailure:r=!0,blockNumber:n,blockTag:s,...i}=e,o=e.contracts;try{const c={};for(const[h,f]of o.entries()){const p=f.chainId??t.state.chainId;c[p]||(c[p]=[]),(a=c[p])==null||a.push({contract:f,index:h})}const u=()=>Object.entries(c).map(([h,f])=>U4(t,{...i,allowFailure:r,blockNumber:n,blockTag:s,chainId:Number.parseInt(h),contracts:f.map(({contract:p})=>p)})),l=(await Promise.all(u())).flat(),d=Object.values(c).flatMap(h=>h.map(({index:f})=>f));return l.reduce((h,f,p)=>(h&&(h[d[p]]=f),h),[])}catch(c){if(c instanceof dv)throw c;const u=()=>o.map(l=>L4(t,{...l,blockNumber:n,blockTag:s}));return r?(await Promise.allSettled(u())).map(l=>l.status==="fulfilled"?{result:l.value,status:"success"}:{error:l.reason,result:void 0,status:"failure"}):await Promise.all(u())}}async function B4(t,e){const{address:r,blockNumber:n,blockTag:s,chainId:i,token:o,unit:a="ether"}=e;if(o)try{return await zy(t,{balanceAddress:r,chainId:i,symbolType:"string",tokenAddress:o})}catch(h){if(h.name==="ContractFunctionExecutionError"){const f=await zy(t,{balanceAddress:r,chainId:i,symbolType:"bytes32",tokenAddress:o}),p=X0(nc(f.symbol,{dir:"right"}));return{...f,symbol:p}}throw h}const c=t.getClient({chainId:i}),l=await _r(c,Sv,"getBalance")(n?{address:r,blockNumber:n}:{address:r,blockTag:s}),d=t.chains.find(h=>h.id===i)??c.chain;return{decimals:d.nativeCurrency.decimals,formatted:oo(l,lE(a)),symbol:d.nativeCurrency.symbol,value:l}}async function zy(t,e){const{balanceAddress:r,chainId:n,symbolType:s,tokenAddress:i,unit:o}=e,a={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:s}]}],address:i},[c,u,l]=await M4(t,{allowFailure:!1,contracts:[{...a,functionName:"balanceOf",args:[r],chainId:n},{...a,functionName:"decimals",chainId:n},{...a,functionName:"symbol",chainId:n}]}),d=oo(c??"0",lE(o??u));return{decimals:u,formatted:d,symbol:l,value:c}}function Pu(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let r,n;if(Array.isArray(t)&&Array.isArray(e)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!Pu(t[n],e[n]))return!1;return!0}if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const s=Object.keys(t);if(r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(i&&!Pu(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}let $c=[];function gs(t){const e=[...t.state.connections.values()];return t.state.status==="reconnecting"||Pu($c,e)?$c:($c=e,e)}async function F4(t,e){const{account:r,chainId:n,...s}=e,i=r??Tu(t).address,o=t.getClient({chainId:n});return _r(o,Of,"prepareTransactionRequest")({...s,...i?{account:i}:{}})}let Ad=!1;async function Hy(t,e={}){var u,l;if(Ad)return[];Ad=!0,t.setState(d=>({...d,status:d.current?"reconnecting":"connecting"}));const r=[];if((u=e.connectors)!=null&&u.length)for(const d of e.connectors){let h;typeof d=="function"?h=t._internal.connectors.setup(d):h=d,r.push(h)}else r.push(...t.connectors);let n;try{n=await((l=t.storage)==null?void 0:l.getItem("recentConnectorId"))}catch{}const s={};for(const[,d]of t.state.connections)s[d.connector.id]=1;n&&(s[n]=0);const i=Object.keys(s).length>0?[...r].sort((d,h)=>(s[d.id]??10)-(s[h.id]??10)):r;let o=!1;const a=[],c=[];for(const d of i){const h=await d.getProvider().catch(()=>{});if(!h||c.some(g=>g===h)||!await d.isAuthorized())continue;const p=await d.connect({isReconnecting:!0}).catch(()=>null);p&&(d.emitter.off("connect",t._internal.events.connect),d.emitter.on("change",t._internal.events.change),d.emitter.on("disconnect",t._internal.events.disconnect),t.setState(g=>{const m=new Map(o?g.connections:new Map).set(d.uid,{accounts:p.accounts,chainId:p.chainId,connector:d});return{...g,current:o?g.current:d.uid,connections:m}}),a.push({accounts:p.accounts,chainId:p.chainId,connector:d}),c.push(h),o=!0)}return(t.state.status==="reconnecting"||t.state.status==="connecting")&&(o?t.setState(d=>({...d,status:"connected"})):t.setState(d=>({...d,connections:new Map,current:null,status:"disconnected"}))),Ad=!1,a}async function j4(t,e){const{account:r,chainId:n,connector:s,...i}=e;let o;return typeof r=="object"&&(r==null?void 0:r.type)==="local"?o=t.getClient({chainId:n}):o=await cl(t,{account:r??void 0,chainId:n,connector:s}),await _r(o,Bv,"sendTransaction")({...i,...r?{account:r}:{},chain:n?{id:n}:null,gas:i.gas??void 0})}async function q4(t,e){const{account:r,connector:n,...s}=e;let i;return typeof r=="object"&&r.type==="local"?i=t.getClient():i=await cl(t,{account:r,connector:n}),_r(i,CL,"signMessage")({...s,...r?{account:r}:{}})}class zn extends jr{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class z4 extends jr{constructor({connector:e}){super(`"${e.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}async function Wy(t,e){var o;const{addEthereumChainParameter:r,chainId:n}=e,s=t.state.connections.get(((o=e.connector)==null?void 0:o.uid)??t.state.current);if(s){const a=s.connector;if(!a.switchChain)throw new z4({connector:a});return await a.switchChain({addEthereumChainParameter:r,chainId:n})}const i=t.chains.find(a=>a.id===n);if(!i)throw new Fa;return t.setState(a=>({...a,chainId:n})),i}function H4(t,e){const{onChange:r}=e;return t.subscribe(()=>Tu(t),r,{equalityFn(n,s){const{connector:i,...o}=n,{connector:a,...c}=s;return Pu(o,c)&&(i==null?void 0:i.id)===(a==null?void 0:a.id)&&(i==null?void 0:i.uid)===(a==null?void 0:a.uid)}})}function W4(t,e){const{onChange:r}=e;return t._internal.connectors.subscribe((n,s)=>{r(Object.values(n),s)})}function V4(t,e){const{syncConnectedChain:r=t._internal.syncConnectedChain,...n}=e;let s;const i=c=>{s&&s();const u=t.getClient({chainId:c});return s=_r(u,_L,"watchPendingTransactions")(n),s},o=i(e.chainId);let a;return r&&!e.chainId&&(a=t.subscribe(({chainId:c})=>c,async c=>i(c))),()=>{o==null||o(),a==null||a()}}async function K4(t,e){const{chainId:r,timeout:n=0,...s}=e,i=t.getClient({chainId:r}),a=await _r(i,EL,"waitForTransactionReceipt")({...s,timeout:n});if(a.status==="reverted"){const u=await _r(i,zv,"getTransaction")({hash:a.transactionHash}),d=await _r(i,Uv,"call")({...u,data:u.input,gasPrice:u.type!=="eip1559"?u.gasPrice:void 0,maxFeePerGas:u.type==="eip1559"?u.maxFeePerGas:void 0,maxPriorityFeePerGas:u.type==="eip1559"?u.maxPriorityFeePerGas:void 0}),h=d!=null&&d.data?X0(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(h)}return{...a,chainId:i.chain.id}}async function G4(t,e){const{account:r,chainId:n,connector:s,...i}=e;let o;return typeof r=="object"&&(r==null?void 0:r.type)==="local"?o=t.getClient({chainId:n}):o=await cl(t,{account:r??void 0,chainId:n,connector:s}),await _r(o,nL,"writeContract")({...i,...r?{account:r}:{},chain:n?{id:n}:null})}function jj(t){return t}ul.type="injected";function ul(t={}){const{shimDisconnect:e=!0,unstable_shimAsyncInject:r}=t;function n(){const c=t.target;if(typeof c=="function"){const u=c();if(u)return u}return typeof c=="object"?c:typeof c=="string"?{...Y4[c]??{id:c,name:`${c[0].toUpperCase()}${c.slice(1)}`,provider:`is${c[0].toUpperCase()}${c.slice(1)}`}}:{id:"injected",name:"Injected",provider(u){return u==null?void 0:u.ethereum}}}let s,i,o,a;return c=>({get icon(){return n().icon},get id(){return n().id},get name(){return n().name},get supportsSimulation(){return!0},type:ul.type,async setup(){const u=await this.getProvider();u!=null&&u.on&&t.target&&(o||(o=this.onConnect.bind(this),u.on("connect",o)),s||(s=this.onAccountsChanged.bind(this),u.on("accountsChanged",s)))},async connect({chainId:u,isReconnecting:l}={}){var f,p,g,m,w,b;const d=await this.getProvider();if(!d)throw new zn;let h=[];if(l)h=await this.getAccounts().catch(()=>[]);else if(e)try{h=(m=(g=(p=(f=(await d.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}))[0])==null?void 0:f.caveats)==null?void 0:p[0])==null?void 0:g.value)==null?void 0:m.map(A=>As(A)),h.length>0&&(h=await this.getAccounts())}catch(v){const A=v;if(A.code===at.code)throw new at(A);if(A.code===Qn.code)throw A}try{!(h!=null&&h.length)&&!l&&(h=(await d.request({method:"eth_requestAccounts"})).map(E=>As(E))),o&&(d.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),d.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),d.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),d.on("disconnect",a));let v=await this.getChainId();if(u&&v!==u){const A=await this.switchChain({chainId:u}).catch(E=>{if(E.code===at.code)throw E;return{id:v}});v=(A==null?void 0:A.id)??v}return e&&await((w=c.storage)==null?void 0:w.removeItem(`${this.id}.disconnected`)),t.target||await((b=c.storage)==null?void 0:b.setItem("injected.connected",!0)),{accounts:h,chainId:v}}catch(v){const A=v;throw A.code===at.code?new at(A):A.code===Qn.code?new Qn(A):A}},async disconnect(){var l,d;const u=await this.getProvider();if(!u)throw new zn;i&&(u.removeListener("chainChanged",i),i=void 0),a&&(u.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),u.on("connect",o));try{await qv(()=>u.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),{timeout:100})}catch{}e&&await((l=c.storage)==null?void 0:l.setItem(`${this.id}.disconnected`,!0)),t.target||await((d=c.storage)==null?void 0:d.removeItem("injected.connected"))},async getAccounts(){const u=await this.getProvider();if(!u)throw new zn;return(await u.request({method:"eth_accounts"})).map(d=>As(d))},async getChainId(){const u=await this.getProvider();if(!u)throw new zn;const l=await u.request({method:"eth_chainId"});return Number(l)},async getProvider(){if(typeof window>"u")return;let u;const l=n();return typeof l.provider=="function"?u=l.provider(window):typeof l.provider=="string"?u=Yc(window,l.provider):u=l.provider,u&&!u.removeListener&&("off"in u&&typeof u.off=="function"?u.removeListener=u.off:u.removeListener=()=>{}),u},async isAuthorized(){var u,l;try{if(e&&await((u=c.storage)==null?void 0:u.getItem(`${this.id}.disconnected`))||!t.target&&!await((l=c.storage)==null?void 0:l.getItem("injected.connected")))return!1;if(!await this.getProvider()){if(r!==void 0&&r!==!1){const p=async()=>(typeof window<"u"&&window.removeEventListener("ethereum#initialized",p),!!await this.getProvider()),g=typeof r=="number"?r:1e3;if(await Promise.race([...typeof window<"u"?[new Promise(w=>window.addEventListener("ethereum#initialized",()=>w(p()),{once:!0}))]:[],new Promise(w=>setTimeout(()=>w(p()),g))]))return!0}throw new zn}return!!(await gu(()=>this.getAccounts())).length}catch{return!1}},async switchChain({addEthereumChainParameter:u,chainId:l}){var p,g,m,w;const d=await this.getProvider();if(!d)throw new zn;const h=c.chains.find(b=>b.id===l);if(!h)throw new an(new Fa);const f=new Promise(b=>{const v=A=>{"chainId"in A&&A.chainId===l&&(c.emitter.off("change",v),b())};c.emitter.on("change",v)});try{return await Promise.all([d.request({method:"wallet_switchEthereumChain",params:[{chainId:Ee(l)}]}).then(async()=>{await this.getChainId()===l&&c.emitter.emit("change",{chainId:l})}),f]),h}catch(b){const v=b;if(v.code===4902||((g=(p=v==null?void 0:v.data)==null?void 0:p.originalError)==null?void 0:g.code)===4902)try{const{default:A,...E}=h.blockExplorers??{};let y;u!=null&&u.blockExplorerUrls?y=u.blockExplorerUrls:A&&(y=[A.url,...Object.values(E).map(S=>S.url)]);let _;(m=u==null?void 0:u.rpcUrls)!=null&&m.length?_=u.rpcUrls:_=[((w=h.rpcUrls.default)==null?void 0:w.http[0])??""];const T={blockExplorerUrls:y,chainId:Ee(l),chainName:(u==null?void 0:u.chainName)??h.name,iconUrls:u==null?void 0:u.iconUrls,nativeCurrency:(u==null?void 0:u.nativeCurrency)??h.nativeCurrency,rpcUrls:_};return await Promise.all([d.request({method:"wallet_addEthereumChain",params:[T]}).then(async()=>{if(await this.getChainId()===l)c.emitter.emit("change",{chainId:l});else throw new at(new Error("User rejected switch after adding network."))}),f]),h}catch(A){throw new at(A)}throw v.code===at.code?new at(v):new an(v)}},async onAccountsChanged(u){var l;if(u.length===0)this.onDisconnect();else if(c.emitter.listenerCount("connect")){const d=(await this.getChainId()).toString();this.onConnect({chainId:d}),e&&await((l=c.storage)==null?void 0:l.removeItem(`${this.id}.disconnected`))}else c.emitter.emit("change",{accounts:u.map(d=>As(d))})},onChainChanged(u){const l=Number(u);c.emitter.emit("change",{chainId:l})},async onConnect(u){const l=await this.getAccounts();if(l.length===0)return;const d=Number(u.chainId);c.emitter.emit("connect",{accounts:l,chainId:d});const h=await this.getProvider();h&&(o&&(h.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),h.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),h.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),h.on("disconnect",a)))},async onDisconnect(u){const l=await this.getProvider();u&&u.code===1013&&l&&(await this.getAccounts()).length||(c.emitter.emit("disconnect"),l&&(i&&(l.removeListener("chainChanged",i),i=void 0),a&&(l.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),l.on("connect",o))))}})}const Y4={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider(t){return t!=null&&t.coinbaseWalletExtension?t.coinbaseWalletExtension:Yc(t,"isCoinbaseWallet")}},metaMask:{id:"metaMask",name:"MetaMask",provider(t){return Yc(t,e=>{if(!e.isMetaMask||e.isBraveWallet&&!e._events&&!e._state)return!1;const r=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const n of r)if(e[n])return!1;return!0})}},phantom:{id:"phantom",name:"Phantom",provider(t){var e,r;return(e=t==null?void 0:t.phantom)!=null&&e.ethereum?(r=t.phantom)==null?void 0:r.ethereum:Yc(t,"isPhantom")}}};function Yc(t,e){function r(s){return typeof e=="function"?e(s):typeof e=="string"?s[e]:!0}const n=t.ethereum;if(n!=null&&n.providers)return n.providers.find(s=>r(s));if(n&&r(n))return n}function Z4(t){if(typeof window>"u")return;const e=r=>t(r.detail);return window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",e)}function J4(){const t=new Set;let e=[];const r=()=>Z4(s=>{e.some(({info:i})=>i.uuid===s.info.uuid)||(e=[...e,s],t.forEach(i=>i(e,{added:[s]})))});let n=r();return{_listeners(){return t},clear(){t.forEach(s=>s([],{removed:[...e]})),e=[]},destroy(){this.clear(),t.clear(),n==null||n()},findProvider({rdns:s}){return e.find(i=>i.info.rdns===s)},getProviders(){return e},reset(){this.clear(),n==null||n(),n=r()},subscribe(s,{emitImmediately:i}={}){return t.add(s),i&&s(e,{added:e}),()=>t.delete(s)}}}const X4=t=>(e,r,n)=>{const s=n.subscribe;return n.subscribe=(o,a,c)=>{let u=o;if(a){const l=(c==null?void 0:c.equalityFn)||Object.is;let d=o(n.getState());u=h=>{const f=o(h);if(!l(d,f)){const p=d;a(d=f,p)}},c!=null&&c.fireImmediately&&a(d,d)}return s(u)},t(e,r,n)},Q4=X4;function eF(t,e){let r;try{r=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=r.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>r.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>r.removeItem(s)}}const Fh=t=>e=>{try{const r=t(e);return r instanceof Promise?r:{then(n){return Fh(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Fh(n)(r)}}}},tF=(t,e)=>(r,n,s)=>{let i={storage:eF(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const a=new Set,c=new Set;let u=i.storage;if(!u)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),r(...g)},n,s);const l=()=>{const g=i.partialize({...n()});return u.setItem(i.name,{state:g,version:i.version})},d=s.setState;s.setState=(g,m)=>{d(g,m),l()};const h=t((...g)=>{r(...g),l()},n,s);s.getInitialState=()=>h;let f;const p=()=>{var g,m;if(!u)return;o=!1,a.forEach(b=>{var v;return b((v=n())!=null?v:h)});const w=((m=i.onRehydrateStorage)==null?void 0:m.call(i,(g=n())!=null?g:h))||void 0;return Fh(u.getItem.bind(u))(i.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==i.version){if(i.migrate)return[!0,i.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var v;const[A,E]=b;if(f=i.merge(E,(v=n())!=null?v:h),r(f,!0),A)return l()}).then(()=>{w==null||w(f,void 0),f=n(),o=!0,c.forEach(b=>b(f))}).catch(b=>{w==null||w(void 0,b)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(u=g.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(a.add(g),()=>{a.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||p(),f||h},rF=tF,Vy=t=>{let e;const r=new Set,n=(u,l)=>{const d=typeof u=="function"?u(e):u;if(!Object.is(d,e)){const h=e;e=l??(typeof d!="object"||d===null)?d:Object.assign({},e,d),r.forEach(f=>f(e,h))}},s=()=>e,a={setState:n,getState:s,getInitialState:()=>c,subscribe:u=>(r.add(u),()=>r.delete(u))},c=e=t(n,s,a);return a},Id=t=>t?Vy(t):Vy;var Sd={exports:{}},Ky;function nF(){return Ky||(Ky=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function i(c,u,l,d,h){if(typeof l!="function")throw new TypeError("The listener must be a function");var f=new s(l,d||c,h),p=r?r+u:u;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)e.call(l,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=r?r+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(u){var l=r?r+u:u,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,l,d,h,f,p){var g=r?r+u:u;if(!this._events[g])return!1;var m=this._events[g],w=arguments.length,b,v;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),w){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,d),!0;case 4:return m.fn.call(m.context,l,d,h),!0;case 5:return m.fn.call(m.context,l,d,h,f),!0;case 6:return m.fn.call(m.context,l,d,h,f,p),!0}for(v=1,b=new Array(w-1);v<w;v++)b[v-1]=arguments[v];m.fn.apply(m.context,b)}else{var A=m.length,E;for(v=0;v<A;v++)switch(m[v].once&&this.removeListener(u,m[v].fn,void 0,!0),w){case 1:m[v].fn.call(m[v].context);break;case 2:m[v].fn.call(m[v].context,l);break;case 3:m[v].fn.call(m[v].context,l,d);break;case 4:m[v].fn.call(m[v].context,l,d,h);break;default:if(!b)for(E=1,b=new Array(w-1);E<w;E++)b[E-1]=arguments[E];m[v].fn.apply(m[v].context,b)}}return!0},a.prototype.on=function(u,l,d){return i(this,u,l,d,!1)},a.prototype.once=function(u,l,d){return i(this,u,l,d,!0)},a.prototype.removeListener=function(u,l,d,h){var f=r?r+u:u;if(!this._events[f])return this;if(!l)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var g=0,m=[],w=p.length;g<w;g++)(p[g].fn!==l||h&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=r?r+u:u,this._events[l]&&o(this,l)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,t.exports=a}(Sd)),Sd.exports}var sF=nF();const iF=xu(sF);class oF{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new iF})}on(e,r){this._emitter.on(e,r)}once(e,r){this._emitter.once(e,r)}off(e,r){this._emitter.off(e,r)}emit(e,...r){const n=r[0];this._emitter.emit(e,{uid:this.uid,...n})}listenerCount(e){return this._emitter.listenerCount(e)}}function aF(t){return new oF(t)}function cF(t,e){return JSON.parse(t,(r,n)=>{let s=n;return(s==null?void 0:s.__type)==="bigint"&&(s=BigInt(s.value)),(s==null?void 0:s.__type)==="Map"&&(s=new Map(s.value)),(e==null?void 0:e(r,s))??s})}function Gy(t,e){return t.slice(0,e).join(".")||"."}function Yy(t,e){const{length:r}=t;for(let n=0;n<r;++n)if(t[n]===e)return n+1;return 0}function uF(t,e){const r=typeof t=="function",n=typeof e=="function",s=[],i=[];return function(a,c){if(typeof c=="object")if(s.length){const u=Yy(s,this);u===0?s[s.length]=this:(s.splice(u),i.splice(u)),i[i.length]=a;const l=Yy(s,c);if(l!==0)return n?e.call(this,a,c,Gy(i,l)):`[ref=${Gy(i,l)}]`}else s[0]=c,i[0]=a;return r?t.call(this,a,c):c}}function lF(t,e,r,n){return JSON.stringify(t,uF((s,i)=>{let o=i;return typeof o=="bigint"&&(o={__type:"bigint",value:i.toString()}),o instanceof Map&&(o={__type:"Map",value:Array.from(i.entries())}),(e==null?void 0:e(s,o))??o},n),r??void 0)}function dF(t){const{deserialize:e=cF,key:r="wagmi",serialize:n=lF,storage:s=dE}=t;function i(o){return o instanceof Promise?o.then(a=>a).catch(()=>null):o}return{...s,key:r,async getItem(o,a){const c=s.getItem(`${r}.${o}`),u=await i(c);return u?e(u)??null:a??null},async setItem(o,a){const c=`${r}.${o}`;a===null?await i(s.removeItem(c)):await i(s.setItem(c,n(a)))},async removeItem(o){await i(s.removeItem(`${r}.${o}`))}}}const dE={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function hF(){const t=typeof window<"u"&&window.localStorage?window.localStorage:dE;return{getItem(e){return t.getItem(e)},removeItem(e){t.removeItem(e)},setItem(e,r){try{t.setItem(e,r)}catch{}}}}const jh=256;let Dc=jh,kc;function fF(t=11){if(!kc||Dc+t>jh*2){kc="",Dc=0;for(let e=0;e<jh;e++)kc+=(256+Math.random()*256|0).toString(16).substring(1)}return kc.substring(Dc,Dc+++t)}function pF(t){const{multiInjectedProviderDiscovery:e=!0,storage:r=dF({storage:hF()}),syncConnectedChain:n=!0,ssr:s=!1,...i}=t,o=typeof window<"u"&&e?J4():void 0,a=Id(()=>i.chains),c=Id(()=>{const E=[],y=new Set;for(const _ of i.connectors??[]){const T=u(_);if(E.push(T),!s&&T.rdns){const S=typeof T.rdns=="string"?[T.rdns]:T.rdns;for(const x of S)y.add(x)}}if(!s&&o){const _=o.getProviders();for(const T of _)y.has(T.info.rdns)||E.push(u(l(T)))}return E});function u(E){var T;const y=aF(fF()),_={...E({emitter:y,chains:a.getState(),storage:r,transports:i.transports}),emitter:y,uid:y.uid};return y.on("connect",v),(T=_.setup)==null||T.call(_),_}function l(E){const{info:y}=E,_=E.provider;return ul({target:{...y,id:y.rdns,provider:_}})}const d=new Map;function h(E={}){const y=E.chainId??m.getState().chainId,_=a.getState().find(S=>S.id===y);if(E.chainId&&!_)throw new Fa;{const S=d.get(m.getState().chainId);if(S&&!_)return S;if(!_)throw new Fa}{const S=d.get(y);if(S)return S}let T;if(i.client)T=i.client({chain:_});else{const S=_.id,x=a.getState().map(M=>M.id),O={},L=Object.entries(i);for(const[M,R]of L)if(!(M==="chains"||M==="client"||M==="connectors"||M==="transports"))if(typeof R=="object")if(S in R)O[M]=R[S];else{if(x.some(N=>N in R))continue;O[M]=R}else O[M]=R;T=jv({...O,chain:_,batch:O.batch??{multicall:!0},transport:M=>i.transports[S]({...M,connectors:c})})}return d.set(y,T),T}function f(){return{chainId:a.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let p;const g="0.0.0-canary-";Gc.startsWith(g)?p=Number.parseInt(Gc.replace(g,"")):p=Number.parseInt(Gc.split(".")[0]??"0");const m=Id(Q4(r?rF(f,{migrate(E,y){if(y===p)return E;const _=f(),T=w(E,_.chainId);return{..._,chainId:T}},name:"store",partialize(E){return{connections:{__type:"Map",value:Array.from(E.connections.entries()).map(([y,_])=>{const{id:T,name:S,type:x,uid:O}=_.connector;return[y,{..._,connector:{id:T,name:S,type:x,uid:O}}]})},chainId:E.chainId,current:E.current}},merge(E,y){typeof E=="object"&&E&&"status"in E&&delete E.status;const _=w(E,y.chainId);return{...y,...E,chainId:_}},skipHydration:s,storage:r,version:p}):f));m.setState(f());function w(E,y){return E&&typeof E=="object"&&"chainId"in E&&typeof E.chainId=="number"&&a.getState().some(_=>_.id===E.chainId)?E.chainId:y}n&&m.subscribe(({connections:E,current:y})=>{var _;return y?(_=E.get(y))==null?void 0:_.chainId:void 0},E=>{if(a.getState().some(_=>_.id===E))return m.setState(_=>({..._,chainId:E??_.chainId}))}),o==null||o.subscribe(E=>{const y=new Set,_=new Set;for(const S of c.getState())if(y.add(S.id),S.rdns){const x=typeof S.rdns=="string"?[S.rdns]:S.rdns;for(const O of x)_.add(O)}const T=[];for(const S of E){if(_.has(S.info.rdns))continue;const x=u(l(S));y.has(x.id)||T.push(x)}r&&!m.persist.hasHydrated()||c.setState(S=>[...S,...T],!0)});function b(E){m.setState(y=>{const _=y.connections.get(E.uid);return _?{...y,connections:new Map(y.connections).set(E.uid,{accounts:E.accounts??_.accounts,chainId:E.chainId??_.chainId,connector:_.connector})}:y})}function v(E){m.getState().status==="connecting"||m.getState().status==="reconnecting"||m.setState(y=>{const _=c.getState().find(T=>T.uid===E.uid);return _?(_.emitter.listenerCount("connect")&&_.emitter.off("connect",b),_.emitter.listenerCount("change")||_.emitter.on("change",b),_.emitter.listenerCount("disconnect")||_.emitter.on("disconnect",A),{...y,connections:new Map(y.connections).set(E.uid,{accounts:E.accounts,chainId:E.chainId,connector:_}),current:E.uid,status:"connected"}):y})}function A(E){m.setState(y=>{const _=y.connections.get(E.uid);if(_){const S=_.connector;S.emitter.listenerCount("change")&&_.connector.emitter.off("change",b),S.emitter.listenerCount("disconnect")&&_.connector.emitter.off("disconnect",A),S.emitter.listenerCount("connect")||_.connector.emitter.on("connect",v)}if(y.connections.delete(E.uid),y.connections.size===0)return{...y,connections:new Map,current:null,status:"disconnected"};const T=y.connections.values().next().value;return{...y,connections:new Map(y.connections),current:T.connector.uid}})}return{get chains(){return a.getState()},get connectors(){return c.getState()},storage:r,getClient:h,get state(){return m.getState()},setState(E){let y;typeof E=="function"?y=E(m.getState()):y=E;const _=f();typeof y!="object"&&(y=_),Object.keys(_).some(S=>!(S in y))&&(y=_),m.setState(y,!0)},subscribe(E,y,_){return m.subscribe(E,y,_?{..._,fireImmediately:_.emitImmediately}:void 0)},_internal:{mipd:o,store:m,ssr:!!s,syncConnectedChain:n,transports:i.transports,chains:{setState(E){const y=typeof E=="function"?E(a.getState()):E;if(y.length!==0)return a.setState(y,!0)},subscribe(E){return a.subscribe(E)}},connectors:{providerDetailToConnector:l,setup:u,setState(E){return c.setState(typeof E=="function"?E(c.getState()):E,!0)},subscribe(E){return c.subscribe(E)}},events:{change:b,connect:v,disconnect:A}}}}function gF(t){let e=[],r,n;function s(a){return Go.parseEvmChainId(a)||1}function i(){return r||(r=xs.getInstance({projectId:t.options.projectId,enableLogger:t.options.enableAuthLogger,onTimeout:a=>{a==="iframe_load_failed"?Lt.open(pt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):a==="iframe_request_timeout"?Lt.open(pt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):a==="unverified_domain"&&Lt.open(pt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:pt.EmbeddedWalletAbortController})),r}async function o(a={}){var g,m;const c=i();let u=a.chainId;if(a.isReconnecting){const w=Go.parseEvmChainId(c.getLastUsedChainId()||""),b=(g=t.chains)==null?void 0:g[0].id;if(u=w||b,!u)throw new Error("ChainId not found in provider")}const l=(m=ne.state.preferredAccountTypes)==null?void 0:m.eip155,{address:d,chainId:h,accounts:f}=await c.connect({chainId:u,preferredAccountType:l,socialUri:a.socialUri});e=(f==null?void 0:f.map(w=>w.address))||[d];const p=s(h);return{accounts:e,account:d,chainId:p,chain:{id:p,unsuported:!1}}}return a=>({id:q.CONNECTOR_ID.AUTH,name:q.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:q.CHAIN.EVM,async connect(c={}){if(n)return n;n||(n=new Promise(l=>{l(o(c))}));const u=await n;return n=void 0,u},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e!=null&&e.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){return this.provider||(this.provider=xs.getInstance({projectId:t.options.projectId,enableLogger:t.options.enableAuthLogger,abortController:pt.EmbeddedWalletAbortController,onTimeout:c=>{c==="iframe_load_failed"?Lt.open(pt.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?Lt.open(pt.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&Lt.open(pt.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")}})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:u}=await c.getChainId();return s(u)},async isAuthorized(){const c=await this.getProvider();return Promise.resolve(c.getLoginEmailUsed())},async switchChain({chainId:c}){var u,l;try{const d=a.chains.find(g=>g.id===c);if(!d)throw new an(new Error("chain not found on connector."));const h=await this.getProvider(),f=(u=ne.state.preferredAccountTypes)==null?void 0:u.eip155,p=await h.connect({chainId:c,preferredAccountType:f});return e=((l=p==null?void 0:p.accounts)==null?void 0:l.map(g=>g.address))||[p.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),d}catch(d){throw d instanceof Error?new an(d):d}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(As)})},onChainChanged(c){const u=Number(c);a.emitter.emit("change",{chainId:u})},async onDisconnect(c){await(await this.getProvider()).disconnect()}})}Bf.type="walletConnect";function Bf(t,e){const r=t.isNewChainsStale??!0;let n,s,i,o,a,c,u;return l=>({id:"walletConnect",name:"WalletConnect",type:Bf.type,async setup(){const d=await this.getProvider().catch(()=>null);d&&(o||(o=this.onConnect.bind(this),d.on("connect",o)),c||(c=this.onSessionDelete.bind(this),d.on("session_delete",c)))},async connect({...d}={}){var h,f,p;try{const g=P.getCaipNetworks(),m=await this.getProvider();if(!m)throw new zn;a||(a=this.onDisplayUri,m.on("display_uri",a));const w=await this.isChainsStale();m.session&&w&&await m.disconnect();const b=F.state.universalProviderConfigOverride;if(!m.session||w){const S=Vo.createNamespaces(g,b);await m.connect({optionalNamespaces:S,..."pairingTopic"in d?{pairingTopic:d.pairingTopic}:{}}),this.setRequestedChainsIds(g.map(x=>Number(x.id)))}const v=await this.getAccounts(),A=await this.getChainId(),E=(p=(f=(h=m.session)==null?void 0:h.namespaces)==null?void 0:f.eip155)==null?void 0:p.chains,y=E==null?void 0:E.some(S=>Number(S.split(":")[1])===A);let _=1;y?_=A:E!=null&&E[0]&&(_=Number(E[0].split(":")[1])),a&&(m.removeListener("display_uri",a),a=void 0),o&&(m.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),m.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),m.on("chainChanged",i)),u||(u=this.onDisconnect.bind(this),m.on("disconnect",u)),c||(c=this.onSessionDelete.bind(this),m.on("session_delete",c));const T=b==null?void 0:b.defaultChain;return m.setDefaultChain(T??`eip155:${_}`),{accounts:v,chainId:_}}catch(g){throw/(user rejected|connection request reset)/i.test(g==null?void 0:g.message)?new at(g):g}},async disconnect(){const d=await this.getProvider();try{await(d==null?void 0:d.disconnect())}catch(h){if(!/No matching key/i.test(h.message))throw h}finally{i&&(d==null||d.removeListener("chainChanged",i),i=void 0),u&&(d==null||d.removeListener("disconnect",u),u=void 0),o||(o=this.onConnect.bind(this),d==null||d.on("connect",o)),s&&(d==null||d.removeListener("accountsChanged",s),s=void 0),c&&(d==null||d.removeListener("session_delete",c),c=void 0),this.setRequestedChainsIds([])}},async getAccounts(){var p,g,m;const d=await this.getProvider();if(!((p=d==null?void 0:d.session)!=null&&p.namespaces))return[];const h=(m=(g=d==null?void 0:d.session)==null?void 0:g.namespaces[q.CHAIN.EVM])==null?void 0:m.accounts;return(h==null?void 0:h.map(w=>w.split(":")[2]))??[]},async getProvider({chainId:d}={}){var p,g;n||(n=await e.getUniversalProvider(),n==null||n.events.setMaxListeners(Number.POSITIVE_INFINITY));const h=Z.getActiveNamespace(),f=(p=e.getCaipNetwork())==null?void 0:p.id;if(d&&f!==d&&h){const m=Z.getStoredActiveCaipNetworkId(),w=e.getCaipNetworks(h),b=w==null?void 0:w.find(v=>v.id===m);b&&b.chainNamespace===q.CHAIN.EVM&&await((g=this.switchChain)==null?void 0:g.call(this,{chainId:Number(b.id)}))}return n},async getChainId(){var g,m,w,b;const d=(g=e.getCaipNetwork(q.CHAIN.EVM))==null?void 0:g.id;if(d)return d;const f=(b=(w=(m=(await this.getProvider()).session)==null?void 0:m.namespaces[q.CHAIN.EVM])==null?void 0:w.chains)==null?void 0:b[0],p=P.getCaipNetworks().find(v=>v.id===f);return p==null?void 0:p.id},async isAuthorized(){try{const[d,h]=await Promise.all([this.getAccounts(),this.getProvider()]);return d.length?await this.isChainsStale()&&h.session?(await h.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:d,chainId:h}){var g,m,w,b;const f=await this.getProvider();if(!f)throw new zn;const p=P.getCaipNetworks().find(v=>v.id===h);if(!p)throw new an(new Fa);try{await f.request({method:"wallet_switchEthereumChain",params:[{chainId:Ee(h)}]}),p!=null&&p.caipNetworkId&&f.setDefaultChain(p==null?void 0:p.caipNetworkId),l.emitter.emit("change",{chainId:Number(h)});const v=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...v,h]),{...p,id:p.id}}catch(v){const A=v;if(/(?:user rejected)/iu.test(A.message))throw new at(A);try{let E;d!=null&&d.blockExplorerUrls?E=d.blockExplorerUrls:E=(g=p.blockExplorers)!=null&&g.default.url?[(m=p.blockExplorers)==null?void 0:m.default.url]:[];const y=((b=(w=p.rpcUrls)==null?void 0:w.chainDefault)==null?void 0:b.http)||[],_={blockExplorerUrls:E,chainId:Ee(h),chainName:p.name,iconUrls:d==null?void 0:d.iconUrls,nativeCurrency:p.nativeCurrency,rpcUrls:y};await f.request({method:"wallet_addEthereumChain",params:[_]});const T=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...T,h]),{...p,id:p.id}}catch(E){throw new at(E)}}},onAccountsChanged(d){d.length===0?this.onDisconnect():l.emitter.emit("change",{accounts:d.map(h=>As(h))})},onChainChanged(d){const h=Number(d);l.emitter.emit("change",{chainId:h})},onConnect(d){this.setRequestedChainsIds(P.getCaipNetworks().map(h=>Number(h.id)))},async onDisconnect(d){this.setRequestedChainsIds([]),l.emitter.emit("disconnect");const h=await this.getProvider();s&&(h.removeListener("accountsChanged",s),s=void 0),i&&(h.removeListener("chainChanged",i),i=void 0),u&&(h.removeListener("disconnect",u),u=void 0),c&&(h.removeListener("session_delete",c),c=void 0),o||(o=this.onConnect.bind(this),h.on("connect",o))},onDisplayUri(d){l.emitter.emit("message",{type:"display_uri",data:d})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){var f,p,g;if(!((f=n==null?void 0:n.session)!=null&&f.namespaces))return[];const d=(g=(p=n==null?void 0:n.session)==null?void 0:p.namespaces[q.CHAIN.EVM])==null?void 0:g.accounts;return(d==null?void 0:d.map(m=>Number.parseInt(m.split(":")[1]??"")))??[]},async getRequestedChainsIds(){var h;const d=await((h=l.storage)==null?void 0:h.getItem(this.requestedChainsStorageKey))??[];return[...new Set(d)]},async isChainsStale(){if(!r)return!1;const d=l.chains.map(p=>p.id),h=this.getNamespaceChainsIds();if(h.length&&!h.some(p=>d.includes(p)))return!1;const f=await this.getRequestedChainsIds();return!d.every(p=>f.includes(Number(p)))},async setRequestedChainsIds(d){var h;await((h=l.storage)==null?void 0:h.setItem(this.requestedChainsStorageKey,d))},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})}const No=Ye({pendingTransactions:0}),Zy={state:No,subscribeKey(t,e){return Rt(No,t,e)},increase(t){No[t]+=1},decrease(t){No[t]-=1},reset(t){No[t]=0}};function mF(t){try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}}const yF={enable:!1,pollingInterval:3e4};class wF extends aE{constructor(e){const r=en.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=q.CHAIN.EVM,this.adapterType=q.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...yF,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:r})}construct(e){this.setupWatchers()}async getAccounts(e){var i;const r=this.getWagmiConnector(e.id);if(!r)return{accounts:[]};if(r.id===q.CONNECTOR_ID.AUTH){const o=await r.getProvider();if(!(o!=null&&o.user))return{accounts:[]};const{address:a,accounts:c}=o.user;return Promise.resolve({accounts:(c||[{address:a,type:"eoa"}]).map(u=>ae.createAccount("eip155",u.address,u.type))})}const{addresses:n,address:s}=Tu(this.wagmiConfig);return Promise.resolve({accounts:(i=n||[s])==null?void 0:i.map(o=>ae.createAccount("eip155",o||"","eoa"))})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(r=>r.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===q.CHAIN.EVM);const r={},n=[...e.connectors??[]];this.wagmiChains.forEach(s=>{var a,c;const i=(a=e.transports)==null?void 0:a[s.id],o=en.getCaipNetworkId(s);i?r[s.id]=en.extendWagmiTransports(s,e.projectId,i):r[s.id]=en.getViemTransport(s,e.projectId,(c=e.customRpcUrls)==null?void 0:c[o])}),this.wagmiConfig=pF({...e,chains:this.wagmiChains,connectors:n,transports:r})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=V4(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),Zy.increase("pendingTransactions")}});const e=Zy.subscribeKey("pendingTransactions",r=>{var n;r>=q.LIMITS.PENDING_TRANSACTIONS&&((n=this.unwatchPendingTransactions)==null||n.call(this),e())})}setupWatchers(){H4(this.wagmiConfig,{onChange:(e,r)=>{e.status==="disconnected"&&r.address&&this.emit("disconnect"),e.status==="connected"&&((e.address!==(r==null?void 0:r.address)||r.status!=="connected")&&(this.setupWatchPendingTransactions(),this.emit("accountChanged",{address:e.address,chainId:e.chainId})),e.chainId!==(r==null?void 0:r.chainId)&&this.emit("switchNetwork",{address:e.address,chainId:e.chainId}))}})}async addThirdPartyConnectors(e){var n,s;const r=[];if(e.enableCoinbase!==!1)try{const{coinbaseWallet:i}=await Ut(async()=>{const{coinbaseWallet:o}=await import("./CEoTPPCM.js");return{coinbaseWallet:o}},__vite__mapDeps([42,2]),import.meta.url);i&&r.push(i({version:"4",appName:((n=e.metadata)==null?void 0:n.name)??"Unknown",appLogoUrl:((s=e.metadata)==null?void 0:s.icons[0])??"Unknown",preference:e.coinbasePreference??"all"}))}catch(i){console.error("Failed to import Coinbase Wallet SDK:",i)}r.forEach(i=>{const o=this.wagmiConfig._internal.connectors.setup(i);this.wagmiConfig._internal.connectors.setState(a=>[...a,o])})}addWagmiConnectors(e,r){var o,a,c,u,l,d;const n=[];e.enableWalletConnect!==!1&&n.push(Bf(e,r)),e.enableInjected!==!1&&n.push(ul({shimDisconnect:!0}));const s=((o=e.features)==null?void 0:o.email)===void 0?st.DEFAULT_FEATURES.email:(a=e.features)==null?void 0:a.email,i=(c=e.features)!=null&&c.socials?((l=(u=e.features)==null?void 0:u.socials)==null?void 0:l.length)>0:((d=e.features)==null?void 0:d.socials)??st.DEFAULT_FEATURES.socials;(s||i)&&n.push(gF({chains:this.wagmiChains,options:{projectId:e.projectId,enableAuthLogger:e.enableAuthLogger}})),n.forEach(h=>{const f=this.wagmiConfig._internal.connectors.setup(h);this.wagmiConfig._internal.connectors.setState(p=>[...p,f])})}async signMessage(e){try{return{signature:await q4(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:r,address:n}=Tu(this.wagmiConfig),s={account:n,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chainId:r,type:"legacy",parameters:["nonce"]};await F4(this.wagmiConfig,s);const i=await j4(this.wagmiConfig,s);return await K4(this.wagmiConfig,{hash:i,timeout:25e3}),{hash:i}}async writeContract(e){var o;const{caipNetwork:r,...n}=e,s=Number(Go.caipNetworkIdToNumber(r.caipNetworkId));return{hash:await G4(this.wagmiConfig,{chain:(o=this.wagmiChains)==null?void 0:o[s],chainId:s,address:n.tokenAddress,account:n.fromAddress,abi:n.abi,functionName:n.method,args:n.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await k4(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return wL(e.value,e.decimals)}formatUnits(e){return oo(e.value,e.decimals)}async addWagmiConnector(e,r){var s;if(e.id===q.CONNECTOR_ID.AUTH||e.id===q.CONNECTOR_ID.WALLET_CONNECT)return;const n=await e.getProvider().catch(()=>{});this.addConnector({id:e.id,explorerId:Yn.ConnectorExplorerIds[e.id],imageUrl:((s=r==null?void 0:r.connectorImages)==null?void 0:s[e.id])??e.icon,name:Yn.ConnectorNamesMap[e.id]??e.name,imageId:Yn.ConnectorImageIds[e.id],type:Yn.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===q.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:n,chain:this.namespace,chains:[]})}async syncConnectors(e,r){W4(this.wagmiConfig,{onChange:n=>n.forEach(s=>this.addWagmiConnector(s,e))}),await Promise.all(this.wagmiConfig.connectors.map(n=>this.addWagmiConnector(n,e))),this.addWagmiConnectors(e,r),await this.addThirdPartyConnectors(e)}async syncConnection(e){var a;const{id:r}=e,s=gs(this.wagmiConfig).find(c=>c.connector.id===r),i=this.getWagmiConnector(r),o=await(i==null?void 0:i.getProvider());return{chainId:Number(s==null?void 0:s.chainId),address:s==null?void 0:s.accounts[0],provider:o,type:(a=s==null?void 0:s.connector.type)==null?void 0:a.toUpperCase(),id:s==null?void 0:s.connector.id}}async connectWalletConnect(e){const r=this.getWalletConnectConnector();await r.authenticate();const n=this.getWagmiConnector("walletConnect");if(!n)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await qy(this.wagmiConfig,{connector:n,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await Wy(this.wagmiConfig,{chainId:s.chainId}),{clientId:await r.provider.client.core.crypto.getClientId()}}async connect(e){var l,d,h,f,p;const{id:r,provider:n,type:s,info:i,chainId:o,socialUri:a}=e,c=this.getWagmiConnector(r);if(!c)throw new Error("connectionControllerClient:connectExternal - connector is undefined");if(n&&i&&c.id===q.CONNECTOR_ID.EIP6963&&((l=c.setEip6963Wallet)==null||l.call(c,{provider:n,info:i})),c.uid===((h=(d=this.wagmiConfig)==null?void 0:d.state)==null?void 0:h.current)){const g=(p=(f=this.wagmiConfig.state)==null?void 0:f.connections)==null?void 0:p.get(c.uid);if(g)return{address:g==null?void 0:g.accounts[0],chainId:g==null?void 0:g.chainId,provider:n,type:s,id:r}}const u=await qy(this.wagmiConfig,{connector:c,chainId:o?Number(o):void 0,socialUri:a});return{address:u.accounts[0],chainId:u.chainId,provider:n,type:s,id:r}}async reconnect(e){const{id:r}=e,n=this.getWagmiConnector(r);if(!n)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await Hy(this.wagmiConfig,{connectors:[n]})}async getBalance(e){const r=e.address,n=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!r)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(n&&this.wagmiConfig){const s=`${n.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=Z.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{var c,u;try{const l=Number(e.chainId),d=await B4(this.wagmiConfig,{address:e.address,chainId:l,token:(u=(c=e.tokens)==null?void 0:c[n.caipNetworkId])==null?void 0:u.address});Z.updateNativeBalanceCache({caipAddress:s,balance:d.formatted,symbol:d.symbol,timestamp:Date.now()}),a({balance:d.formatted,symbol:d.symbol})}catch(l){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",l),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){var e;return(e=this.getWagmiConnector("walletConnect"))==null?void 0:e.provider}async disconnect(){const e=gs(this.wagmiConfig);await Promise.all(e.map(async r=>{const n=this.getWagmiConnector(r.connector.id);n&&await D4(this.wagmiConfig,{connector:n})}))}async switchNetwork(e){await Wy(this.wagmiConfig,{chainId:e.caipNetwork.id}),await super.switchNetwork(e)}async getCapabilities(e){var a,c;if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const n=gs(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");const o=(c=(a=i.session)==null?void 0:a.sessionProperties)==null?void 0:c.capabilities;if(o){const l=mF(o)[e];if(l)return l}return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const n=gs(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const n=gs(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const n=gs(this.wagmiConfig)[0],s=n?this.getWagmiConnector(n.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setUniversalProvider(e){e.on("connect",()=>{const r=gs(this.wagmiConfig),n=this.getWagmiConnector("walletConnect");n&&!r.find(s=>s.connector.id===n.id)&&Hy(this.wagmiConfig,{connectors:[n]})}),this.addConnector(new Mf({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"}))}}var bF=bE('<header class="svelte-xc76oy"><appkit-button></appkit-button></header> <!>',3);function qj(t,e){TE(e,!0);const r="101a9a9ea0737af81f87ae784a9884ef",n=[My],s=new wF({projectId:r,networks:n});N4({adapters:[s],networks:[My],metadata:{name:"rrir",description:"Serial Mob Programming",url:"https://odr.ygg.army",icons:["https://avatars.githubusercontent.com/u/179229932"]},projectId:r,features:{analytics:!0}});var o=bF(),a=PE(xE(o),2);return RE(a,()=>e.children),vE(t,o),OE({networks:n})}export{g8 as $,ne as A,he as B,Fa as C,q as D,mt as E,Z as F,uu as G,bf as H,ns as I,Pj as J,rl as K,vf as L,tt as M,ZE as N,Tj as O,Nj as P,iv as Q,Ae as R,an as S,Gt as T,at as U,el as V,It as W,cu as X,UU as Y,FU as Z,Rj as _,xi as a,j as a0,Cf as a1,Er as a2,P8 as a3,E6 as a4,Uv as a5,qi as a6,jo as a7,ss as a8,$o as a9,Rn as aA,e_ as aB,Le as aC,ar as aD,Ke as aE,xu as aF,$r as aG,Fo as aH,ue as aI,Lj as aJ,Oe as aK,eE as aL,Bh as aM,Ki as aN,AF as aO,IF as aP,pj as aQ,PT as aR,iF as aS,Mh as aT,Wc as aU,FE as aV,v_ as aW,Xr as aX,nF as aY,CF as aZ,qj as a_,F as aa,lb as ab,fj as ac,Xh as ad,Xo as ae,nu as af,Us as ag,ru as ah,mj as ai,gj as aj,TT as ak,t4 as al,pt as am,An as an,qo as ao,DN as ap,aj as aq,Yp as ar,nb as as,AN as at,kN as au,cj as av,oj as aw,Uu as ax,dj as ay,uj as az,Uj as b,jj as c,Kc as d,Bj as e,r4 as f,As as g,Fj as h,ul as i,Bt as j,P as k,kr as l,ew as m,Ee as n,ae as o,Ye as p,le as q,Mj as r,Rt as s,Ge as t,Lt as u,by as v,Cr as w,kj as x,st as y,ee as z};
